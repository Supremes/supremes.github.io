<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 8.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js" defer></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/7/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Supremes">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/7/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/7/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Hexo</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  






  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Hexo</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Supremes</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">82</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/fatcat/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/fatcat/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-11-26 15:30:03" itemprop="dateCreated datePublished" datetime="2025-11-26T15:30:03+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>我来帮你理解这个项目结构，并指导你如何阅读它。让我先分析一下项目的整体结构，然后给出学习建议。 基于我对项目的分析，这是一个<strong>前后端分离的博客系统</strong>项目，名为 Aurora。让我为你详细介绍如何阅读和理解这个项目：</p>
<h2 id="项目整体架构"><a href="#项目整体架构" class="headerlink" title="项目整体架构"></a>项目整体架构</h2><p>这个项目分为三个主要部分：</p>
<ol>
<li><strong>后端 (aurora-springboot)</strong>: Java Spring Boot项目</li>
<li><strong>前台博客 (aurora-blog)</strong>: Vue 3 + TypeScript 项目</li>
<li><strong>后台管理 (aurora-admin)</strong>: Vue 2 + JavaScript 项目</li>
<li><strong>部署配置 (nginx, release)</strong>: Docker容器化部署</li>
</ol>
<h2 id="对于没有-JS-TS-经验的学习建议"><a href="#对于没有-JS-TS-经验的学习建议" class="headerlink" title="对于没有 JS&#x2F;TS 经验的学习建议"></a>对于没有 JS&#x2F;TS 经验的学习建议</h2><h3 id="第一步：理解基础概念"><a href="#第一步：理解基础概念" class="headerlink" title="第一步：理解基础概念"></a>第一步：理解基础概念</h3><ol>
<li><strong>JavaScript (JS)</strong>: 网页编程语言</li>
<li><strong>TypeScript (TS)</strong>: JavaScript的超集，增加了类型系统</li>
<li><strong>Vue.js</strong>: 前端框架，用于构建用户界面</li>
<li><strong>Node.js</strong>: JavaScript运行时环境</li>
</ol>
<h3 id="第二步：项目阅读顺序"><a href="#第二步：项目阅读顺序" class="headerlink" title="第二步：项目阅读顺序"></a>第二步：项目阅读顺序</h3><h4 id="1-先看配置文件了解项目依赖"><a href="#1-先看配置文件了解项目依赖" class="headerlink" title="1. 先看配置文件了解项目依赖"></a>1. 先看配置文件了解项目依赖</h4><ul>
<li>package.json: 项目的依赖包和脚本命令</li>
<li><code>tsconfig.json</code>: TypeScript配置</li>
<li><code>vue.config.js</code>: Vue项目构建配置</li>
</ul>
<h4 id="2-从入口文件开始"><a href="#2-从入口文件开始" class="headerlink" title="2. 从入口文件开始"></a>2. 从入口文件开始</h4><ul>
<li><strong>前台博客</strong>: main.ts (主入口)</li>
<li><strong>后台管理</strong>: <code>aurora-admin/src/main.js</code> (主入口)</li>
</ul>
<h4 id="3-理解项目结构"><a href="#3-理解项目结构" class="headerlink" title="3. 理解项目结构"></a>3. 理解项目结构</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">src/</span><br><span class="line">├── api/          # API接口定义</span><br><span class="line">├── components/   # 可复用组件</span><br><span class="line">├── router/       # 路由配置</span><br><span class="line">├── stores/       # 状态管理 (Pinia/Vuex)</span><br><span class="line">├── views/        # 页面组件</span><br><span class="line">├── utils/        # 工具函数</span><br><span class="line">└── styles/       # 样式文件</span><br></pre></td></tr></table></figure>

<h3 id="第三步：学习路径建议"><a href="#第三步：学习路径建议" class="headerlink" title="第三步：学习路径建议"></a>第三步：学习路径建议</h3><p>Made changes.</p>
<p>现在让我为你创建一个具体的项目运行指南： </p>
<p>Made changes.</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这是一个<strong>前后端分离的博客系统</strong>，包含：</p>
<ol>
<li><strong>前台博客</strong> (Vue 3 + TypeScript) - 用户看到的博客页面</li>
<li><strong>后台管理</strong> (Vue 2 + JavaScript) - 管理员管理内容的界面  </li>
<li><strong>后端API</strong> (Spring Boot) - 提供数据接口</li>
</ol>
<h3 id="对于没有-JS-TS-经验的建议："><a href="#对于没有-JS-TS-经验的建议：" class="headerlink" title="对于没有 JS&#x2F;TS 经验的建议："></a>对于没有 JS&#x2F;TS 经验的建议：</h3><ol>
<li><p><strong>从简单开始</strong>: 建议先学习后台管理系统 (Vue 2 + JS)，比前台的 Vue 3 + TS 更容易理解</p>
</li>
<li><p><strong>学习顺序</strong>:</p>
<ul>
<li>先了解基本的 HTML&#x2F;CSS&#x2F;JavaScript</li>
<li>学习 Vue.js 基础概念</li>
<li>理解组件、路由、状态管理</li>
<li>最后接触 TypeScript</li>
</ul>
</li>
<li><p><strong>实践方法</strong>:</p>
<ul>
<li>先运行项目看效果</li>
<li>从入口文件 (main.ts) 开始阅读</li>
<li>尝试修改简单的文本内容观察变化</li>
<li>逐步理解路由跳转和组件结构</li>
</ul>
</li>
<li><p><strong>推荐学习路径</strong>:</p>
<ul>
<li>JavaScript ES6+ 基础</li>
<li>Vue.js 官方文档和教程</li>
<li>实际运行这个项目并尝试修改</li>
</ul>
</li>
</ol>
<p>我已经为你创建了详细的学习指南和快速启动指南，你可以按照这些文档逐步学习。记住，学习编程需要耐心和实践，不要急于求成！</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/MDM/iOS%20webclip%20for%20shared%20ipads/poc%20demo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/MDM/iOS%20webclip%20for%20shared%20ipads/poc%20demo/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-11-26 15:30:03" itemprop="dateCreated datePublished" datetime="2025-11-26T15:30:03+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Device: shared iPad with ABM mode, </p>
<p>webclip device policy is deployed succeccfully through</p>
<p><video src="/Users/junkangd/Downloads/RPReplay_Final1668666306.MP4"></video></p>
<p>![image-20221117144049795](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20221117144049795.png)</p>
<p>CEM get current logged-in user of shared iPad, and deploy webclip to this user.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/MDM/iOS%20webclip%20for%20shared%20ipads/groom-ipad/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/MDM/iOS%20webclip%20for%20shared%20ipads/groom-ipad/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-11-26 15:30:03" itemprop="dateCreated datePublished" datetime="2025-11-26T15:30:03+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>RFE, <a target="_blank" rel="noopener" href="https://docs.citrix.com/en-us/xenmobile/server/policies/webclip-policy.html">https://docs.citrix.com/en-us/xenmobile/server/policies/webclip-policy.html</a>. Add for Shared iPad.  <a target="_blank" rel="noopener" href="https://issues.citrite.net/browse/XMHELP-2188">https://issues.citrite.net/browse/XMHELP-2188</a></p>
<h1 id="webclip-support-for-shared-ipads"><a href="#webclip-support-for-shared-ipads" class="headerlink" title="webclip support for shared ipads"></a>webclip support for shared ipads</h1><p>shared ipad :  <a target="_blank" rel="noopener" href="https://docs.citrix.com/en-us/citrix-endpoint-management/device-management/apple/shared-ipads.html">https://docs.citrix.com/en-us/citrix-endpoint-management/device-management/apple/shared-ipads.html</a></p>
<p>webclip policy: <a target="_blank" rel="noopener" href="https://docs.citrix.com/en-us/xenmobile/server/policies/webclip-policy.html">https://docs.citrix.com/en-us/xenmobile/server/policies/webclip-policy.html</a></p>
<blockquote>
<p>Resources that deploy over the user channel are:</p>
<ul>
<li>Device policies: <strong>Apps Notificationsm, Home Screen Layout, and Restrictions</strong> Endpoint Management supports only these device policies over the user channel.</li>
</ul>
</blockquote>
<p>TODO:</p>
<ul>
<li><p><input disabled="" type="checkbox"> 
Setup shared ipad</p>
</li>
<li><p><input disabled="" type="checkbox"> 
Validate whether webclip supports shared iPads</p>
</li>
<li><p><input disabled="" type="checkbox"> 
How to intergate webclip policy for shared iPads in server part</p>
<ul>
<li>webclip all use device user channel, 但是否会影响现有的webclip下发，需要指定shared ipad</li>
</ul>
</li>
<li><p><input disabled="" type="checkbox"> 
How to intergate webclip policy for shared iPads in client part</p>
</li>
<li><p><input disabled="" type="checkbox"> 
Analysis webclip policy process</p>
</li>
<li><p><input disabled="" type="checkbox"> 
Add <strong>Profile scope</strong> in Policy Settings</p>
</li>
<li><p><input disabled="" type="checkbox"> 
whether all device user could see the webclip and how to control worked user</p>
</li>
</ul>
<h2 id="Setup-shared-ipad"><a href="#Setup-shared-ipad" class="headerlink" title="Setup shared ipad"></a>Setup shared ipad</h2><p> <a target="_blank" rel="noopener" href="https://docs.citrix.com/en-us/citrix-endpoint-management/device-management/apple/shared-ipads.html">https://docs.citrix.com/en-us/citrix-endpoint-management/device-management/apple/shared-ipads.html</a></p>
<h2 id="Validate-whether-webclip-supports-shared-iPads"><a href="#Validate-whether-webclip-supports-shared-iPads" class="headerlink" title="Validate whether webclip supports shared iPads"></a>Validate whether webclip supports shared iPads</h2><p>webclip support shared ipad devices on the user channel only: <a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/devicemanagement/webclip">https://developer.apple.com/documentation/devicemanagement/webclip</a></p>
<h2 id="Analysis-webclip-policy-process"><a href="#Analysis-webclip-policy-process" class="headerlink" title="Analysis webclip policy process"></a>Analysis webclip policy process</h2><p>com&#x2F;sparus&#x2F;nps&#x2F;ios&#x2F;push&#x2F;deployment&#x2F;ProfileResourceHandler.java</p>
<p>com&#x2F;sparus&#x2F;nps&#x2F;iphone&#x2F;payload&#x2F;WebClip.java</p>
<p>com&#x2F;citrix&#x2F;xdm&#x2F;resources&#x2F;WebclipParametersImpl.java</p>
<p>com&#x2F;citrix&#x2F;xdm&#x2F;resources&#x2F;policyparameters&#x2F;parameters&#x2F;impl&#x2F;IOSConfigParametersImpl.java:toJSON</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DeviceType</span><br></pre></td></tr></table></figure>

<p>Webclip policy may use default scope which is system, we need further debug server to confirm that point.</p>
<p>IOSConfigParametersImpl.java</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public JSONObject toJSON() throws JSONException &#123;</span><br><span class="line">    JSONObject result = super.toJSON();</span><br><span class="line">    result.put(&quot;displayName&quot;, getDisplayName());</span><br><span class="line">    result.put(&quot;organization&quot;, getOrganization());</span><br><span class="line">    String removalPass = getRemovalPassword();</span><br><span class="line">    result.put(&quot;payloadRemovalDisallowed&quot;, getPayloadRemovalDisallowed());</span><br><span class="line">    // We should never send a password to the console. send the fake password instead</span><br><span class="line">    result.put(&quot;removalPassword&quot;, removalPass);</span><br><span class="line">    result.put(&quot;profilUUID&quot;, getConfigUUID());</span><br><span class="line">    result.put(&quot;removalDate&quot;, getRemovalDate() != null ? getRemovalDate() : &quot;-1&quot;);</span><br><span class="line">    result.put(&quot;durationUntilRemoval&quot;, getDurationUntilRemoval() != null ? getDurationUntilRemoval() : &quot;-1&quot;);</span><br><span class="line">    result.put(&quot;payloadScope&quot;, getPayloadScope() == null ? PayloadScope.SYSTEM.getValue() : getPayloadScope().getValue());</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="comparsion"><a href="#comparsion" class="headerlink" title="comparsion"></a>comparsion</h3><ul>
<li>with scope of user</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;scope_restricitons&quot;,</span><br><span class="line">  &quot;description&quot;: &quot;&quot;,</span><br><span class="line">  &quot;resourceType&quot;: &quot;RESTRICTIONS&quot;,</span><br><span class="line">  &quot;platforms&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;iOSEnrollmentMode&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;allowCamera&quot;: true,</span><br><span class="line">      &quot;allowVideoConferencing&quot;: true,</span><br><span class="line">      &quot;allowScreenShot&quot;: true,</span><br><span class="line">      &quot;allowRemoteScreenObservation&quot;: true,</span><br><span class="line">      &quot;forceClassroomUnpromptedScreenObservation&quot;: false,</span><br><span class="line">      &quot;allowPhotoStream&quot;: true,</span><br><span class="line">      &quot;allowSharedStream&quot;: true,</span><br><span class="line">      &quot;allowSharedDeviceTemporarySession&quot;: true,</span><br><span class="line">      &quot;allowVoiceDialing&quot;: true,</span><br><span class="line">      &quot;allowAssistant&quot;: true,</span><br><span class="line">      &quot;allowAssistantWhileLocked&quot;: true,</span><br><span class="line">      &quot;forceAssistantProfanityFilter&quot;: false,</span><br><span class="line">      &quot;allowAppInstallation&quot;: true,</span><br><span class="line">      &quot;allowGlobalBackgroundFetchWhenRoaming&quot;: true,</span><br><span class="line">      &quot;allowiTunes&quot;: true,</span><br><span class="line">      &quot;allowInAppPurchases&quot;: true,</span><br><span class="line">      &quot;forceITunesStorePasswordEntry&quot;: false,</span><br><span class="line">      &quot;allowSafari&quot;: true,</span><br><span class="line">      &quot;safariAllowAutoFill&quot;: true,</span><br><span class="line">      &quot;safariForceFraudWarning&quot;: false,</span><br><span class="line">      &quot;safariAllowJavaScript&quot;: true,</span><br><span class="line">      &quot;safariAllowPopups&quot;: false,</span><br><span class="line">      &quot;safariAcceptCookies&quot;: &quot;2.0&quot;,</span><br><span class="line">      &quot;allowCloudDocumentSync&quot;: true,</span><br><span class="line">      &quot;allowCloudBackup&quot;: true,</span><br><span class="line">      &quot;allowCloudKeychainSync&quot;: true,</span><br><span class="line">      &quot;allowCloudPhotoLibrary&quot;: true,</span><br><span class="line">      &quot;forceEncryptedBackup&quot;: false,</span><br><span class="line">      &quot;forceLimitAdTracking&quot;: false,</span><br><span class="line">      &quot;forceAirPlayOutgoingRequestsPairingPassword&quot;: false,</span><br><span class="line">      &quot;forceWatchWristDetection&quot;: false,</span><br><span class="line">      &quot;forceAirDropUnmanaged&quot;: false,</span><br><span class="line">      &quot;allowUntrustedTLSPrompt&quot;: true,</span><br><span class="line">      &quot;allowOTAPKIUpdates&quot;: true,</span><br><span class="line">      &quot;requireManagedPasteboard&quot;: false,</span><br><span class="line">      &quot;allowOpenFromManagedToUnmanaged&quot;: true,</span><br><span class="line">      &quot;allowUnmanagedToReadManagedContacts&quot;: false,</span><br><span class="line">      &quot;allowManagedToWriteUnmanagedContacts&quot;: false,</span><br><span class="line">      &quot;allowOpenFromUnmanagedToManaged&quot;: true,</span><br><span class="line">      &quot;allowDiagnosticSubmission&quot;: true,</span><br><span class="line">      &quot;allowFingerprintForUnlock&quot;: true,</span><br><span class="line">      &quot;allowPassBookWhileLocked&quot;: true,</span><br><span class="line">      &quot;allowActivityContinuation&quot;: true,</span><br><span class="line">      &quot;allowManagedAppsCloudSync&quot;: true,</span><br><span class="line">      &quot;allowEnterpriseBookBackup&quot;: true,</span><br><span class="line">      &quot;allowEnterpriseBookMetadataSync&quot;: true,</span><br><span class="line">      &quot;allowSpotlightInternetResults&quot;: true,</span><br><span class="line">      &quot;allowEnterpriseAppTrust&quot;: true,</span><br><span class="line">      &quot;allowESIMModification&quot;: true,</span><br><span class="line">      &quot;allowEraseContentAndSettings&quot;: true,</span><br><span class="line">      &quot;allowEnablingRestrictions&quot;: true,</span><br><span class="line">      &quot;allowPodcasts&quot;: true,</span><br><span class="line">      &quot;allowUIConfigurationProfileInstallation&quot;: true,</span><br><span class="line">      &quot;allowFingerprintModification&quot;: true,</span><br><span class="line">      &quot;allowUIAppInstallation&quot;: true,</span><br><span class="line">      &quot;allowKeyboardShortcuts&quot;: true,</span><br><span class="line">      &quot;allowPairedWatch&quot;: true,</span><br><span class="line">      &quot;allowPasscodeModification&quot;: true,</span><br><span class="line">      &quot;allowDeviceNameModification&quot;: true,</span><br><span class="line">      &quot;allowWallpaperModification&quot;: true,</span><br><span class="line">      &quot;allowAutomaticAppDownloads&quot;: true,</span><br><span class="line">      &quot;allowLockScreenControlCenter&quot;: true,</span><br><span class="line">      &quot;allowLockScreenNotificationsView&quot;: true,</span><br><span class="line">      &quot;allowLockScreenTodayView&quot;: true,</span><br><span class="line">      &quot;allowExplicitContent&quot;: true,</span><br><span class="line">      &quot;allowBookStoreErotica&quot;: true,</span><br><span class="line">      &quot;ratingRegion&quot;: &quot;us&quot;,</span><br><span class="line">      &quot;ratingMovies&quot;: &quot;&quot;,</span><br><span class="line">      &quot;ratingTVShows&quot;: &quot;&quot;,</span><br><span class="line">      &quot;ratingMoviesUS&quot;: 1000,</span><br><span class="line">      &quot;ratingTVShowsUS&quot;: 1000,</span><br><span class="line">      &quot;ratingMoviesAU&quot;: &quot;1000&quot;,</span><br><span class="line">      &quot;ratingTVShowsAU&quot;: &quot;1000&quot;,</span><br><span class="line">      &quot;ratingMoviesCA&quot;: &quot;1000&quot;,</span><br><span class="line">      &quot;ratingTVShowsCA&quot;: &quot;1000&quot;,</span><br><span class="line">      &quot;ratingMoviesDE&quot;: &quot;1000&quot;,</span><br><span class="line">      &quot;ratingTVShowsDE&quot;: &quot;1000&quot;,</span><br><span class="line">      &quot;ratingMoviesFR&quot;: &quot;1000&quot;,</span><br><span class="line">      &quot;ratingTVShowsFR&quot;: &quot;1000&quot;,</span><br><span class="line">      &quot;ratingMoviesIE&quot;: &quot;1000&quot;,</span><br><span class="line">      &quot;ratingTVShowsIE&quot;: &quot;1000&quot;,</span><br><span class="line">      &quot;ratingMoviesJP&quot;: &quot;1000&quot;,</span><br><span class="line">      &quot;ratingTVShowsJP&quot;: &quot;1000&quot;,</span><br><span class="line">      &quot;ratingMoviesNZ&quot;: &quot;1000&quot;,</span><br><span class="line">      &quot;ratingTVShowsNZ&quot;: &quot;1000&quot;,</span><br><span class="line">      &quot;ratingMoviesGB&quot;: &quot;1000&quot;,</span><br><span class="line">      &quot;ratingTVShowsGB&quot;: &quot;1000&quot;,</span><br><span class="line">      &quot;ratingApps&quot;: 1000,</span><br><span class="line">      &quot;allowAirDrop&quot;: true,</span><br><span class="line">      &quot;allowChat&quot;: true,</span><br><span class="line">      &quot;allowAssistantUserGeneratedContent&quot;: true,</span><br><span class="line">      &quot;allowBookStore&quot;: true,</span><br><span class="line">      &quot;allowAppRemoval&quot;: true,</span><br><span class="line">      &quot;allowGameCenter&quot;: true,</span><br><span class="line">      &quot;allowAddingGameCenterFriends&quot;: true,</span><br><span class="line">      &quot;allowMultiplayerGaming&quot;: true,</span><br><span class="line">      &quot;allowAccountModification&quot;: true,</span><br><span class="line">      &quot;allowAppCellularDataModification&quot;: true,</span><br><span class="line">      &quot;allowFilesNetworkDriveAccess&quot;: true,</span><br><span class="line">      &quot;allowFilesUSBDriveAccess&quot;: true,</span><br><span class="line">      &quot;allowFindMyDevice&quot;: true,</span><br><span class="line">      &quot;allowFindMyFriends&quot;: true,</span><br><span class="line">      &quot;allowFindMyFriendsModification&quot;: true,</span><br><span class="line">      &quot;allowHostPairing&quot;: true,</span><br><span class="line">      &quot;allowPredictiveKeyboard&quot;: true,</span><br><span class="line">      &quot;allowAutoCorrection&quot;: true,</span><br><span class="line">      &quot;allowSpellCheck&quot;: true,</span><br><span class="line">      &quot;allowContinuousPathKeyboard&quot;: true,</span><br><span class="line">      &quot;allowDefinitionLookup&quot;: true,</span><br><span class="line">      &quot;autonomousSingleAppModePermittedAppIDs&quot;: [],</span><br><span class="line">      &quot;allowNews&quot;: true,</span><br><span class="line">      &quot;allowMusicService&quot;: true,</span><br><span class="line">      &quot;allowRadioService&quot;: true,</span><br><span class="line">      &quot;allowNotificationsModification&quot;: true,</span><br><span class="line">      &quot;restrictedAppUsage&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;restrictedAppBundleIDs&quot;: [],</span><br><span class="line">      &quot;allowDiagnosticSubmissionModification&quot;: true,</span><br><span class="line">      &quot;allowBluetoothModification&quot;: true,</span><br><span class="line">      &quot;allowDictation&quot;: true,</span><br><span class="line">      &quot;forceWiFiPowerOn&quot;: false,</span><br><span class="line">      &quot;forceWiFiWhitelisting&quot;: false,</span><br><span class="line">      &quot;forceClassroomUnpromptedAppAndDeviceLock&quot;: false,</span><br><span class="line">      &quot;forceClassroomAutomaticallyJoinClasses&quot;: false,</span><br><span class="line">      &quot;allowAirPrint&quot;: true,</span><br><span class="line">      &quot;allowAirPrintCredentialsStorage&quot;: true,</span><br><span class="line">      &quot;allowAirPrintiBeaconDiscovery&quot;: true,</span><br><span class="line">      &quot;forceAirPrintTrustedTLSRequirement&quot;: false,</span><br><span class="line">      &quot;allowVPNCreation&quot;: true,</span><br><span class="line">      &quot;allowCellularPlanModification&quot;: true,</span><br><span class="line">      &quot;allowSystemAppRemoval&quot;: true,</span><br><span class="line">      &quot;allowProximitySetupToNewDevice&quot;: true,</span><br><span class="line">      &quot;allowUSBRestrictedMode&quot;: true,</span><br><span class="line">      &quot;forceDelayedSoftwareUpdates&quot;: false,</span><br><span class="line">      &quot;enforcedSoftwareUpdateDelay&quot;: 30,</span><br><span class="line">      &quot;forceClassroomRequestPermissionToLeaveClasses&quot;: false,</span><br><span class="line">      &quot;forceAuthenticationBeforeAutoFill&quot;: false,</span><br><span class="line">      &quot;forceAutomaticDateAndTime&quot;: true,</span><br><span class="line">      &quot;allowPasswordAutoFill&quot;: true,</span><br><span class="line">      &quot;allowPasswordProximityRequests&quot;: true,</span><br><span class="line">      &quot;allowPasswordSharing&quot;: true,</span><br><span class="line">      &quot;allowPersonalHotspotModification&quot;: true,</span><br><span class="line">      &quot;displayName&quot;: &quot;&quot;,</span><br><span class="line">      &quot;organization&quot;: &quot;Citrix&quot;,</span><br><span class="line">      &quot;passwordRemoval&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;removalDate&quot;: 0,</span><br><span class="line">      &quot;durationUntilRemoval&quot;: &quot;&quot;,</span><br><span class="line">      &quot;payloadRemovalDisallowed&quot;: &quot;always&quot;,</span><br><span class="line">      &quot;removalPassword&quot;: &quot;&quot;,</span><br><span class="line">      &quot;profilUUID&quot;: &quot;false&quot;,</span><br><span class="line">      &quot;configUUID&quot;: &quot;false&quot;,</span><br><span class="line">      &quot;payloadScope&quot;: &quot;User&quot;,</span><br><span class="line">      &quot;platform&quot;: &quot;IOS&quot;,</span><br><span class="line">      &quot;id&quot;: &quot;&quot;,</span><br><span class="line">      &quot;resourceType&quot;: &quot;RESTRICTIONS&quot;,</span><br><span class="line">      &quot;decomposedRules&quot;: &quot;&quot;,</span><br><span class="line">      &quot;rules&quot;: &quot;&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;roles&quot;: [</span><br><span class="line">    &quot;junkangd-DG&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;schedule&quot;: &#123;</span><br><span class="line">    &quot;enableDeployment&quot;: true,</span><br><span class="line">    &quot;deploySchedule&quot;: &quot;NOW&quot;,</span><br><span class="line">    &quot;deployDate&quot;: &quot;&quot;,</span><br><span class="line">    &quot;deployScheduleCondition&quot;: &quot;EVERYTIME&quot;,</span><br><span class="line">    &quot;deployInBackground&quot;: false</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Default scope</li>
</ul>
<p>payloadScope -&gt; System</p>
<p>com&#x2F;sparus&#x2F;nps&#x2F;ios&#x2F;push&#x2F;deployment&#x2F;actions&#x2F;InstallProfileAction.java: shouldInstallProfileOnDevice   过滤设备类型：shared-ipads</p>
<p>com&#x2F;sparus&#x2F;nps&#x2F;apple&#x2F;push&#x2F;commands&#x2F;InstallProfileCommand.java: prepare</p>
<p>设置scope</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">if (prov.getResourceType() == ResourceType.MDM_WEBLINK) &#123;</span><br><span class="line">            PayloadScope ps = PayloadScope.USER;</span><br><span class="line">            mc.setPayloadScope(ps);</span><br><span class="line">            logger.info(&quot;junkang-setPayloadScope: &quot; + mc.getPayloadScope());</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            logger.info(&quot;junkang-setPayloadScope:&quot; + prov.getResourceType() + &quot; , &quot; + mc.getPayloadType());</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>过滤shared ipads</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">com/sparus/nps/ios/push/commands/IOsDeviceConfiguredCmd.java</span><br><span class="line"> private static final Digester&lt;Object&gt; successDigester = (o, command, context) -&gt; &#123;</span><br><span class="line">        final PushTarget target = context.getTarget();</span><br><span class="line">        context.log(Level.INFO, &quot;DeviceConfigured command performed for target %s&quot;, target);</span><br><span class="line"></span><br><span class="line">        final Device device = context.getDevice();</span><br><span class="line">        final DepProfile depProfile = device.getDepProfile();</span><br><span class="line">        final boolean isMultiUser = depProfile != null &amp;&amp; depProfile.getIsMultiUser();</span><br><span class="line">        DeviceHelper.DEP_AWAITING_DEVICE_CONFIGURED.reset(device);</span><br><span class="line"></span><br><span class="line">        if (device.isDEPRegistered() &amp;&amp; isMultiUser) &#123;</span><br><span class="line">            if (!device.isAsmDepShared()) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    device.setAsmDepShared(true);</span><br><span class="line">                    SecurityConfiguration.getInstance().getDeviceManager().updateDevice(device);</span><br><span class="line">                &#125; catch (EWException ignored) &#123;</span><br><span class="line">                    logger.warn(&quot;Unable to update the shared status for device: &#123;&#125;&quot;, device, ignored);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>





<p><a target="_blank" rel="noopener" href="https://citrixsys.splunkcloud.com/en-US/app/search_xenmobile/search?q=search%20index=%22staging_xm_stapplogs%22%20%20source=huan0915.xmqa.cloud.com%20AND%20error&display.page.search.mode=smart&dispatch.sample_ratio=1&earliest=1668149100&latest=1668149435&sid=1668156868.28945599_9388FFD3-E6A5-4077-9C42-C5C0025CF07A">https://citrixsys.splunkcloud.com/en-US/app/search_xenmobile/search?q=search%20index%3D%22staging_xm_stapplogs%22%20%20source%3Dhuan0915.xmqa.cloud.com%20AND%20error&amp;display.page.search.mode=smart&amp;dispatch.sample_ratio=1&amp;earliest=1668149100&amp;latest=1668149435&amp;sid=1668156868.28945599_9388FFD3-E6A5-4077-9C42-C5C0025CF07A</a></p>
<p>![image-20221111174412036](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20221111174412036.png)</p>
<p>nY$CZe7A@KkQpe</p>
<p>DevicePolicyService.java</p>
<ul>
<li>addDevicePolicyHelper</li>
<li>updateDevicePolicyHelper</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">JSONObject originObject = new JSONObject(inputJsonBody);</span><br><span class="line">JSONArray jsonArray = (JSONArray) originObject.get(&quot;platforms&quot;);</span><br><span class="line">JSONObject obj = (JSONObject) jsonArray.get(0);</span><br><span class="line">obj.accumulate(&quot;payloadScope&quot;, &quot;User&quot;);</span><br><span class="line">inputJsonBody = originObject.toString();</span><br><span class="line">logger.debug(&quot;jsonBody is &#123;&#125;&quot;, inputJsonBody);</span><br></pre></td></tr></table></figure>



<h1 id="sync-abm-users"><a href="#sync-abm-users" class="headerlink" title="sync abm users"></a>sync abm users</h1><ul>
<li>add logic in background job called <code>AppleDepTask</code></li>
<li>Investigate relevant api about how to get abm accounts</li>
<li>add local user when sign in shared ipad</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MdmCheckInServlet</span><br></pre></td></tr></table></figure>

<p>在mdm sync的时候，去添加user，根据enrollment.getDevice().getDepProfile().getIsMultiUser()来判断是否为shared iPad</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getInternalUserPrincipal</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">enrollment = clientIdentity.getEnrollment();</span><br><span class="line">enrollment.getEnrollmentMethod()</span><br><span class="line"></span><br><span class="line">enrollment.getDevice().getDepProfile().getIsMultiUser()</span><br></pre></td></tr></table></figure>

<p>It will cause a mdm sync event  when device user log in shared iPad, we could add user information in that moment.Need check below:</p>
<ul>
<li><h2 id="Whether-above-mdm-event-will-lag-behind-webclip-policy-deployed"><a href="#Whether-above-mdm-event-will-lag-behind-webclip-policy-deployed" class="headerlink" title="Whether above mdm event will lag behind webclip policy deployed:"></a>Whether above mdm event will lag behind webclip policy deployed:</h2></li>
<li>How to add local user in server part.</li>
</ul>
<p>Golang 跨平台编译参数</p>
<p>1、Mac下编译Linux, Windows平台的64位可执行程序</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build</span><br><span class="line">$ CGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build</span><br></pre></td></tr></table></figure>

<p>2、Linux下编译Mac, Windows平台的64位可执行程序</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ CGO_ENABLED=0 GOOS=darwin GOARCH=amd64 go build</span><br><span class="line">$ CGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build</span><br></pre></td></tr></table></figure>

<p>3、Windows下编译Mac, Linux平台的64位可执行程序</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ SET CGO_ENABLED=0SET GOOS=darwin3 SET GOARCH=amd64 go build</span><br><span class="line">$ SET CGO_ENABLED=0 SET GOOS=linux SET GOARCH=amd64 go build</span><br></pre></td></tr></table></figure>



<p>.&#x2F;addUser -fqdn zzwsite1.xmqa.cloud.com -clientID bd8eb18e-9d50-493c-b00b-43c4833b04a4 -clientSecret ipZkMumX_pTL6t1PWCsAmA&#x3D;&#x3D; -customerId zzwsite1 -filePath &#x2F;Users&#x2F;junkangd&#x2F;GoProject&#x2F;dailyTest&#x2F;userlist.txt</p>
<p>One concern: How to sync ABM users to CEM?</p>
<p>Currently, there is a api for fetching users information on specified organization.</p>
<p>But there are two problems:</p>
<ol>
<li>response may not include user’s email information</li>
<li>the needed synchronization users may not totally match with the users on one organization of ABM</li>
</ol>
<p>So, I suggest that customer could provide a file which documents all needed users.Format like below:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">user1</span><br><span class="line">user2</span><br><span class="line">user3</span><br></pre></td></tr></table></figure>

<h1 id="code-change"><a href="#code-change" class="headerlink" title="code change"></a>code change</h1><ol>
<li>Save webclip policy: modify channel</li>
<li>Deploy webclip policy: modify channel + modify DG details</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/MDM/iOS%20webclip%20for%20shared%20ipads/syncUser/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/MDM/iOS%20webclip%20for%20shared%20ipads/syncUser/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-11-26 15:30:03" itemprop="dateCreated datePublished" datetime="2025-11-26T15:30:03+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>[TOC]</p>
<h1 id="Sync-device-user-info-to-CEM"><a href="#Sync-device-user-info-to-CEM" class="headerlink" title="Sync device user info to CEM"></a>Sync device user info to CEM</h1><h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>This script can read the user information in the text and synchronize the information to User Group of specified CEM site.</p>
<p>We could set the following command line arguments to synchronize user information.</p>
<p>![image-20221229161206535](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20221229161206535.png)</p>
<p>Also, for security reasons, we could also hardcode <code>clientId</code> and <code>clientSecret</code> here:</p>
<p>![image-20221229164540514](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20221229164540514.png)</p>
<h2 id="Environment-setup"><a href="#Environment-setup" class="headerlink" title="Environment setup"></a>Environment setup</h2><ul>
<li>Configure Golang enviroment: <a target="_blank" rel="noopener" href="https://go.dev/doc/install">https://go.dev/doc/install</a>  (go version should be higher than <strong>1.14</strong>)</li>
<li>Go to source code root directory, and compile: go build</li>
<li>Execute command</li>
</ul>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p>If we input such command, relevant user information will be added to specified CEM site.</p>
<ol>
<li><p>hardcode <code>clientId</code> and <code>clientSecret</code>: </p>
<blockquote>
<p>.&#x2F;addUser -fqdn <a target="_blank" rel="noopener" href="http://zzwsite1.xmqa.cloud.com/">zzwsite1.xmqa.cloud.com</a> -customerId zzwsite1 -filePath &#x2F;Users&#x2F;junkangd&#x2F;GoProject&#x2F;dailyTest&#x2F;userlist.txt</p>
</blockquote>
</li>
<li><p>user command arguments to set <code>clientId</code> and <code>clientSecret</code>: </p>
<blockquote>
<p>.&#x2F;addUser -fqdn <a target="_blank" rel="noopener" href="http://zzwsite1.xmqa.cloud.com/">zzwsite1.xmqa.cloud.com</a> -clientId xxxxxxxx -clientSecret xxxxxxx -customerId zzwsite1 -filePath &#x2F;Users&#x2F;junkangd&#x2F;GoProject&#x2F;dailyTest&#x2F;userlist.txt</p>
</blockquote>
</li>
</ol>
<img src="/Users/junkangd/Library/Application Support/typora-user-images/image-20221229162402271.png" alt="image-20221229162402271" style="zoom:150%;" />

<p>After executing the command, Need to <strong>bind this UG to specified DG manually.</strong></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/MDM/iOS%20webclip%20for%20shared%20ipads/feature%20doc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/MDM/iOS%20webclip%20for%20shared%20ipads/feature%20doc/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-11-26 15:30:03" itemprop="dateCreated datePublished" datetime="2025-11-26T15:30:03+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Since weblicp device policy does not support shared iPad device, we add this new feature on shared iPad here.</p>
<p>By adding profile scope, webclip device policy could be deployed on shared iPad when we set user channel.</p>
<p>Please add this policy in here(<a target="_blank" rel="noopener" href="https://docs.citrix.com/en-us/citrix-endpoint-management/device-management/apple/shared-ipads.html">https://docs.citrix.com/en-us/citrix-endpoint-management/device-management/apple/shared-ipads.html</a>).</p>
<p>Also, please notify that <code>Removable</code> option doesn’t work on shared iPad.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/MDM/iOS%20ESIM%20Configuration/esim%20investigation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/MDM/iOS%20ESIM%20Configuration/esim%20investigation/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-11-26 15:30:03" itemprop="dateCreated datePublished" datetime="2025-11-26T15:30:03+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><ol>
<li>实现MDM command – RefreshCellularPlansCommand</li>
<li>弄清楚console manage tab中device信息的显示逻辑</li>
<li>CEM console  支持显示双卡的信息（电话号码、ICCID）</li>
<li>CEM console  支持区别physical sim 和 e-sim </li>
<li>CEM console新增UI</li>
</ol>
<p>GetDeviceInfoCommand </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>Command<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>Queries<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>UDID<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>Languages<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>Locales<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>DeviceID<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>OrganizationInfo<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>LastCloudBackupDate&lt;/str</span><br><span class="line">            .....</span><br><span class="line">         <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">key</span>&gt;</span>RequestType<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>DeviceInformation<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>CommandUUID<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>0001_DeviceInformation<span class="tag">&lt;/<span class="name">string</span>&gt;</span> // generate a random command uuid</span><br></pre></td></tr></table></figure>

<p>GetDeviceInfoCommand调用链路:</p>
<p>![image-20230213155948346](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230213155948346.png)</p>
<ul>
<li><p>CEM send DeviceInformation command to iOS native mdm client, and receive DeviceInformation response which contains result of queries in request.</p>
<ul>
<li>Request</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>Command<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>Queries<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>UDID<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>Languages<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>Locales<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>DeviceID<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>OrganizationInfo<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>LastCloudBackupDate&lt;/str</span><br><span class="line">            .....</span><br><span class="line">         <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">key</span>&gt;</span>RequestType<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>DeviceInformation<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>CommandUUID<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>0001_DeviceInformation<span class="tag">&lt;/<span class="name">string</span>&gt;</span> // generate a random command uuid</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Response</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">dict&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>CommandUUID<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>0001_DeviceInformation<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>QueryResponses<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>ModelName<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>iPhone<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>ModemFirmwareVersion<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>2.01.08<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>OSVersion<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>13.0<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>PersonalHotspotEnabled<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">false</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>PhoneNumber<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span><span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>ProductName<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>iPhone11,8<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>SerialNumber<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>C7CX706CKWTK<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>SubscriberCarrierNetwork<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>ExampleCarrier<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>SubscriberMCC<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>001<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>SubscriberMNC<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>01<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>UDID<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>00008020-000915083C80012E<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>VoiceRoamingEnabled<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">false</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>WiFiMAC<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>58:fe:f5:80:29:f3<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>iTunesStoreAccountIsActive<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">false</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>Status<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>Acknowledged<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>UDID<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>00008020-000915083C80012E<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>Handle DeviceInformation command response</p>
</li>
</ul>
<p>![image-20230213174851321](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230213174851321.png)</p>
<h1 id="Tasks"><a href="#Tasks" class="headerlink" title="Tasks"></a>Tasks</h1><h2 id="Update-DeviceInformation-Queries"><a href="#Update-DeviceInformation-Queries" class="headerlink" title="Update DeviceInformation Queries"></a>Update DeviceInformation Queries</h2><p>Support for both physical SIM and for E-SIM</p>
<ul>
<li>PhonenNumber</li>
<li>Network(subscriptionProvider)</li>
<li>IMEI</li>
<li>ICCID</li>
</ul>
<p>notes: Is still fine to fetch above data such as IMEI and ICCID, if it’s deprecated, find an alternative.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/MDM/iOS%20ESIM%20Configuration/readme/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/MDM/iOS%20ESIM%20Configuration/readme/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-11-26 15:30:03" itemprop="dateCreated datePublished" datetime="2025-11-26T15:30:03+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Dual-Card-Display"><a href="#Dual-Card-Display" class="headerlink" title="Dual Card Display"></a>Dual Card Display</h1><p>deviceFilter api</p>
<p>device_property table 与 device table 通过device_id进行关联</p>
<ol>
<li>device_property</li>
<li>如何增加新的property</li>
<li>如何给新property赋值</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[&#123;IMEI=35 327271 933534 9, MEID=35327271933534, Slot=CTSubscriptionSlotOne&#125;, &#123;IMEI=35 327271 927898 6, MEID=35327271933534, Slot=CTSubscriptionSlotTwo&#125;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[&#123;CarrierSettingsVersion=53.0, CurrentCarrierNetwork=, CurrentMCC=65535, CurrentMNC=65535, ICCID=8986 0320 7475 5044 5837, IMEI=35 327271 933534 9, IsDataPreferred=true, IsRoaming=false, IsVoicePreferred=true, Label=Primary, LabelID=E308CCA8-9E1B-486F-9D0D-9626C042EB21, MEID=35327271933534, PhoneNumber=+8619928796215, Slot=CTSubscriptionSlotOne, SubscriberCarrierNetwork=中国电信&#125;, &#123;CarrierSettingsVersion=53.0, CurrentCarrierNetwork=CHN-UNICOM, CurrentMCC=460, CurrentMNC=01, ICCID=8986 0120 8017 3842 4636, IMEI=35 327271 927898 6, IsDataPreferred=false, IsRoaming=false, IsVoicePreferred=false, Label=Cellular Data, LabelID=A57C5493-A1B6-4F35-8CB7-1D50C6BF333A, MEID=35327271933534, PhoneNumber=+8618501406540, Slot=CTSubscriptionSlotTwo, SubscriberCarrierNetwork=中国联通&#125;]</span><br></pre></td></tr></table></figure>



<p>Write：</p>
<ul>
<li>GetDeviceNetworkInfoCommand.java: build data structure writen to the DB</li>
</ul>
<p>Read：</p>
<ul>
<li>PropertyHelper.java - initDeviceKnownPropertiesMap：modify the group of the data which read from the DB(Device_Property table)</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/MDM/DDM%20Basic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/MDM/DDM%20Basic/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-11-26 15:30:03" itemprop="dateCreated datePublished" datetime="2025-11-26T15:30:03+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="Declarations"><a href="#Declarations" class="headerlink" title="Declarations"></a>Declarations</h3><p>Declarations are the policies and configurations that your organization wishes to enforce on iOS and macOS devices. These can include, but are not limited to, email account configuration, passcodes, and restrictions. Like profiles, declarations are dictionaries that contain sets of keys and standard types for values that represent the payload to be applied to the device.</p>
<p>There are four types of declarations:</p>
<p><strong>Configuration</strong> – Configurations represent the policies to be applied to the device. These are similar to current profile payloads.</p>
<p><strong>Asset</strong> – This new concept with DDM provides ancillary data required by configurations. An asset references data, such as user identity or certificates. Assets can have a one-to-many relationship with configurations, meaning that a credential asset can be referenced by multiple configurations, avoiding the need to replicate the same information in each configuration.</p>
<p><strong>Activation</strong> – An activation is a declaration sub-type that is used to determine when to “activate” a configuration on a device. Each activation can be configured with prerequisites or “predicates” that must be met for successful activation of any configurations associated with it. Activations and configurations can have a many-to-many relationship, and all activations associated to a configuration must evaluate to true for the configuration to activate. The MDM server will send all declarations for any device state, and the device will determine which ones to apply based on the activations. For example, an activation might include a predicate that states the OS version must be “iOS 17.” If the OS version does not meet that predicate, the device will not activate the associated configurations.</p>
<p><strong>Management</strong> – A management declaration shares general information about the state of the device. This can include details about the organization or the capabilities of the MDM server.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/MDM/apple%20dep/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/MDM/apple%20dep/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-11-26 15:30:03" itemprop="dateCreated datePublished" datetime="2025-11-26T15:30:03+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>[TOC]</p>
<h1 id="Report"><a href="#Report" class="headerlink" title="Report"></a>Report</h1><ol>
<li>过了一遍customer issue的comments，对于背景有了大致的了解</li>
<li>阅读server background jobs的设计、quartz框架的基本原理和用法</li>
<li>尝试从AppleDepTaskJob入手，摸清楚<ol>
<li>job detail</li>
<li>trigger detail</li>
<li>quartz configuration：<ol>
<li>threadcount </li>
<li>misfireThreshold</li>
</ol>
</li>
</ol>
</li>
</ol>
<h1 id="Apple-DEP"><a href="#Apple-DEP" class="headerlink" title="Apple DEP"></a>Apple DEP</h1><p>Guide: <a target="_blank" rel="noopener" href="https://www.apple.com/mx/business-docs/DEP_Guide.pdf">https://www.apple.com/mx/business-docs/DEP_Guide.pdf</a></p>
<p>Bind <code>CEM</code> with <code>Apple DEP</code>: <a target="_blank" rel="noopener" href="https://mbautghfbery.xmqa.cloud.com:4443/index_uc.jsp#settings">https://mbautghfbery.xmqa.cloud.com:4443/index_uc.jsp#settings</a></p>
<h1 id="Customer-Issue"><a href="#Customer-Issue" class="headerlink" title="Customer Issue"></a>Customer Issue</h1><p><a target="_blank" rel="noopener" href="https://issues.citrite.net/browse/XMHELP-4071">DEP synchronization from ABM to CEM stopped working.</a></p>
<p>CEM lost ABM(Apple Business Manager) ‘s connection, because related background job failed or not run as expected, we need to find rootcause.</p>
<h1 id="CEM-DEP-Jobs"><a href="#CEM-DEP-Jobs" class="headerlink" title="CEM DEP Jobs"></a>CEM DEP Jobs</h1><h2 id="Quartz"><a href="#Quartz" class="headerlink" title="Quartz"></a>Quartz</h2><p><code>SchedulerFactoryBean</code> class: quartz integration with Spring</p>
<h3 id="Configuration-file"><a href="#Configuration-file" class="headerlink" title="Configuration file"></a>Configuration file</h3><ul>
<li>quartz.properties</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#实例名称</span></span><br><span class="line"><span class="attr">org.quartz.scheduler.instanceName</span>: <span class="string">DefaultQuartzScheduler</span></span><br><span class="line"><span class="comment">#远程方法调用</span></span><br><span class="line"><span class="attr">org.quartz.scheduler.rmi.export</span>: <span class="string">false</span></span><br><span class="line"><span class="attr">org.quartz.scheduler.rmi.proxy</span>: <span class="string">false</span></span><br><span class="line"><span class="comment">#是否将任务放在事务中执行</span></span><br><span class="line"><span class="attr">org.quartz.scheduler.wrapJobExecutionInUserTransaction</span>: <span class="string">false</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#线程池</span></span><br><span class="line"><span class="attr">org.quartz.threadPool.class</span>: <span class="string">org.quartz.simpl.SimpleThreadPool</span></span><br><span class="line"><span class="comment">#线程个数</span></span><br><span class="line"><span class="attr">org.quartz.threadPool.threadCount</span>: <span class="string">10</span></span><br><span class="line"><span class="comment">#线程优先级</span></span><br><span class="line"><span class="attr">org.quartz.threadPool.threadPriority</span>: <span class="string">5</span></span><br><span class="line"></span><br><span class="line"><span class="attr">org.quartz.threadPool.threadsInheritContextClassLoaderOfInitializingThread</span>: <span class="string">true</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#失火的阈值</span></span><br><span class="line"><span class="attr">org.quartz.jobStore.misfireThreshold</span>: <span class="string">60000</span></span><br><span class="line"><span class="comment">#使用内存方式存储</span></span><br><span class="line"><span class="attr">org.quartz.jobStore.class</span>: <span class="string">org.quartz.simpl.RAMJobStore</span></span><br></pre></td></tr></table></figure>

<h3 id="Listener"><a href="#Listener" class="headerlink" title="Listener"></a>Listener</h3><blockquote>
<p>Quartz的监听器用于当任务调度中你所关注事件发生时，能够及时获取这一事件的通知。类似于任务执行过程中的邮件、短信类的提醒。Quartz 的监听器有<strong>Job监听器，Trigger监听器， Scheduler监听器</strong>，对不同层面进行监控。三者的使用方法类似，</p>
</blockquote>
<ul>
<li>JobListener</li>
</ul>
<table>
<thead>
<tr>
<th>方法</th>
<th>作用或执行实际</th>
</tr>
</thead>
<tbody><tr>
<td>getName()</td>
<td>返回JobListener 的名称</td>
</tr>
<tr>
<td>jobToBeExecuted()</td>
<td>Scheduler 在JobDetail 将要被执行时调用这个方法</td>
</tr>
<tr>
<td>jobExecutionVetoed()</td>
<td>Scheduler 在JobDetail 即将被执行，但又被TriggerListener 否决了时调用这个方法</td>
</tr>
<tr>
<td>jobWasExecuted()</td>
<td>Scheduler 在JobDetail 被执行之后调用这个方法</td>
</tr>
</tbody></table>
<ul>
<li>triggerListener</li>
</ul>
<table>
<thead>
<tr>
<th>方法</th>
<th>作用或执行实际</th>
</tr>
</thead>
<tbody><tr>
<td>getName()</td>
<td>返回listener 的名称</td>
</tr>
<tr>
<td>triggerFired()</td>
<td>Trigger 被触发，Job 上的execute() 方法将要被执行时，Scheduler 就调用这个方法</td>
</tr>
<tr>
<td>vetoJobExecution()</td>
<td>在Trigger 触发后， Job 将要被执行时由Scheduler 调用这个方法。TriggerListener 给了一个选择去否决Job 的执行。假如这个方法返回true，这个Job 将不会为此次Trigger 触发而得到执行</td>
</tr>
<tr>
<td>triggerMisfired()</td>
<td>Trigger 错过触发时调用</td>
</tr>
<tr>
<td>triggerComplete()</td>
<td>Trigger 被触发并且完成了Job 的执行时，Scheduler 调用这个方法</td>
</tr>
</tbody></table>
<p><strong>BGJSchedulerFactoryBean–DynamicJobScheduler</strong></p>
<p>QuartzScheduleEngine2–Scheduler</p>
<h2 id="Apple-DEP-Background-Job"><a href="#Apple-DEP-Background-Job" class="headerlink" title="Apple DEP Background Job"></a>Apple DEP Background Job</h2><img src="/Users/junkangd/Library/Application Support/typora-user-images/image-20220906155554422.png" alt="image-20220906155554422" style="zoom:150%;" />

<p>initialize</p>
<p>![image-20220906163516544](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20220906163516544.png)</p>
<blockquote>
<blockquote>
<p> I saw there are lots of “misfired trigger” for “AppleDepTask”. This job is mainly for syncing devices from ABM.</p>
</blockquote>
</blockquote>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DebugLogFile.log.21:17924:2022-07-28T05:02:06.893+0000 | &quot;user.id=&quot; &quot;session.id=&quot; &quot;client.ip=&quot; &quot;push.info=&quot; &quot;transaction.id=&quot; |  WARN | DfltQuartzScheduler<span class="built_in">_</span>QuartzSchedulerThread | prodpod3egregq0g.xm.cloud.com | com.citrix.backgroundjobs.listeners.BGJTriggerListener | Misfired trigger Trigger &#x27;DEFAULT.appleDepTaskTrigger&#x27;:  triggerClass: &#x27;org.quartz.impl.triggers.SimpleTriggerImpl calendar: &#x27;null&#x27; misfireInstruction: 0 nextFireTime: Thu Jul 28 04:53:20 UTC 2022</span><br></pre></td></tr></table></figure>

<ol>
<li>job detail</li>
<li>trigger detail</li>
<li>quartz configuration：<ul>
<li>threadcount </li>
<li>misfireThreshold</li>
</ul>
</li>
</ol>
<h3 id="Xml-Configuration"><a href="#Xml-Configuration" class="headerlink" title="Xml Configuration"></a>Xml Configuration</h3><p>Service:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.sparus.nps.cron.tasks.AppleDepTask&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;appleDepServices&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;appleDepServices&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;deviceManager&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;com.sparus.nps.admin.impl.DeviceManagerImpl&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;depAccountManager&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;depAccountManager&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;depProfileManager&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;depProfileManager&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>SCHEDULER:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.citrix.backgroundjobs.BGJSchedulerFactoryBean&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:quartz-background-jobs.properties&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;startupDelay&quot;</span> <span class="attr">value</span>=<span class="string">&quot;30&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;overwriteExistingJobs&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>JOB:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;appleDepTaskJobDetail&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.scheduling.quartz.JobDetailFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jobClass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.citrix.backgroundjobs.jobs.AppleDepTaskJob&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;durability&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>TRIGGER:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;appleDepTaskTrigger&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.scheduling.quartz.SimpleTriggerFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jobDetail&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;appleDepTaskJobDetail&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;startDelay&quot;</span> <span class="attr">value</span>=<span class="string">&quot;60000&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;repeatInterval&quot;</span> <span class="attr">value</span>=<span class="string">&quot;300000&quot;</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>SimpleTrigger</li>
<li>CrontabTrigger</li>
</ul>
<p>LISTENER：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bgjTriggerListener&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.citrix.backgroundjobs.listeners.BGJTriggerListener&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bgjJobListener&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.citrix.backgroundjobs.listeners.BGJJobListener&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bgjSchedulerListener&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.citrix.backgroundjobs.listeners.BGJSchedulerListener&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="potential-misfire-reasons"><a href="#potential-misfire-reasons" class="headerlink" title="potential misfire reasons"></a>potential misfire reasons</h3><p>Sometimes Quartz is not capable of running your job at the time when you desired. There are three reasons for that:</p>
<ul>
<li>all worker threads were busy running other jobs (probably with higher priority)</li>
<li>the scheduler itself was down</li>
<li>the job was scheduled with start time in the past (probably a coding error)</li>
</ul>
<h3 id="solutions"><a href="#solutions" class="headerlink" title="solutions"></a>solutions</h3><ol>
<li>increase the number of worker threads by simply customizing the <code>org.quartz.threadPool.threadCount</code> in <code>quartz.properties</code> (default is 10).</li>
<li>increase the number of  <code>org.quartz.jobStore.misfireThreshold</code> (in milliseconds), defaulting to 60000 (a minute).</li>
<li>include “<strong>MISFIRE_INSTRUCTION</strong>“ with your trigger, set <code>SimpleTrigger.MISFIRE_INSTRUCTION_FIRE_NOW</code></li>
<li>modify <strong>priority</strong> of trigger</li>
</ol>
<h2 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h2><h3 id="Hikari"><a href="#Hikari" class="headerlink" title="Hikari"></a>Hikari</h3><blockquote>
<p>jdbc connection pool</p>
</blockquote>
<p>Monitor Hikari</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.citrix.xms.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.zaxxer.hikari.HikariDataSource;</span><br><span class="line"><span class="keyword">import</span> com.zaxxer.hikari.HikariPoolMXBean;</span><br><span class="line"><span class="keyword">import</span> org.apache.logging.log4j.LogManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.logging.log4j.Logger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HikariCPStatistics</span>  <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LogManager.getLogger(HikariCPStatistics.class);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HikariPoolMXBean poolProxy;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HikariCPStatistics</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// ((HikariDataSource)dataSource).getHikariPoolMXBean();</span></span><br><span class="line">        logger.info(<span class="string">&quot;HikariCPStatistics - initJunkang&quot;</span>);</span><br><span class="line">        poolProxy = ((HikariDataSource)MultiTenantDataSourceManager.getCurrentDataSource()).getHikariPoolMXBean();</span><br><span class="line">        logger.info(<span class="string">&quot;HikariCPStatistics - endJunkang&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        logger.info(<span class="string">&quot;HikariCPStatistics - Starting Connection Pool status monitor...&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;HikariCPStatistics - Idle Connections: &quot;</span> + poolProxy.getIdleConnections());</span><br><span class="line">            logger.info(<span class="string">&quot;HikariCPStatistics - Active Connections: &quot;</span> + poolProxy.getActiveConnections());</span><br><span class="line">            logger.info(<span class="string">&quot;HikariCPStatistics - Total Connections: &quot;</span> + poolProxy.getTotalConnections());</span><br><span class="line">            logger.info(<span class="string">&quot;HikariCPStatistics - ThreadAwaiting Connections: &quot;</span> + poolProxy.getThreadsAwaitingConnection());</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">60000</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                logger.error(<span class="string">&quot;HikariCPStatistics - Fail to run Connection Pool status monitor&quot;</span>);</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="background-job-architecure"><a href="#background-job-architecure" class="headerlink" title="background job architecure"></a>background job architecure</h2><p>xms-sever background job module follow module design below, rely on the quartz framework to complete the scheduling of background tasks </p>
<p>Devices are added to the ABM portal at point of purchase by the distributer, associated with the MDM solution of CEM  by IT </p>
<p>User activates the device the ABM forwards the device communications to your MDM solution of CEM for the user to enroll. </p>
<p>Once a device has been added to the ABM it will always be referred to the MDM solution of CEM for enrollment even after a factory reset</p>
<p>Devices are only removed when an IT admin of the ABM manually removes the device.</p>
<h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><p>Due to the lack of monitoring and alarm mechanisms for background jobs, we add some logic to monitor job and connection pool status.</p>
<h2 id="Changelist"><a href="#Changelist" class="headerlink" title="Changelist"></a>Changelist</h2><ul>
<li>Use <code>ConcurrentHashMap</code> to monitor execution time per job per tenant </li>
<li>Use <code>Executors</code> to monitor DB connection pool’s status.</li>
</ul>
<h2 id="B-L-A-S-T"><a href="#B-L-A-S-T" class="headerlink" title="B.L.A.S.T"></a>B.L.A.S.T</h2><p>Tier 0: Local Docker passed<br>Tier 1: cloud bvt—<a target="_blank" rel="noopener" href="https://apps.xm.citrite.net/automation-dashboard/project/3949/152701#scenario199757">https://apps.xm.citrite.net/automation-dashboard/project/3949/152701#scenario199757</a><br>L: No new logs<br>A: No new API<br>S: No new sql<br>T: No new unit tests</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/MDM/DDM%20-%20Valuable%20Feature/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/MDM/DDM%20-%20Valuable%20Feature/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-11-26 15:30:03" itemprop="dateCreated datePublished" datetime="2025-11-26T15:30:03+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Security-Policies"><a href="#Security-Policies" class="headerlink" title="Security Policies"></a>Security Policies</h1><p><strong>Configurations:</strong></p>
<ul>
<li>com.apple.configuration.security.certificate</li>
<li>com.apple.configuration.security.identity</li>
<li>com.apple.configuration.security.passkey.attestation</li>
</ul>
<p><strong>Assets:</strong></p>
<p>![image-20250715111121370](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20250715111121370.png)</p>
<h2 id="com-apple-configuration-security-certificate"><a href="#com-apple-configuration-security-certificate" class="headerlink" title="com.apple.configuration.security.certificate"></a>com.apple.configuration.security.certificate</h2><p>Related to legacy profile policy below</p>
<ul>
<li><strong>com.apple.security.pkcs1</strong>  </li>
<li><strong>com.apple.security.pem</strong>  </li>
<li><strong>com.apple.security.root</strong></li>
</ul>
<p>Add  a certificate to the device, not include private key.</p>
<h2 id="com-apple-configuration-security-identity"><a href="#com-apple-configuration-security-identity" class="headerlink" title="com.apple.configuration.security.identity"></a>com.apple.configuration.security.identity</h2><p>Related to legacy profile policy below:</p>
<ul>
<li><strong>com.apple.security.pkcs12</strong></li>
<li><strong>com.apple.security.scep</strong></li>
<li><strong>com.apple.security.acme</strong> (not implemented in CEM)</li>
</ul>
<p>Mostly used for identity authentication.</p>
<h2 id="com-apple-configuration-security-passkey-attestation"><a href="#com-apple-configuration-security-passkey-attestation" class="headerlink" title="com.apple.configuration.security.passkey.attestation"></a>com.apple.configuration.security.passkey.attestation</h2><p>For passkey authentication scenario.</p>
<h1 id="Account-Policies"><a href="#Account-Policies" class="headerlink" title="Account Policies"></a>Account Policies</h1><ul>
<li>com.apple.configuration.account.caldav: configure a Calendar account.</li>
<li>com.apple.configuration.account.carddav: configure a Contacts account.</li>
<li>com.apple.configuration.account.exchange: configure an Exchange account.</li>
<li>com.apple.configuration.account.ldap: configure a Lightweight Directory Access Protocol<br>  (LDAP) account.</li>
<li>com.apple.configuration.account.mail: configure a Mail account.</li>
<li>com.apple.configuration.account.subscribed-calendar: configure a subscribed calendar.</li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><h2 id="DDM-Assets-vs-传统-MDM-Profiles-的证书类型对比"><a href="#DDM-Assets-vs-传统-MDM-Profiles-的证书类型对比" class="headerlink" title="DDM Assets vs 传统 MDM Profiles 的证书类型对比"></a>DDM Assets vs 传统 MDM Profiles 的证书类型对比</h2><h3 id="架构层面的区别"><a href="#架构层面的区别" class="headerlink" title="架构层面的区别"></a><strong>架构层面的区别</strong></h3><h4 id="传统-MDM-Profiles-内嵌式"><a href="#传统-MDM-Profiles-内嵌式" class="headerlink" title="传统 MDM Profiles (内嵌式)"></a><strong>传统 MDM Profiles (内嵌式)</strong></h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">配置文件内嵌证书数据:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">com.apple.security.pkcs1</span>      <span class="comment"># DER 证书</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">com.apple.security.pkcs12</span>     <span class="comment"># 身份凭据  </span></span><br><span class="line"><span class="bullet">-</span> <span class="string">com.apple.security.pem</span>        <span class="comment"># PEM 证书</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">com.apple.security.root</span>       <span class="comment"># 根证书 (PKCS1别名)</span></span><br></pre></td></tr></table></figure>

<h4 id="DDM-Assets-外部引用式"><a href="#DDM-Assets-外部引用式" class="headerlink" title="DDM Assets (外部引用式)"></a><strong>DDM Assets (外部引用式)</strong></h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">外部引用证书资源:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">com.apple.asset.credential.certificate</span>    <span class="comment"># 对应 PKCS1/PEM</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">com.apple.asset.credential.identity</span>       <span class="comment"># 对应 PKCS12</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">com.apple.asset.credential.userpassword</span>   <span class="comment"># 新增类型</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">com.apple.asset.credential.scep</span>          <span class="comment"># 新增类型</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">com.apple.asset.credential.acme</span>          <span class="comment"># 新增类型</span></span><br></pre></td></tr></table></figure>

<h3 id="对应关系映射"><a href="#对应关系映射" class="headerlink" title="对应关系映射"></a><strong>对应关系映射</strong></h3><table>
<thead>
<tr>
<th>传统 MDM</th>
<th>DDM Asset</th>
<th>数据存储</th>
<th>更新方式</th>
</tr>
</thead>
<tbody><tr>
<td><strong>com.apple.security.pkcs1</strong></td>
<td><strong>com.apple.asset.credential.certificate</strong></td>
<td>配置文件内 → 外部URL</td>
<td>重推配置 → 动态拉取</td>
</tr>
<tr>
<td><strong>com.apple.security.pem</strong></td>
<td><strong>com.apple.asset.credential.certificate</strong></td>
<td>配置文件内 → 外部URL</td>
<td>重推配置 → 动态拉取</td>
</tr>
<tr>
<td><strong>com.apple.security.root</strong></td>
<td><strong>com.apple.asset.credential.certificate</strong></td>
<td>配置文件内 → 外部URL</td>
<td>重推配置 → 动态拉取</td>
</tr>
<tr>
<td><strong>com.apple.security.pkcs12</strong></td>
<td><strong>com.apple.asset.credential.identity</strong></td>
<td>配置文件内 → 外部URL</td>
<td>重推配置 → 动态拉取</td>
</tr>
<tr>
<td><strong>(无对应)</strong></td>
<td><strong>com.apple.asset.credential.userpassword</strong></td>
<td>-</td>
<td>DDM新增</td>
</tr>
<tr>
<td><strong>(无对应)</strong></td>
<td><strong>com.apple.asset.credential.scep</strong></td>
<td>-</td>
<td>DDM新增</td>
</tr>
<tr>
<td><strong>(无对应)</strong></td>
<td><strong>com.apple.asset.credential.acme</strong></td>
<td>-</td>
<td>DDM新增</td>
</tr>
</tbody></table>
<h3 id="技术实现差异"><a href="#技术实现差异" class="headerlink" title="技术实现差异"></a><strong>技术实现差异</strong></h3><h4 id="传统方式：数据内嵌"><a href="#传统方式：数据内嵌" class="headerlink" title="传统方式：数据内嵌"></a><strong>传统方式：数据内嵌</strong></h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 传统 MDM Profile --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>PayloadType<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span>&gt;</span>com.apple.security.pkcs1<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>PayloadContent<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span>MIICdgIBADANBgkqhkiG9w0...<span class="tag">&lt;/<span class="name">data</span>&gt;</span>  <span class="comment">&lt;!-- 直接嵌入证书 --&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="DDM方式：外部引用"><a href="#DDM方式：外部引用" class="headerlink" title="DDM方式：外部引用"></a><strong>DDM方式：外部引用</strong></h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># DDM Asset Declaration</span></span><br><span class="line"><span class="attr">Type:</span> <span class="string">com.apple.asset.credential.certificate</span></span><br><span class="line"><span class="attr">Reference:</span></span><br><span class="line">  <span class="attr">DataURL:</span> <span class="string">&quot;https://pki.company.com/cert.crt&quot;</span></span><br><span class="line">  <span class="attr">ContentType:</span> <span class="string">&quot;application/pkcs1&quot;</span></span><br><span class="line">  <span class="attr">Hash-SHA-256:</span> <span class="string">&quot;abc123...&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="具体类型分析"><a href="#具体类型分析" class="headerlink" title="具体类型分析"></a><strong>具体类型分析</strong></h3><h4 id="1-Certificate-Asset-统一证书资源"><a href="#1-Certificate-Asset-统一证书资源" class="headerlink" title="1. Certificate Asset (统一证书资源)"></a><strong>1. Certificate Asset (统一证书资源)</strong></h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">com.apple.asset.credential.certificate:</span></span><br><span class="line">  <span class="string">支持格式:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="string">application/pkcs1</span>  <span class="comment"># 对应传统 PKCS1</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">application/pem</span>    <span class="comment"># 对应传统 PEM</span></span><br><span class="line">  <span class="string">用途:</span> <span class="string">合并了</span> <span class="string">PKCS1/PEM/ROOT</span> <span class="string">到一个统一类型</span></span><br></pre></td></tr></table></figure>

<h4 id="2-Identity-Asset-身份凭据"><a href="#2-Identity-Asset-身份凭据" class="headerlink" title="2. Identity Asset (身份凭据)"></a><strong>2. Identity Asset (身份凭据)</strong></h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">com.apple.asset.credential.identity:</span></span><br><span class="line">  <span class="string">对应:</span> <span class="string">com.apple.security.pkcs12</span></span><br><span class="line">  <span class="string">数据格式:</span> <span class="string">JSON包装的PKCS12</span></span><br><span class="line">  <span class="string">新增特性:</span> <span class="string">Accessible</span> <span class="string">(钥匙串访问控制)</span></span><br></pre></td></tr></table></figure>

<h4 id="3-DDM-新增类型"><a href="#3-DDM-新增类型" class="headerlink" title="3. DDM 新增类型"></a><strong>3. DDM 新增类型</strong></h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 传统 MDM 没有的新类型</span></span><br><span class="line"><span class="string">com.apple.asset.credential.userpassword</span>  <span class="comment"># 用户名密码</span></span><br><span class="line"><span class="string">com.apple.asset.credential.scep</span>         <span class="comment"># SCEP自动申请</span></span><br><span class="line"><span class="string">com.apple.asset.credential.acme</span>         <span class="comment"># ACME自动申请</span></span><br></pre></td></tr></table></figure>

<h3 id="数据格式对比"><a href="#数据格式对比" class="headerlink" title="数据格式对比"></a><strong>数据格式对比</strong></h3><h4 id="传统-PKCS12"><a href="#传统-PKCS12" class="headerlink" title="传统 PKCS12"></a><strong>传统 PKCS12</strong></h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>PayloadContent<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span>PKCS12-binary-data-base64<span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>Password<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span>&gt;</span>cert-password<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="DDM-Identity-Asset"><a href="#DDM-Identity-Asset" class="headerlink" title="DDM Identity Asset"></a><strong>DDM Identity Asset</strong></h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 外部 JSON 文件</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;Type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;com.apple.credential.identity&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;Payload&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;PKCS12Data&quot;</span><span class="punctuation">:</span> <span class="string">&quot;base64-pkcs12-data&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cert-password&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="新增功能特性"><a href="#新增功能特性" class="headerlink" title="新增功能特性"></a><strong>新增功能特性</strong></h3><h4 id="1-钥匙串访问控制"><a href="#1-钥匙串访问控制" class="headerlink" title="1. 钥匙串访问控制"></a><strong>1. 钥匙串访问控制</strong></h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 仅 DDM 支持</span></span><br><span class="line"><span class="attr">Accessible:</span> <span class="string">&quot;AfterFirstUnlock&quot;</span>  <span class="comment"># 设备解锁后可用</span></span><br><span class="line"><span class="attr">Accessible:</span> <span class="string">&quot;Default&quot;</span>           <span class="comment"># 最严格访问级别</span></span><br></pre></td></tr></table></figure>

<h4 id="2-数据完整性验证"><a href="#2-数据完整性验证" class="headerlink" title="2. 数据完整性验证"></a><strong>2. 数据完整性验证</strong></h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># DDM 新增验证机制</span></span><br><span class="line"><span class="attr">Hash-SHA-256:</span> <span class="string">&quot;abc123...&quot;</span>  <span class="comment"># 文件哈希验证</span></span><br><span class="line"><span class="attr">Size:</span> <span class="number">2048</span>                 <span class="comment"># 文件大小验证</span></span><br><span class="line"><span class="attr">ContentType:</span> <span class="string">&quot;application/json&quot;</span>  <span class="comment"># MIME类型验证</span></span><br></pre></td></tr></table></figure>

<h4 id="3-认证方式"><a href="#3-认证方式" class="headerlink" title="3. 认证方式"></a><strong>3. 认证方式</strong></h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Authentication:</span></span><br><span class="line">  <span class="attr">Type:</span> <span class="string">MDM</span>   <span class="comment"># 使用设备身份认证</span></span><br><span class="line">  <span class="attr">Type:</span> <span class="string">None</span>  <span class="comment"># 公开访问</span></span><br></pre></td></tr></table></figure>

<h3 id="部署方式对比"><a href="#部署方式对比" class="headerlink" title="部署方式对比"></a><strong>部署方式对比</strong></h3><h4 id="传统-MDM-部署"><a href="#传统-MDM-部署" class="headerlink" title="传统 MDM 部署"></a><strong>传统 MDM 部署</strong></h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">步骤:</span></span><br><span class="line"><span class="number">1</span><span class="string">.</span> <span class="string">证书数据嵌入配置文件</span></span><br><span class="line"><span class="number">2</span><span class="string">.</span> <span class="string">推送完整配置文件到设备</span></span><br><span class="line"><span class="number">3</span><span class="string">.</span> <span class="string">更新需要重新推送整个配置</span></span><br><span class="line"></span><br><span class="line"><span class="string">限制:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">配置文件大小限制</span> <span class="string">(8MB)</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">更新效率低</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">无法动态更新</span></span><br></pre></td></tr></table></figure>

<h4 id="DDM-Asset-部署"><a href="#DDM-Asset-部署" class="headerlink" title="DDM Asset 部署"></a><strong>DDM Asset 部署</strong></h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">步骤:</span></span><br><span class="line"><span class="number">1</span><span class="string">.</span> <span class="string">证书文件部署到服务器</span></span><br><span class="line"><span class="number">2</span><span class="string">.</span> <span class="string">推送轻量级声明到设备</span></span><br><span class="line"><span class="number">3</span><span class="string">.</span> <span class="string">设备按需拉取证书文件</span></span><br><span class="line"></span><br><span class="line"><span class="string">优势:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">无文件大小限制</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">动态更新</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">缓存机制</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">完整性验证</span></span><br></pre></td></tr></table></figure>

<h3 id="企业迁移建议"><a href="#企业迁移建议" class="headerlink" title="企业迁移建议"></a><strong>企业迁移建议</strong></h3><h4 id="迁移映射"><a href="#迁移映射" class="headerlink" title="迁移映射"></a><strong>迁移映射</strong></h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从传统 MDM 迁移到 DDM</span></span><br><span class="line"><span class="string">com.apple.security.pkcs1</span> <span class="string">→</span> </span><br><span class="line">  <span class="attr">com.apple.asset.credential.certificate (ContentType:</span> <span class="string">application/pkcs1)</span></span><br><span class="line"></span><br><span class="line"><span class="string">com.apple.security.pem</span> <span class="string">→</span> </span><br><span class="line">  <span class="attr">com.apple.asset.credential.certificate (ContentType:</span> <span class="string">application/pem)</span></span><br><span class="line"></span><br><span class="line"><span class="string">com.apple.security.root</span> <span class="string">→</span> </span><br><span class="line">  <span class="string">com.apple.asset.credential.certificate</span> <span class="string">(用于根证书)</span></span><br><span class="line"></span><br><span class="line"><span class="string">com.apple.security.pkcs12</span> <span class="string">→</span> </span><br><span class="line">  <span class="string">com.apple.asset.credential.identity</span></span><br><span class="line"></span><br><span class="line"><span class="string">新增自动化证书管理:</span></span><br><span class="line">  <span class="string">com.apple.asset.credential.scep</span></span><br><span class="line">  <span class="string">com.apple.asset.credential.acme</span></span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a><strong>总结</strong></h3><p>DDM Assets 是传统 MDM 证书管理的<strong>现代化升级版本</strong>：</p>
<ul>
<li><strong>Certificate Asset</strong>: 统一了 PKCS1&#x2F;PEM&#x2F;ROOT，支持外部引用</li>
<li><strong>Identity Asset</strong>: 升级了 PKCS12，增加访问控制</li>
<li><strong>新增类型</strong>: 支持自动化证书管理 (SCEP&#x2F;ACME&#x2F;UserPassword)</li>
<li><strong>核心改进</strong>: 从内嵌数据转向外部引用，提供更好的扩展性和管理能力</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/6/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/8/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Supremes</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>

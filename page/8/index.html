<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 8.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js" defer></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/8/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Supremes">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/8/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/8/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Hexo</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  






  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Hexo</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Supremes</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">82</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/MDM/SSO%20Account%20-%20Kerberso/SSO%20Account%20Policy%20-%20deprecated/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/MDM/SSO%20Account%20-%20Kerberso/SSO%20Account%20Policy%20-%20deprecated/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-11-26 15:30:03" itemprop="dateCreated datePublished" datetime="2025-11-26T15:30:03+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SSO-Account-Policy"><a href="#SSO-Account-Policy" class="headerlink" title="SSO Account Policy"></a>SSO Account Policy</h1><p>Citrix Official Doc: <a target="_blank" rel="noopener" href="https://docs.citrix.com/en-us/citrix-endpoint-management/policies/sso-account-policy">https://docs.citrix.com/en-us/citrix-endpoint-management/policies/sso-account-policy</a></p>
<p>CEM Policy Configuration:</p>
<p>![image-20250708141128751](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20250708141128751.png)</p>
<p><strong>Apple Official Doc</strong></p>
<ul>
<li>Developer Doc<ul>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/devicemanagement/singlesignon/kerberos-data.dictionary?language=objc">https://developer.apple.com/documentation/devicemanagement/singlesignon/kerberos-data.dictionary?language=objc</a></li>
</ul>
</li>
<li>Support Doc:<ul>
<li><a target="_blank" rel="noopener" href="https://support.apple.com/en-in/guide/deployment/dep7a81f07b/web">https://support.apple.com/en-in/guide/deployment/dep7a81f07b/web</a></li>
</ul>
</li>
</ul>
<h1 id="Extensible-SSO-Kerberos"><a href="#Extensible-SSO-Kerberos" class="headerlink" title="Extensible SSO Kerberos"></a>Extensible SSO Kerberos</h1><p>The payload you use to configure an <strong>app extension</strong> that performs single sign-on with the Kerberos extension.</p>
<blockquote>
<p>The Kerberos SSO extension simplifies the process of acquiring a Kerberos ticket-granting ticket (TGT)  from your organization’s Active Directory domain, allowing users to seamlessly authenticate to resources  like websites, apps, and file servers.</p>
</blockquote>
<ul>
<li><p>The Kerberos SSO extension also helps your users manage their Active Directory accounts. </p>
</li>
<li><p>The Kerberos SSO extension should be used with an on-premise Active Directory domain. Azure Active  Directory isn’t supported.</p>
</li>
<li><p>iOS 13</p>
</li>
<li><p>An Active Directory domain running Windows Server 2008 or later</p>
</li>
<li><p>Access to the network where the Active Directory domain is hosted. This network access can be through  Wi-Fi, Ethernet, or <strong>VPN</strong>.</p>
</li>
</ul>
<h2 id="Enterprise-Connect"><a href="#Enterprise-Connect" class="headerlink" title="Enterprise Connect"></a>Enterprise Connect</h2><p>The Kerberos SSO extension is intended to replace Enterprise Connect. </p>
<p>What is Enterprise Connect?</p>
<h2 id="User-setup—iOS-and-iPadOS"><a href="#User-setup—iOS-and-iPadOS" class="headerlink" title="User setup—iOS and iPadOS"></a>User setup—iOS and iPadOS</h2><ol>
<li>Connect your device to a network where your organization’s Active Directory domain is available.  </li>
<li>Do one of the following:  <ul>
<li>Use Safari to access a website that supports Kerberos authentication.  </li>
<li>Launch an app that supports Kerberos authentication.</li>
</ul>
</li>
<li>Enter your Kerberos or Active Directory user name and password.  </li>
<li>You’ll be asked if you want to permanently sign in automatically. Most users should tap Yes.  </li>
<li>Tap Sign In. After a brief pause, your website or app will load. If you chose to sign in to the Kerberos SSO  extension automatically, you’ll no longer be prompted for credentials until you change your password.  If you didn’t choose to sign in automatically, you’ll be prompted for credentials only when your Kerberos  credential expires—usually in 10 hours.</li>
</ol>
<h2 id="Domain-realm-mapping"><a href="#Domain-realm-mapping" class="headerlink" title="Domain-realm mapping"></a>Domain-realm mapping</h2><p>A custom domain-realm mapping for Kerberos. The system uses this when the DNS name of hosts doesn’t match the realm name. Most administrators don’t need to customize this.</p>
<h2 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h2><h3 id="Required"><a href="#Required" class="headerlink" title="Required"></a>Required</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Realm</span><br><span class="line">string</span><br></pre></td></tr></table></figure>

<p><strong>(Required)</strong> </p>
<p>The Kerberos realm. Use proper capitalization for this value. If in an Active Directory forest, this is the realm where the user logs in.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ExtensionIdentifier</span><br><span class="line">string</span><br></pre></td></tr></table></figure>

<p><strong>(Required)</strong> </p>
<p>Set this to <code>com.apple.AppSSOKerberos.KerberosExtension</code> for this extension.</p>
<p>Value: <code>com.apple.AppSSOKerberos.KerberosExtension</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TeamIdentifier</span><br><span class="line">string</span><br></pre></td></tr></table></figure>

<p><strong>(Required)</strong> </p>
<p>Set this to <code>apple</code> for this extension.</p>
<p>Value: <code>apple</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Type</span><br><span class="line">string</span><br></pre></td></tr></table></figure>

<p><strong>(Required)</strong> </p>
<p>Set this to <code>Credential</code> for this extension.</p>
<p>Value: <code>Credential</code></p>
<h3 id="Optional"><a href="#Optional" class="headerlink" title="Optional"></a>Optional</h3><h4 id="Hosts"><a href="#Hosts" class="headerlink" title="Hosts"></a>Hosts</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hosts</span><br><span class="line">[string]</span><br></pre></td></tr></table></figure>

<p>One or more host or domain names for which the app extension performs SSO.</p>
<p>The system:</p>
<ul>
<li>Matches host or domain names case-insensitively</li>
<li>Requires that all the host and domain names of all installed Extensible SSO payloads are unique</li>
</ul>
<h4 id="ExtensionData"><a href="#ExtensionData" class="headerlink" title="ExtensionData"></a>ExtensionData</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">allowAutomaticLogin</span><br><span class="line">boolean</span><br></pre></td></tr></table></figure>

<p>If <code>false</code>, the system doesn’t allow saving passwords in the keychain.</p>
<p>Default: <code>true</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">certificateUUID</span><br><span class="line">string</span><br></pre></td></tr></table></figure>

<p>The PayloadUUID of a PKINIT certificate.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">credentialBundleIdACL</span><br><span class="line">[string]</span><br></pre></td></tr></table></figure>

<p>A list of bundle IDs allowed to access the ticket-granting ticket (TGT).</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">credentialUseMode</span><br><span class="line">string</span><br></pre></td></tr></table></figure>

<p>This setting affects how other processes use the Kerberos Extension credential. Allowed values:</p>
<ul>
<li><code>always</code>: The system always uses the credential if the SPN matches the Kerberos Extension <code>Hosts</code> array and the caller hasn’t specified another credential. However, the system won’t use the credential if the calling app isn’t in the <code>credentialBundleIDACL</code>.</li>
<li><code>whenNotSpecified</code>: The system only uses the extension credential if the SPN matches the Kerberos Extension <code>Hosts</code> array. However, the system won’t use the credential if the calling app isn’t in the <code>credentialBundleIDACL</code>.</li>
<li><code>kerberosDefault</code>: The system uses the default Kerberos processes to select credentials, and normally uses the default Kerberos credential. This is the same as turning off this capability.</li>
</ul>
<p>Available in macOS 11 and later.</p>
<p>Default: <code>always</code></p>
<p>Possible Values: <code>always, whenNotSpecified, kerberosDefault</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">customUsernameLabel</span><br><span class="line">string</span><br></pre></td></tr></table></figure>

<p>The custom user name label used in the Kerberos extension instead of “Username,” such as “Company ID”. Available in macOS 11 and later.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">helpText</span><br><span class="line">string</span><br></pre></td></tr></table></figure>

<p>The text to display to the user at the bottom of the Kerberos login window. You can also use this to display help information or disclaimer text. Available in iOS 14 and later, and macOS 11 and later.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">includeManagedAppsInBundleIdACL</span><br><span class="line">boolean</span><br></pre></td></tr></table></figure>

<p>If <code>true</code>, the Kerberos extension allows only managed apps to access and use the credential. This is in addition to the <code>credentialBundleIDACL</code>, if you specify that value. Available in iOS 14 and later, and macOS 12 and later.</p>
<p>Default: <code>false</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">isDefaultRealm</span><br><span class="line">boolean</span><br></pre></td></tr></table></figure>

<p>Specifies whether this is the default realm if there’s more than one Kerberos extension configuration.</p>
<p>Default: <code>false</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">performKerberosOnly</span><br><span class="line">boolean</span><br></pre></td></tr></table></figure>

<p>If <code>true</code>, the Kerberos Extension handles Kerberos requests only. It doesn’t check for password expiration, show the password expiration in the menu, check for external password changes, perform password sync, or retrieve the home directory. Available in macOS 13 and later.</p>
<p>Default: <code>false</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">preferredKDCs</span><br><span class="line">[string]</span><br></pre></td></tr></table></figure>

<p>The ordered list of preferred Key Distribution Centers (KDCs) to use for Kerberos traffic. Use this if the servers aren’t discoverable through DNS. If the servers are specified, then the system uses them for both connectivity checks and attempts to use them first for Kerberos traffic. If the servers don’t respond, the device falls back to DNS discovery. Format each entry the same as it would be in a <code>krb5.conf</code> file, for example:</p>
<ul>
<li><code>adserver1.example.com</code></li>
<li><code>tcp/adserver1.example.com:88</code></li>
<li><code>kkdcp://kerberosproxy.example.com:443/kkdcp</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">principalName</span><br><span class="line">string</span><br></pre></td></tr></table></figure>

<p>The principal (username) to use. You don’t need to include the realm.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">requireTLSForLDAP</span><br><span class="line">boolean</span><br></pre></td></tr></table></figure>

<p>Require that LDAP connections use TLS. Available in macOS 11 and later.</p>
<p>Default: <code>false</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">requireUserPresence</span><br><span class="line">boolean</span><br></pre></td></tr></table></figure>

<p>If <code>true</code>, the system requires the user to provide Touch ID, Face ID or their passcode to access the keychain entry.</p>
<p>Default: <code>false</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">siteCode</span><br><span class="line">string</span><br></pre></td></tr></table></figure>

<p>The name of the Active Directory site the Kerberos extension should use. Most administrators don’t need to modify this value, as the Kerberos extension can normally find the site automatically.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">useSiteAutoDiscovery</span><br><span class="line">boolean</span><br></pre></td></tr></table></figure>

<p>If <code>false</code>, the Kerberos extension doesn’t automatically use LDAP and DNS to determine its AD site name.</p>
<p>Default: <code>true</code></p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>Official Doc: </p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.apple.com/business/docs/site/Kerberos_Single_Sign_on_Extension_User_Guide.pdf">https://www.apple.com/business/docs/site/Kerberos_Single_Sign_on_Extension_User_Guide.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/devicemanagement/extensiblesinglesignonkerberos?language=objc">https://developer.apple.com/documentation/devicemanagement/extensiblesinglesignonkerberos?language=objc</a></li>
</ul>
<p>Video:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/videos/play/wwdc2020/10139/">https://developer.apple.com/videos/play/wwdc2020/10139/</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/videos/play/tech-talks/301/">https://developer.apple.com/videos/play/tech-talks/301/</a></li>
</ul>
<p>Onimasa:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://techzone.omnissa.com/resource/migrating-mobile-sso-ios-new-mobile-sso-apple-extension#sso-extension-based-mobile-sso-for-apple">https://techzone.omnissa.com/resource/migrating-mobile-sso-ios-new-mobile-sso-apple-extension#sso-extension-based-mobile-sso-for-apple</a></li>
</ul>
<p>Intune:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/intune/intune-service/configuration/use-enterprise-sso-plug-in-ios-ipados-macos?pivots=ios-ipados#sso-app-extension">https://learn.microsoft.com/en-us/intune/intune-service/configuration/use-enterprise-sso-plug-in-ios-ipados-macos?pivots=ios-ipados#sso-app-extension</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/intune/intune-service/configuration/ios-device-features-settings#single-sign-on">https://learn.microsoft.com/en-us/intune/intune-service/configuration/ios-device-features-settings#single-sign-on</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/intune/intune-service/configuration/use-enterprise-sso-plug-in-ios-ipados-with-intune?tabs=prereq-other-mdm,create-profile-other-mdm">https://learn.microsoft.com/en-us/intune/intune-service/configuration/use-enterprise-sso-plug-in-ios-ipados-with-intune?tabs=prereq-other-mdm%2Ccreate-profile-other-mdm</a></li>
</ul>
<h1 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h1><ul>
<li><input checked="" disabled="" type="checkbox"> Deploy <code>SSO Account Policy</code> to device<ul>
<li><input checked="" disabled="" type="checkbox"> iOS 26</li>
<li><input checked="" disabled="" type="checkbox"> lower than 26: iOS 17&#x2F;18</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> Go through the new policy <code>Extensible SSO Kerberos</code> documents</li>
<li><input disabled="" type="checkbox"> Consider to build Kerberos back-end service, to configure ON-PREM AD?</li>
<li><input disabled="" type="checkbox"> develop new policy</li>
</ul>
<h1 id="Difference-SSO-Extension-SSO-Kerberos"><a href="#Difference-SSO-Extension-SSO-Kerberos" class="headerlink" title="Difference - SSO Extension &#x2F; SSO Kerberos"></a>Difference - SSO Extension &#x2F; SSO Kerberos</h1><ul>
<li><p>Type : Redirect Type VS Credential Type</p>
</li>
<li><p>ExtensionIdentifier: </p>
<ul>
<li><p>Microsoft Entra SSO extension(AAD) or a generic redirect extension(self developed).</p>
<p>The Microsoft Enterprise SSO plug-in relies on Apple’s <a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/authenticationservices">enterprise SSO</a> framework. Apple’s enterprise SSO framework ensures that only an approved SSO plug-in can work for each identity provider by utilizing a technology called <a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/xcode/supporting-associated-domains">associated domains</a>. To verify the identity of the SSO plug-in, each Apple device sends a network request to an endpoint owned by the identity provider and read information about approved SSO plug-ins. In addition to reaching out directly to the identity provider, Apple has also implemented another caching for this information.</p>
</li>
<li><p>Kerberos-specific credential extension provided by Apple(AD)</p>
</li>
</ul>
<p>![image-20250711153611179](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20250711153611179.png)</p>
</li>
</ul>
<table>
<thead>
<tr>
<th align="left">Microsoft Enterprise SSO plug-in for Apple Devices</th>
<th align="left">Single sign-on app extension with Kerberos</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Uses the <strong>Microsoft Entra ID</strong> SSO app extension type</td>
<td align="left">Uses the <strong>Kerberos</strong> SSO app extension type</td>
</tr>
<tr>
<td align="left">Supports the following apps: - Microsoft 365 - Apps, websites or services integrated with Microsoft Entra ID</td>
<td align="left">Supports the following apps: - Apps, websites or services integrated with AD</td>
</tr>
</tbody></table>
<h1 id="Tickets"><a href="#Tickets" class="headerlink" title="Tickets"></a>Tickets</h1><p>Extensible SSO Extension</p>
<ul>
<li><input disabled="" type="checkbox"> [SSO Kerberos Extension] - Add Policy UI for extensible sso kerberos extension policy - 2</li>
<li><input disabled="" type="checkbox"> [SSO  Extension] - Add Policy UI for extensible sso extension policy - 2</li>
<li><input disabled="" type="checkbox"> [SSO Kerberos Extension] - Create extensible sso kerberos extension configuration profile policy payload - 3</li>
<li><input disabled="" type="checkbox"> [SSO  Extension] - Create extensible sso extension configuration profile policy payload - 3</li>
<li><input disabled="" type="checkbox"> [SSO Kerberos Extension] - Configure onprem Active Diretory domain server. - 2</li>
<li><input disabled="" type="checkbox"> [SSO Extension] - SecureHub Develop SSO Extension - Support Authentication Services  - 3</li>
<li><input disabled="" type="checkbox"> [SSO Extension] - SecureHub Develop SSO Extension - Support Associated Domains - 3</li>
<li><input disabled="" type="checkbox"> Dev Test - 3</li>
<li><input disabled="" type="checkbox"> Demo video and feature guideline doc - 2</li>
<li><input disabled="" type="checkbox"> CQE test plan creation and review - 3</li>
<li><input disabled="" type="checkbox"> Feature Flag</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/MDM/DDM%20-%20SoftwareUpdateSettings/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/MDM/DDM%20-%20SoftwareUpdateSettings/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-11-26 15:30:03" itemprop="dateCreated datePublished" datetime="2025-11-26T15:30:03+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Beta"><a href="#Beta" class="headerlink" title="Beta"></a>Beta</h1><h2 id="字段规则"><a href="#字段规则" class="headerlink" title="字段规则"></a>字段规则</h2><table>
<thead>
<tr>
<th>ProgramEnrollment 值</th>
<th>OfferPrograms 存在条件</th>
<th>RequireProgram 存在条件</th>
<th>互斥规则与说明</th>
</tr>
</thead>
<tbody><tr>
<td>Allowed</td>
<td>允许存在</td>
<td>禁止存在</td>
<td>用户可选择OfferPrograms中的程序或Apple Account关联的Beta程序</td>
</tr>
<tr>
<td>AlwaysOn</td>
<td>允许存在（当RequireProgram不存在时）</td>
<td>允许存在（当OfferPrograms不存在时）</td>
<td>RequireProgram与OfferPrograms互斥，若RequireProgram存在，设备自动加入指定程序；否则用户从OfferPrograms选择</td>
</tr>
<tr>
<td>AlwaysOff</td>
<td>禁止存在</td>
<td>禁止存在</td>
<td>设备禁止加入任何Beta程序，并退出已加入的程序</td>
</tr>
</tbody></table>
<h2 id="补充规则"><a href="#补充规则" class="headerlink" title="补充规则"></a>补充规则</h2><ol>
<li><p><strong>ProgramEnrollment为Allowed或AlwaysOn时</strong>：  </p>
<ul>
<li>若同时存在 <code>OfferPrograms</code>，用户可在这些程序中选择（或Apple Account关联程序，当ProgramEnrollment&#x3D;Allowed时）。</li>
<li>若 <code>RequireProgram</code> 存在，则 <code>OfferPrograms</code> 必须不存在，且仅当 <code>ProgramEnrollment=AlwaysOn</code> 时允许。</li>
</ul>
</li>
<li><p><strong>默认行为</strong>：  </p>
<ul>
<li>未显式配置时，<code>ProgramEnrollment</code> 默认为 <code>Allowed</code>。</li>
<li>非监管设备若未声明 <code>ProgramEnrollment</code>，则隐式视为 <code>Allowed</code>，此时 <code>OfferPrograms</code> 允许存在。</li>
</ul>
</li>
</ol>
<table>
<thead>
<tr>
<th>Download</th>
<th>InstallOSUpdates</th>
<th align="left">组合描述</th>
<th>Result</th>
</tr>
</thead>
<tbody><tr>
<td>Allowed</td>
<td>Allowed</td>
<td align="left">下载和安装都允许用户选择</td>
<td>✅</td>
</tr>
<tr>
<td>Allowed</td>
<td>AlwaysOn</td>
<td align="left">下载允许，安装始终开启</td>
<td>✅</td>
</tr>
<tr>
<td>Allowed</td>
<td>AlwaysOff</td>
<td align="left">下载允许，安装始终关闭</td>
<td>✅</td>
</tr>
<tr>
<td>AlwaysOn</td>
<td>Allowed</td>
<td align="left">下载始终开启，安装允许选择</td>
<td>✅</td>
</tr>
<tr>
<td>AlwaysOn</td>
<td>AlwaysOn</td>
<td align="left">下载和安装都始终开启</td>
<td>✅</td>
</tr>
<tr>
<td>AlwaysOn</td>
<td>AlwaysOff</td>
<td align="left">下载始终开启，安装始终关闭</td>
<td>✅</td>
</tr>
<tr>
<td>AlwaysOff</td>
<td>Allowed</td>
<td align="left">下载始终关闭，安装允许选择</td>
<td>✅</td>
</tr>
<tr>
<td>AlwaysOff</td>
<td>AlwaysOn</td>
<td align="left">下载始终关闭，安装始终开启</td>
<td>❌</td>
</tr>
<tr>
<td>AlwaysOff</td>
<td>AlwaysOff</td>
<td align="left">下载和安装都始终关闭</td>
<td>✅</td>
</tr>
</tbody></table>
<h1 id="Download-and-InstallOSUpdates-Combinations"><a href="#Download-and-InstallOSUpdates-Combinations" class="headerlink" title="Download and InstallOSUpdates Combinations"></a>Download and InstallOSUpdates Combinations</h1><table>
<thead>
<tr>
<th>Download</th>
<th>InstallOSUpdates</th>
<th>Description</th>
<th>Result</th>
</tr>
</thead>
<tbody><tr>
<td>Allowed</td>
<td>Allowed</td>
<td>Both download and install are user-configurable</td>
<td>✅</td>
</tr>
<tr>
<td>Allowed</td>
<td>AlwaysOn</td>
<td>Download is user-configurable, install is always on</td>
<td>✅</td>
</tr>
<tr>
<td>Allowed</td>
<td>AlwaysOff</td>
<td>Download is user-configurable, install is always off</td>
<td>✅</td>
</tr>
<tr>
<td>AlwaysOn</td>
<td>Allowed</td>
<td>Download is always on, install is user-configurable</td>
<td>✅</td>
</tr>
<tr>
<td>AlwaysOn</td>
<td>AlwaysOn</td>
<td>Both download and install are always on</td>
<td>✅</td>
</tr>
<tr>
<td>AlwaysOn</td>
<td>AlwaysOff</td>
<td>Download is always on, install is always off</td>
<td>✅</td>
</tr>
<tr>
<td>AlwaysOff</td>
<td>Allowed</td>
<td>Download is always off, install is user-configurable</td>
<td>✅</td>
</tr>
<tr>
<td>AlwaysOff</td>
<td>AlwaysOn</td>
<td>Download is always off, install is always on</td>
<td>❌</td>
</tr>
<tr>
<td>AlwaysOff</td>
<td>AlwaysOff</td>
<td>Both download and install are always off</td>
<td>✅</td>
</tr>
</tbody></table>
<p>Hi everyone, we add a new OS Update policy named Software Update Enforcement based on DDM. This update gives IT admins more control over iOS device updates, allowing them to control which updates are applied and set deadlines.</p>
<p>There are 2 required fields and 2 optional fields, You can either pick the Target OS Version from a dropdown or type it in yourself..</p>
<p>After the policy deployed to the device, we could check the device status. </p>
<ul>
<li><p>MDM Profile - Configuration to view the policy content</p>
</li>
<li><p>General - Software Update to view the applied target OS version.</p>
</li>
</ul>
<p>What’s more, the policy takes precedence over the legacy mdm policy - control os update, if admin deployed these two policy to the device, the control os update may take no effect.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/Secure%20Apps%20Build/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/Secure%20Apps%20Build/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-11-26 15:30:03" itemprop="dateCreated datePublished" datetime="2025-11-26T15:30:03+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="sm"><a href="#sm" class="headerlink" title="sm"></a>sm</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">SM setting</span><br><span class="line">[self writeFrameworkLoaderSDKLookupFileWithSDKType:MDXSDKTypeExplicit];</span><br><span class="line">1. set bundle id to</span><br><span class="line">com.citrix.mail.ios.InternalTest</span><br><span class="line">com.citrix.mail.ios.InternalTest.notifext</span><br><span class="line">com.citrix.mail.ios.InternalTest.calldirext</span><br><span class="line">in 3 plist files, set $(PRODUCT_BUNDLE_IDENTIFIER)</span><br><span class="line">2. enable auto sign</span><br><span class="line">3. set team to</span><br><span class="line">Citrix Systems Inc.</span><br><span class="line">4. remove 4 app groups</span><br><span class="line">5. choose schema WorxMailAppStore</span><br><span class="line">6. request access to</span><br><span class="line">https://code.citrite.net/projects/gsrv/repos/g11n_cocoapods</span><br></pre></td></tr></table></figure>

<h1 id="sw"><a href="#sw" class="headerlink" title="sw"></a>sw</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1. set bundle id to</span><br><span class="line">com.citrix.browser.ios.InternalTest</span><br><span class="line">2. enable auto sign</span><br><span class="line">3. set team to</span><br><span class="line">Citrix Systems Inc.</span><br><span class="line">4. choose schema WorxWebAppStore</span><br><span class="line">Queried URL Schemes</span><br><span class="line">zenprisedmpostenroll</span><br><span class="line">com.citrix.x1</span><br><span class="line">citrixreceiverfd</span><br><span class="line">com.citrix.ctxcwatestapp</span><br><span class="line">&lt;key&gt;LSApplicationQueriesSchemes&lt;/key&gt; &lt;array&gt; &lt;string&gt;zenprisedmpostenroll&lt;/string&gt; &lt;string&gt;com.citrix.x1&lt;/string&gt; &lt;string&gt;citrixreceiverfd&lt;/string&gt; &lt;string&gt;com.citrix.ctxcwatestapp&lt;/string&gt; &lt;/array&gt;</span><br><span class="line">6. add exit in remove unused archs</span><br><span class="line">7. remove -ld from other linker flags</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>com.citrix.meatwork</p>
<h1 id="SH"><a href="#SH" class="headerlink" title="SH"></a>SH</h1><p>com.zenprise.zpmdmbetaIntenal</p>
<h1 id="SwifttestApp"><a href="#SwifttestApp" class="headerlink" title="SwifttestApp"></a>SwifttestApp</h1><p>com.citrix.SwiftTestApp.iOS.InternalTest<br>com.citrix.SwiftTestApp.iOS.InternalTest.CustomKeyboard</p>
<p>Citrix Systems Inc.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/hello-world/" class="post-title-link" itemprop="url">Hello World</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-11-26 14:39:19" itemprop="dateCreated datePublished" datetime="2025-11-26T14:39:19+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/Hibernate/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/Hibernate/" class="post-title-link" itemprop="url">Hibernate</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2025-11-26 00:00:00 / Modified: 15:43:52" itemprop="dateCreated datePublished" datetime="2025-11-26T00:00:00+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Hibernate"><a href="#Hibernate" class="headerlink" title="Hibernate"></a>Hibernate</h1><p>Hibernate 是一个用于 Java 环境的开源对象关系映射(ORM)框架,XML 映射文件是 Hibernate 配置实体类和数据库表之间映射关系的重要方式。以下是 Hibernate XML 映射文件中常见标签的介绍:</p>
<h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><p>在 Spring 框架中使用 Hibernate 作为 ORM 框架时，需要导入以下相关库（依赖项）。以下是基于 Maven 或 Gradle 的依赖配置，具体依赖取决于你使用的 Spring 版本、Hibernate 版本以及是否使用 JPA。</p>
<h3 id="1-核心依赖"><a href="#1-核心依赖" class="headerlink" title="1. 核心依赖"></a>1. <strong>核心依赖</strong></h3><h4 id="Hibernate-Core"><a href="#Hibernate-Core" class="headerlink" title="Hibernate Core"></a>Hibernate Core</h4><p>Hibernate 的核心库，提供基本的 ORM 功能。</p>
<ul>
<li><strong>Maven</strong>:<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.hibernate<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hibernate-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.6.15.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span> <span class="comment">&lt;!-- 替换为最新稳定版本 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><strong>Gradle</strong>:<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">&#x27;org.hibernate:hibernate-core:5.6.15.Final&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Spring-ORM"><a href="#Spring-ORM" class="headerlink" title="Spring ORM"></a>Spring ORM</h4><p>Spring 提供的 ORM 模块，集成 Hibernate 并简化配置（如 <code>SessionFactory</code> 管理）。</p>
<ul>
<li><strong>Maven</strong>:<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-orm<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span> <span class="comment">&lt;!-- 与你的 Spring 版本保持一致 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><strong>Gradle</strong>:<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">&#x27;org.springframework:spring-orm:5.3.27&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-数据库驱动"><a href="#2-数据库驱动" class="headerlink" title="2. 数据库驱动"></a>2. <strong>数据库驱动</strong></h3><p>需要根据你使用的数据库（如 MySQL、PostgreSQL 等）添加对应的 JDBC 驱动。例如：</p>
<ul>
<li><p><strong>MySQL 驱动</strong>:</p>
<ul>
<li><strong>Maven</strong>:<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.33<span class="tag">&lt;/<span class="name">version</span>&gt;</span> <span class="comment">&lt;!-- 替换为最新版本 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><strong>Gradle</strong>:<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">&#x27;mysql:mysql-connector-java:8.0.33&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>PostgreSQL 驱动</strong>（示例）:</p>
<ul>
<li><strong>Maven</strong>:<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.postgresql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>postgresql<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>42.7.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><strong>Gradle</strong>:<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">&#x27;org.postgresql:postgresql:42.7.3&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="3-可选依赖"><a href="#3-可选依赖" class="headerlink" title="3. 可选依赖"></a>3. <strong>可选依赖</strong></h3><h4 id="连接池（推荐）"><a href="#连接池（推荐）" class="headerlink" title="连接池（推荐）"></a>连接池（推荐）</h4><p>为了提高性能，通常使用数据库连接池（如 HikariCP、C3P0 或 DBCP）。Spring Boot 默认使用 HikariCP。</p>
<ul>
<li><strong>HikariCP</strong>:<ul>
<li><strong>Maven</strong>:<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.zaxxer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>HikariCP<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><strong>Gradle</strong>:<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">&#x27;com.zaxxer:HikariCP:5.0.1&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h4 id="如果使用-Spring-Boot"><a href="#如果使用-Spring-Boot" class="headerlink" title="如果使用 Spring Boot"></a>如果使用 Spring Boot</h4><p>Spring Boot 提供了 starter 依赖，简化配置：</p>
<ul>
<li><strong>Maven</strong>:<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.18<span class="tag">&lt;/<span class="name">version</span>&gt;</span> <span class="comment">&lt;!-- 与你的 Spring Boot 版本一致 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><strong>Gradle</strong>:<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">&#x27;org.springframework.boot:spring-boot-starter-data-jpa:2.7.18&#x27;</span></span><br></pre></td></tr></table></figure>
<strong>说明</strong>：<code>spring-boot-starter-data-jpa</code> 已经包含了 Hibernate、Spring ORM 和 JPA 相关依赖，并默认配置 HikariCP。你还需要单独添加数据库驱动（如 MySQL）。</li>
</ul>
<h3 id="4-版本注意事项"><a href="#4-版本注意事项" class="headerlink" title="4. 版本注意事项"></a>4. <strong>版本注意事项</strong></h3><ul>
<li><strong>Hibernate 版本</strong>：推荐使用最新稳定版（截至 2025 年 4 月，5.6.x 或 6.x 系列）。Hibernate 6.x 要求 JDK 11+ 并有重大变更（如去掉 <code>hibernate-entitymanager</code> 包）。</li>
<li><strong>Spring 版本</strong>：确保 Spring 和 Hibernate 版本兼容。例如，Spring 5.x 通常与 Hibernate 5.x 搭配，Spring 6.x 与 Hibernate 6.x 更兼容。</li>
<li><strong>Spring Boot</strong>：如果使用 Spring Boot，<code>spring-boot-starter-data-jpa</code> 会自动管理兼容的 Hibernate 版本。</li>
</ul>
<h3 id="5-典型配置示例（非-Spring-Boot）"><a href="#5-典型配置示例（非-Spring-Boot）" class="headerlink" title="5. 典型配置示例（非 Spring Boot）"></a>5. <strong>典型配置示例（非 Spring Boot）</strong></h3><p>在 Spring 配置文件（如 <code>applicationContext.xml</code>）中配置 Hibernate：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.zaxxer.hikari.HikariDataSource&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/yourdb&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;password&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate5.LocalSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;packagesToScan&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.example.model&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernateProperties&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.dialect&quot;</span>&gt;</span>org.hibernate.dialect.MySQL8Dialect<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.show_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.hbm2ddl.auto&quot;</span>&gt;</span>update<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate5.HibernateTransactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sessionFactory&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="6-Spring-Boot-配置"><a href="#6-Spring-Boot-配置" class="headerlink" title="6. Spring Boot 配置"></a>6. <strong>Spring Boot 配置</strong></h3><p>如果使用 Spring Boot，只需在 <code>application.properties</code> 或 <code>application.yml</code> 中配置：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/yourdb</span></span><br><span class="line"><span class="attr">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">spring.datasource.password</span>=<span class="string">password</span></span><br><span class="line"><span class="attr">spring.jpa.hibernate.ddl-auto</span>=<span class="string">update</span></span><br><span class="line"><span class="attr">spring.jpa.show-sql</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">spring.jpa.properties.hibernate.dialect</span>=<span class="string">org.hibernate.dialect.MySQL8Dialect</span></span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li><strong>最小依赖</strong>：<code>hibernate-core</code>、<code>spring-orm</code>、数据库驱动。</li>
<li><strong>推荐（Spring Boot）</strong>：<code>spring-boot-starter-data-jpa</code> + 数据库驱动。</li>
<li><strong>JPA 场景</strong>：添加 <code>hibernate-entitymanager</code>（Hibernate 5.x）。</li>
<li><strong>连接池</strong>：建议使用 HikariCP。</li>
</ul>
<p>如果使用 Spring Boot，<code>spring-boot-starter-data-jpa</code> 是最简便的方式。如果是传统 Spring 项目，需手动添加 Hibernate 和 Spring ORM 依赖。确保版本兼容，并根据数据库类型选择合适的驱动。</p>
<p>如果你有具体场景（例如 Spring Boot 版本、数据库类型）或遇到配置问题，请提供更多细节，我可以进一步优化答案！</p>
<h2 id="XML-配置文件"><a href="#XML-配置文件" class="headerlink" title="XML 配置文件"></a>XML 配置文件</h2><h3 id=""><a href="#" class="headerlink" title="&lt;hibernate-mapping&gt;"></a><code>&lt;hibernate-mapping&gt;</code></h3><p>这是 Hibernate XML 映射文件的根标签，用于标识一个映射文档的开始和结束，它可以包含多个 <code>&lt;class&gt;</code> 标签。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!-- 其他标签 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="-1"><a href="#-1" class="headerlink" title="&lt;class&gt;"></a><code>&lt;class&gt;</code></h3><p><code>&lt;class&gt;</code> 标签用于定义 Java 类和数据库表之间的映射关系。</p>
<ul>
<li><p><code>name</code> 属性：指定 Java 类的全限定名。</p>
</li>
<li><p><code>table</code> 属性：指定对应的数据库表名。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">&quot;com.example.User&quot;</span> <span class="attr">table</span>=<span class="string">&quot;users&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 其他标签 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="-2"><a href="#-2" class="headerlink" title="&lt;id&gt;"></a><code>&lt;id&gt;</code></h3><p>  <code>&lt;id&gt;</code> 标签用于映射 Java 类中的主键属性到数据库表的主键列。</p>
<ul>
<li><p><code>name</code> 属性：指定 Java 类中的主键属性名。</p>
</li>
<li><p><code>column</code> 属性：指定数据库表中的主键列名。</p>
</li>
<li><p><code>type</code> 属性：指定属性的数据类型。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;user_id&quot;</span> <span class="attr">type</span>=<span class="string">&quot;long&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 主键生成策略 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">&quot;native&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="-3"><a href="#-3" class="headerlink" title="&lt;generator&gt;"></a><code>&lt;generator&gt;</code></h3><p><code>&lt;generator&gt;</code> 标签用于指定主键的生成策略，通常嵌套在 <code>&lt;id&gt;</code> 标签内。常见的生成策略有：</p>
<ul>
<li><p><code>native</code>：根据数据库的支持自动选择合适的主键生成策略（如自增、序列等）。</p>
</li>
<li><p><code>increment</code>：由 Hibernate 自动生成一个递增的主键值。</p>
</li>
<li><p><code>uuid</code>：生成一个 UUID 作为主键值。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">&quot;native&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="-4"><a href="#-4" class="headerlink" title="&lt;property&gt;"></a><code>&lt;property&gt;</code></h3><p><code>&lt;property&gt;</code> 标签用于映射 Java 类中的普通属性到数据库表的列。</p>
<ul>
<li><p><code>name</code> 属性：指定 Java 类中的属性名。</p>
</li>
<li><p><code>column</code> 属性：指定数据库表中的列名。</p>
</li>
<li><p><code>type</code> 属性：指定属性的数据类型。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">column</span>=<span class="string">&quot;user_name&quot;</span> <span class="attr">type</span>=<span class="string">&quot;string&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="-5"><a href="#-5" class="headerlink" title="&lt;many-to-one&gt;"></a><code>&lt;many-to-one&gt;</code></h3><p><code>&lt;many-to-one&gt;</code> 标签用于映射多对一的关联关系，例如多个用户属于一个部门。</p>
<ul>
<li><p><code>name</code> 属性：指定 Java 类中关联对象的属性名。</p>
</li>
<li><p><code>column</code> 属性：指定数据库表中用于关联的外键列名。</p>
</li>
<li><p><code>class</code> 属性：指定关联对象的 Java 类全限定名。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">many-to-one</span> <span class="attr">name</span>=<span class="string">&quot;department&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dept_id&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.example.Department&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="-6"><a href="#-6" class="headerlink" title="&lt;one-to-many&gt;"></a><code>&lt;one-to-many&gt;</code></h3><p><code>&lt;one-to-many&gt;</code> 标签用于映射一对多的关联关系，例如一个部门有多个用户。</p>
<ul>
<li><p><code>name</code> 属性：指定 Java 类中关联对象集合的属性名。</p>
</li>
<li><p><code>class</code> 属性：指定关联对象的 Java 类全限定名。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">name</span>=<span class="string">&quot;users&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.example.User&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="-7"><a href="#-7" class="headerlink" title="&lt;set&gt;"></a><code>&lt;set&gt;</code></h3><p><code>&lt;set&gt;</code> 标签用于映射 Java 类中的集合属性，通常与 <code>&lt;one-to-many&gt;</code> 或 <code>&lt;many-to-many&gt;</code> 关联使用。</p>
<ul>
<li><p><code>name</code> 属性：指定 Java 类中的集合属性名。</p>
</li>
<li><p><code>table</code> 属性：指定关联表名（在多对多关系中使用）。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">&quot;users&quot;</span> <span class="attr">table</span>=<span class="string">&quot;user_department&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">&quot;dept_id&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">&quot;com.example.User&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="-8"><a href="#-8" class="headerlink" title="&lt;Bag&gt;"></a><code>&lt;Bag&gt;</code></h3><p>在 Hibernate XML 映射文件里，<code>&lt;bag&gt;</code>标签用于映射 Java 类中的集合属性，它表示无序且可重复的集合，类似于 Java 里的<code>java.util.Collection</code>。下面为你详细介绍其用法和相关属性：</p>
<h4 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h4><p><code>&lt;bag&gt;</code>标签常被用于映射一对多或者多对多的关联关系。它一般和<code>&lt;key&gt;</code>、<code>&lt;one-to-many&gt;</code>或者<code>&lt;many-to-many&gt;</code>标签搭配使用。以下是个简单示例：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">&quot;com.example.Department&quot;</span> <span class="attr">table</span>=<span class="string">&quot;departments&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dept_id&quot;</span> <span class="attr">type</span>=<span class="string">&quot;long&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">&quot;native&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dept_name&quot;</span> <span class="attr">type</span>=<span class="string">&quot;string&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bag</span> <span class="attr">name</span>=<span class="string">&quot;employees&quot;</span> <span class="attr">table</span>=<span class="string">&quot;dept_emp&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">&quot;dept_id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">&quot;com.example.Employee&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bag</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在这个例子中，<code>Department</code>类有一个<code>employees</code>属性，它是一个无序且可重复的<code>Employee</code>对象集合。<code>&lt;bag&gt;</code>标签定义了这个集合属性的映射，<code>&lt;key&gt;</code>标签指明了关联表中的外键列，<code>&lt;one-to-many&gt;</code>标签表明了一对多的关联关系。</p>
<h4 id="常用属性"><a href="#常用属性" class="headerlink" title="常用属性"></a>常用属性</h4><ul>
<li><p><strong><code>name</code></strong>：指定 Java 类中的集合属性名，就像上面例子中的<code>employees</code>。</p>
</li>
<li><p><strong><code>table</code></strong>：指定关联表名，在一对多或者多对多关系里使用。比如在多对多关系中，需要一个中间表来存储关联信息，<code>table</code>属性就指定了这个中间表的名称。</p>
</li>
<li><p><strong><code>cascade</code></strong>：定义级联操作，它确定了在对父对象执行某些操作（如保存、更新、删除）时，是否要对关联对象也执行相同操作。常见的值有<code>save-update</code>、<code>delete</code>、<code>all</code>等。示例如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bag</span> <span class="attr">name</span>=<span class="string">&quot;employees&quot;</span> <span class="attr">table</span>=<span class="string">&quot;dept_emp&quot;</span> <span class="attr">cascade</span>=<span class="string">&quot;save-update&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">&quot;dept_id&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">&quot;com.example.Employee&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bag</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p><strong><code>inverse</code></strong>：是一个布尔值，用来指定关联关系的控制权在哪一方。若设为<code>true</code>，则表示关联关系的维护由另一方负责；若设为<code>false</code>（默认值），则当前对象负责维护关联关系。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bag</span> <span class="attr">name</span>=<span class="string">&quot;employees&quot;</span> <span class="attr">table</span>=<span class="string">&quot;dept_emp&quot;</span> <span class="attr">inverse</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">&quot;dept_id&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">&quot;com.example.Employee&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bag</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p>与<code>&lt;set&gt;</code>标签对比</p>
<p>和<code>&lt;set&gt;</code>标签不同，<code>&lt;bag&gt;</code>允许集合中有重复元素，而<code>&lt;set&gt;</code>要求元素唯一。所以，当你需要一个可包含重复元素的集合时，就可以使用<code>&lt;bag&gt;</code>标签。 </p>
<h3 id="-9"><a href="#-9" class="headerlink" title="&lt;discriminator&gt;"></a><code>&lt;discriminator&gt;</code></h3><p>在 Hibernate 的 XML 配置文件里，<code>&lt;discriminator&gt;</code>标签主要用于实现继承映射。当 Java 类存在继承关系时，该标签能够把这些具有继承关系的类映射到数据库的同一张表中，借助一个特定的列来区分不同的子类。下面为你详细介绍其使用方式和相关属性。</p>
<h4 id="基本使用场景"><a href="#基本使用场景" class="headerlink" title="基本使用场景"></a>基本使用场景</h4><p>在实际开发中，可能会有多个子类继承自同一个父类的情况。若把这些子类分别映射到不同的数据库表，会使数据库结构变得复杂。通过<code>&lt;discriminator&gt;</code>标签，可将所有子类的数据存储在同一张表中，再用一个特殊的列来辨别不同的子类。</p>
<h4 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">&quot;com.example.Animal&quot;</span> <span class="attr">table</span>=<span class="string">&quot;animals&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;animal_id&quot;</span> <span class="attr">type</span>=<span class="string">&quot;long&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">&quot;native&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">discriminator</span> <span class="attr">column</span>=<span class="string">&quot;animal_type&quot;</span> <span class="attr">type</span>=<span class="string">&quot;string&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">subclass</span> <span class="attr">name</span>=<span class="string">&quot;com.example.Dog&quot;</span> <span class="attr">discriminator-value</span>=<span class="string">&quot;dog&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Dog 类特有的属性映射 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">subclass</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">subclass</span> <span class="attr">name</span>=<span class="string">&quot;com.example.Cat&quot;</span> <span class="attr">discriminator-value</span>=<span class="string">&quot;cat&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Cat 类特有的属性映射 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">subclass</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在上述示例中：</p>
<ul>
<li><code>Animal</code>是父类，<code>Dog</code>和<code>Cat</code>是它的子类。</li>
<li><code>&lt;discriminator&gt;</code>标签指定了一个名为<code>animal_type</code>的列，数据类型为字符串，用于区分不同的子类。</li>
<li><code>&lt;subclass&gt;</code>标签定义了子类的映射，<code>discriminator-value</code>属性指定了该子类在<code>animal_type</code>列中对应的值。</li>
</ul>
<h4 id="常用属性-1"><a href="#常用属性-1" class="headerlink" title="常用属性"></a>常用属性</h4><ul>
<li><strong><code>column</code></strong>：指定数据库表中用于区分不同子类的列名。在上面的例子中，<code>column=&quot;animal_type&quot;</code>表示使用<code>animal_type</code>列来存储子类的区分信息。</li>
<li><strong><code>type</code></strong>：指定区分列的数据类型，例如<code>string</code>、<code>integer</code>等。</li>
</ul>
<h4 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h4><p>当 Hibernate 从数据库中查询数据时，会依据<code>&lt;discriminator&gt;</code>标签指定的列的值来判断应该将数据实例化为哪个子类的对象。比如，若<code>animal_type</code>列的值为<code>dog</code>，Hibernate 就会把数据实例化为<code>Dog</code>类的对象；若值为<code>cat</code>，则实例化为<code>Cat</code>类的对象。</p>
<h4 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h4><ul>
<li><strong>简化数据库结构</strong>：避免为每个子类创建单独的表，减少了数据库表的数量，使数据库结构更加简洁。</li>
<li><strong>提高数据查询效率</strong>：因为所有子类的数据都存储在同一张表中，查询时无需进行复杂的表连接操作，提高了查询效率。</li>
</ul>
<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><ul>
<li><strong>区分列的唯一性</strong>：<code>discriminator-value</code>属性的值必须唯一，否则会导致 Hibernate 在实例化对象时出现混淆。</li>
<li><strong>数据一致性</strong>：在插入数据时，要确保区分列的值与<code>&lt;subclass&gt;</code>标签中<code>discriminator-value</code>属性的值一致，以保证数据的一致性。</li>
</ul>
<h3 id="-10"><a href="#-10" class="headerlink" title="&lt;key&gt;"></a><code>&lt;key&gt;</code></h3><p><code>&lt;key&gt;</code> 标签用于指定关联表中的外键列，通常在 <code>&lt;set&gt;</code> 或 <code>&lt;list&gt;</code> 标签中使用。</p>
<ul>
<li><p><code>column</code> 属性：指定外键列名。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">&quot;dept_id&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p>这些标签是 Hibernate XML 映射文件中最常用的部分，通过合理使用它们，可以实现 Java 类和数据库表之间的灵活映射。</p>
<h2 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h2><p>Hibernate 是一个流行的 Java 持久层框架，它允许你通过对象关系映射（ORM）的方式来操作数据库。以下是 Hibernate 中一些常用的注解：</p>
<ol>
<li><p><strong>@Entity</strong>：用于标注实体类，表示该类对应数据库中的一张表。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>@Table</strong>：与 <code>@Entity</code> 一起使用，指定实体类所对应的数据库表名。如果不指定，默认使用类名作为表名。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;users&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>@Id</strong>：标记属性为主键。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Id</span></span><br><span class="line"><span class="keyword">private</span> Long id;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>@GeneratedValue</strong>：定义主键的生成策略。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line"><span class="keyword">private</span> Long id;</span><br></pre></td></tr></table></figure>
<p>常见的生成策略有 <code>AUTO</code>, <code>IDENTITY</code>, <code>SEQUENCE</code>, 和 <code>TABLE</code>。</p>
</li>
<li><p><strong>@Column</strong>：用于描述实体类中的字段如何映射到数据库表中的列。可以指定列名、是否允许为空等属性。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Column(name = &quot;user_name&quot;, nullable = false, length = 30)</span></span><br><span class="line"><span class="keyword">private</span> String name;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>@Transient</strong>：表示某个属性不会被持久化到数据库中。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transient</span></span><br><span class="line"><span class="keyword">private</span> String tempValue;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>@ManyToOne</strong>, <strong>@OneToMany</strong>, <strong>@OneToOne</strong>, <strong>@ManyToMany</strong>：用于定义实体之间的关系。例如，<code>@ManyToOne</code> 表示多对一的关系。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ManyToOne</span></span><br><span class="line"><span class="meta">@JoinColumn(name = &quot;department_id&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Department department;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>@JoinColumn</strong>：用于指定连接列（外键），通常在定义关联关系时使用。</p>
</li>
<li><p><strong>@Embedded</strong>, <strong>@Embeddable</strong>：用于组合模式，<code>@Embeddable</code> 标记的类可以在其他实体中嵌入使用，而 <code>@Embedded</code> 用来嵌入这些可嵌入的对象。</p>
</li>
<li><p><strong>@Formula</strong>：用于定义基于SQL公式或子查询的虚拟属性。</p>
</li>
</ol>
<p>以上仅是部分常用的 Hibernate 注解，根据实际需要可能还会涉及到更多高级特性和注解。使用这些注解可以大大简化Java应用程序与数据库交互的代码。</p>
<h2 id="Session-和-SessionFactory"><a href="#Session-和-SessionFactory" class="headerlink" title="Session 和 SessionFactory"></a>Session 和 SessionFactory</h2><p>在 Hibernate 中，<code>Session</code> 和 <code>SessionFactory</code> 是核心组件，负责管理与数据库的交互以及对象持久化。它们与 Hibernate 的缓存机制密切相关，共同影响应用的性能和数据一致性。下面详细解释 <code>Session</code>、<code>SessionFactory</code>、缓存机制及其相关性。</p>
<hr>
<h3 id="1-Session"><a href="#1-Session" class="headerlink" title="1. Session"></a><strong>1. Session</strong></h3><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a><strong>定义</strong></h4><p><code>Session</code> 是 Hibernate 的核心接口（<code>org.hibernate.Session</code>），用于执行数据库操作（如增删改查），是应用程序与数据库交互的主要入口。它封装了 JDBC 连接，管理实体对象的生命周期，并维护一个<strong>一级缓存</strong>（Persistence Context）。</p>
<h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a><strong>特点</strong></h4><ul>
<li><strong>非线程安全</strong>：<code>Session</code> 设计为单线程使用，不应在多个线程间共享。每个线程或请求通常需要独立的 <code>Session</code>。</li>
<li><strong>短生命周期</strong>：<code>Session</code> 通常在一次数据库操作或事务中创建，用完后关闭，避免资源泄漏。</li>
<li><strong>一级缓存</strong>：<code>Session</code> 内部维护一个缓存，存储当前会话中的实体对象，减少数据库访问。</li>
<li><strong>代理 JDBC 连接</strong>：<code>Session</code> 通过底层的 JDBC 连接与数据库通信，但开发者无需直接操作 JDBC。</li>
</ul>
<h4 id="主要功能"><a href="#主要功能" class="headerlink" title="主要功能"></a><strong>主要功能</strong></h4><ul>
<li><strong>CRUD 操作</strong>：保存（<code>save</code>）、更新（<code>update</code>）、删除（<code>delete</code>）、查询（<code>get</code>、<code>load</code>）。</li>
<li><strong>查询执行</strong>：支持 HQL（<code>createQuery</code>）、Criteria API、原生 SQL。</li>
<li><strong>事务管理</strong>：通过 <code>beginTransaction</code> 开启事务，管理数据库操作。</li>
<li><strong>缓存管理</strong>：维护一级缓存，自动处理脏检查（Dirty Checking）。</li>
</ul>
<h4 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a><strong>常用方法</strong></h4><ul>
<li><code>save(Object)</code>：保存实体，返回标识符。</li>
<li><code>update(Object)</code>：更新实体。</li>
<li><code>merge(Object)</code>：合并 detached 状态的实体。</li>
<li><code>delete(Object)</code>：删除实体。</li>
<li><code>get(Class, Serializable)</code>：根据 ID 立即加载实体。</li>
<li><code>load(Class, Serializable)</code>：延迟加载实体。</li>
<li><code>createQuery(String)</code>：创建 HQL 查询。</li>
<li><code>flush()</code>：同步持久化上下文到数据库。</li>
<li><code>clear()</code>：清空一级缓存。</li>
<li><code>beginTransaction()</code>：开启事务。</li>
</ul>
<h4 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a><strong>生命周期</strong></h4><ol>
<li>创建：通过 <code>SessionFactory.openSession()</code> 或 <code>SessionFactory.getCurrentSession()</code> 获取。</li>
<li>使用：执行数据库操作，管理实体。</li>
<li>关闭：调用 <code>close()</code> 释放资源（Spring 可自动管理）。</li>
</ol>
<hr>
<h3 id="2-SessionFactory"><a href="#2-SessionFactory" class="headerlink" title="2. SessionFactory"></a><strong>2. SessionFactory</strong></h3><h4 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a><strong>定义</strong></h4><p><code>SessionFactory</code> 是 Hibernate 的工厂接口（<code>org.hibernate.SessionFactory</code>），负责创建 <code>Session</code> 实例。它是一个<strong>线程安全</strong>的全局对象，初始化时加载 Hibernate 配置和映射元数据。</p>
<h4 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a><strong>特点</strong></h4><ul>
<li><strong>线程安全</strong>：<code>SessionFactory</code> 可以在多个线程间共享，通常在应用启动时创建单一实例。</li>
<li><strong>重量级对象</strong>：创建 <code>SessionFactory</code> 开销大，因为它需要解析配置文件、映射元数据并建立数据库连接池。</li>
<li><strong>全局单例</strong>：整个应用通常只有一个 <code>SessionFactory</code>，除非使用多个数据库。</li>
<li><strong>配置中心</strong>：存储 Hibernate 配置（如数据库连接、方言、缓存设置）和实体映射信息。</li>
</ul>
<h4 id="主要功能-1"><a href="#主要功能-1" class="headerlink" title="主要功能"></a><strong>主要功能</strong></h4><ul>
<li>创建 <code>Session</code> 实例。</li>
<li>管理 Hibernate 配置和元数据。</li>
<li>提供对二级缓存（如果启用）的访问。</li>
</ul>
<h4 id="常用方法-1"><a href="#常用方法-1" class="headerlink" title="常用方法"></a><strong>常用方法</strong></h4><ul>
<li><code>openSession()</code>：创建新的 <code>Session</code>，需手动关闭。</li>
<li><code>getCurrentSession()</code>：获取当前线程绑定的 <code>Session</code>（需配置事务上下文，Spring 常用）。</li>
<li><code>close()</code>：关闭工厂，释放资源（通常在应用关闭时调用）。</li>
</ul>
<h4 id="生命周期-1"><a href="#生命周期-1" class="headerlink" title="生命周期"></a><strong>生命周期</strong></h4><ol>
<li>初始化：应用启动时，通过 <code>Configuration</code> 或 Spring 配置创建 <code>SessionFactory</code>。</li>
<li>使用：提供 <code>Session</code> 实例，服务整个应用。</li>
<li>销毁：应用关闭时调用 <code>close()</code> 释放资源。</li>
</ol>
<hr>
<h3 id="3-Hibernate-缓存机制"><a href="#3-Hibernate-缓存机制" class="headerlink" title="3. Hibernate 缓存机制"></a><strong>3. Hibernate 缓存机制</strong></h3><p>Hibernate 提供两级缓存机制，用于减少数据库访问，提高性能：<strong>一级缓存</strong>（与 <code>Session</code> 相关）和<strong>二级缓存</strong>（与 <code>SessionFactory</code> 相关）。</p>
<h4 id="一级缓存（First-Level-Cache）"><a href="#一级缓存（First-Level-Cache）" class="headerlink" title="一级缓存（First-Level Cache）"></a><strong>一级缓存（First-Level Cache）</strong></h4><ul>
<li><strong>定义</strong>：一级缓存是 <code>Session</code> 级别的缓存，自动启用，存储当前 <code>Session</code> 内的实体对象。也被称为<strong>持久化上下文</strong>（Persistence Context）。</li>
<li><strong>作用</strong>：<ul>
<li>缓存实体对象，避免重复查询数据库。</li>
<li>实现脏检查，自动检测实体变化并同步到数据库。</li>
<li>管理实体状态（Managed、Detached、Transient）。</li>
</ul>
</li>
<li><strong>生命周期</strong>：与 <code>Session</code> 绑定，<code>Session</code> 关闭或调用 <code>clear()</code> 时缓存清空。</li>
<li><strong>特点</strong>：<ul>
<li>强制启用，无法禁用。</li>
<li>仅在同一 <code>Session</code> 内有效，不跨 <code>Session</code> 共享。</li>
<li>缓存的是实体对象的完整状态（包括关联对象）。</li>
</ul>
</li>
<li><strong>工作原理</strong>：<ul>
<li>当通过 <code>get()</code>、<code>load()</code> 或查询加载实体时，Hibernate 将实体放入一级缓存。</li>
<li>同一 <code>Session</code> 内重复查询相同实体时，直接从缓存返回，避免数据库访问。</li>
<li>在事务提交或 <code>flush()</code> 时，Hibernate 对比缓存中的实体与数据库状态，执行必要的 SQL 更新（脏检查）。</li>
</ul>
</li>
</ul>
<h4 id="二级缓存（Second-Level-Cache）"><a href="#二级缓存（Second-Level-Cache）" class="headerlink" title="二级缓存（Second-Level Cache）"></a><strong>二级缓存（Second-Level Cache）</strong></h4><ul>
<li><strong>定义</strong>：二级缓存是 <code>SessionFactory</code> 级别的缓存，可选启用，存储跨 <code>Session</code> 的实体数据或查询结果。</li>
<li><strong>作用</strong>：<ul>
<li>提高跨 <code>Session</code> 的查询性能，减少数据库访问。</li>
<li>适合频繁读取、不常修改的数据（如配置表、字典表）。</li>
</ul>
</li>
<li><strong>生命周期</strong>：与 <code>SessionFactory</code> 绑定，应用运行期间持续存在。</li>
<li><strong>特点</strong>：<ul>
<li>默认禁用，需显式配置（如 EHCache、Redis）。</li>
<li>可缓存实体、查询结果或集合。</li>
<li>跨 <code>Session</code> 和线程共享，需考虑并发一致性。</li>
</ul>
</li>
<li><strong>配置</strong>：<ul>
<li>启用二级缓存：设置 <code>hibernate.cache.use_second_level_cache=true</code>。</li>
<li>指定缓存提供者（如 <code>org.hibernate.cache.ehcache.EhCacheRegionFactory</code>）。</li>
<li>在实体上使用 <code>@Cache</code> 注解：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Cache(usage = CacheConcurrencyStrategy.READ_WRITE)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h4 id="查询缓存（Query-Cache）"><a href="#查询缓存（Query-Cache）" class="headerlink" title="查询缓存（Query Cache）"></a><strong>查询缓存（Query Cache）</strong></h4><ul>
<li><strong>定义</strong>：查询缓存是二级缓存的子集，用于缓存 HQL&#x2F;JPQL 查询的结果（仅缓存实体 ID 和简单数据）。</li>
<li><strong>作用</strong>：避免重复执行相同的查询。</li>
<li><strong>启用方式</strong>：<ul>
<li>设置 <code>hibernate.cache.use_query_cache=true</code>。</li>
<li>在查询时调用 <code>setCacheable(true)</code>：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Query</span> <span class="variable">query</span> <span class="operator">=</span> session.createQuery(<span class="string">&quot;from User where name = :name&quot;</span>);</span><br><span class="line">query.setParameter(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;Alice&quot;</span>);</span><br><span class="line">query.setCacheable(<span class="literal">true</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><strong>注意</strong>：查询缓存通常与二级缓存一起使用，因为查询结果的实体仍需从二级缓存加载。</li>
</ul>
<hr>
<h3 id="4-Session、SessionFactory-和缓存机制的相关性"><a href="#4-Session、SessionFactory-和缓存机制的相关性" class="headerlink" title="4. Session、SessionFactory 和缓存机制的相关性"></a><strong>4. Session、SessionFactory 和缓存机制的相关性</strong></h3><p><code>Session</code>、<code>SessionFactory</code> 和缓存机制在 Hibernate 中紧密协作，共同管理数据访问和性能优化。以下是它们之间的关系：</p>
<h4 id="Session-和-SessionFactory-1"><a href="#Session-和-SessionFactory-1" class="headerlink" title="Session 和 SessionFactory"></a><strong>Session 和 SessionFactory</strong></h4><ul>
<li><strong>创建关系</strong>：<code>SessionFactory</code> 是工厂，负责创建 <code>Session</code> 实例。每个 <code>Session</code> 都与 <code>SessionFactory</code> 关联，共享其配置（如数据库连接、方言）。</li>
<li><strong>配置共享</strong>：<code>SessionFactory</code> 持有 Hibernate 的全局配置（包括映射元数据、缓存设置），<code>Session</code> 使用这些配置执行具体操作。</li>
<li><strong>生命周期差异</strong>：<ul>
<li><code>SessionFactory</code> 是应用级别的单例，生命周期长。</li>
<li><code>Session</code> 是请求或事务级别的，生命周期短，创建和销毁频繁。</li>
</ul>
</li>
<li><strong>Spring 集成</strong>：在 Spring 中，<code>SessionFactory</code> 由容器管理，<code>Session</code> 通过 <code>getCurrentSession()</code> 或 Spring 的 <code>@Transactional</code> 自动管理。</li>
</ul>
<h4 id="Session-和一级缓存"><a href="#Session-和一级缓存" class="headerlink" title="Session 和一级缓存"></a><strong>Session 和一级缓存</strong></h4><ul>
<li><strong>直接关联</strong>：一级缓存是 <code>Session</code> 的内置功能，存储在 <code>Session</code> 的持久化上下文中。</li>
<li><strong>缓存作用</strong>：<ul>
<li>同一 <code>Session</code> 内，重复查询相同实体（如 <code>get(User.class, id)</code>）直接从一级缓存返回。</li>
<li>脏检查依赖一级缓存，Hibernate 在 <code>flush()</code> 或事务提交时对比缓存中的实体状态。</li>
</ul>
</li>
<li><strong>管理方式</strong>：<ul>
<li>调用 <code>Session.clear()</code> 清空一级缓存。</li>
<li>调用 <code>Session.evict(Object)</code> 移除特定实体。</li>
<li><code>Session</code> 关闭时，一级缓存自动失效。</li>
</ul>
</li>
<li><strong>示例</strong>：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line"><span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line"><span class="type">User</span> <span class="variable">user1</span> <span class="operator">=</span> session.get(User.class, <span class="number">1L</span>); <span class="comment">// 查询数据库，放入一级缓存</span></span><br><span class="line"><span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> session.get(User.class, <span class="number">1L</span>); <span class="comment">// 直接从一级缓存返回</span></span><br><span class="line">tx.commit();</span><br><span class="line">session.close(); <span class="comment">// 一级缓存失效</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="SessionFactory-和二级缓存"><a href="#SessionFactory-和二级缓存" class="headerlink" title="SessionFactory 和二级缓存"></a><strong>SessionFactory 和二级缓存</strong></h4><ul>
<li><strong>管理关系</strong>：二级缓存由 <code>SessionFactory</code> 管理，跨 <code>Session</code> 共享。<code>SessionFactory</code> 负责初始化缓存提供者（如 EHCache）并维护缓存区域。</li>
<li><strong>缓存访问</strong>：<ul>
<li>当 <code>Session</code> 查询实体时，Hibernate 先检查一级缓存，若未命中，再检查二级缓存（若启用）。</li>
<li>如果二级缓存命中，Hibernate 从缓存加载实体，减少数据库访问。</li>
</ul>
</li>
<li><strong>配置依赖</strong>：二级缓存的配置（如缓存策略、提供者）在 <code>SessionFactory</code> 初始化时设置，影响所有 <code>Session</code>。</li>
<li><strong>示例</strong>：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Session</span> <span class="variable">session1</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> session1.get(User.class, <span class="number">1L</span>); <span class="comment">// 查询数据库，放入二级缓存</span></span><br><span class="line">session1.close();</span><br><span class="line"></span><br><span class="line"><span class="type">Session</span> <span class="variable">session2</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line"><span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> session2.get(User.class, <span class="number">1L</span>); <span class="comment">// 从二级缓存加载</span></span><br><span class="line">session2.close();</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Session、SessionFactory-和查询缓存"><a href="#Session、SessionFactory-和查询缓存" class="headerlink" title="Session、SessionFactory 和查询缓存"></a><strong>Session、SessionFactory 和查询缓存</strong></h4><ul>
<li><strong>协作机制</strong>：<ul>
<li>查询缓存存储查询结果的元数据（如实体 ID），由 <code>SessionFactory</code> 管理。</li>
<li>实际实体数据仍需从二级缓存或数据库加载。</li>
<li><code>Session</code> 通过 <code>setCacheable(true)</code> 启用查询缓存，查询结果与 <code>SessionFactory</code> 的缓存区域关联。</li>
</ul>
</li>
<li><strong>依赖关系</strong>：查询缓存依赖二级缓存，必须同时启用二级缓存才能生效。</li>
</ul>
<h4 id="整体工作流程"><a href="#整体工作流程" class="headerlink" title="整体工作流程"></a><strong>整体工作流程</strong></h4><ol>
<li><strong>初始化</strong>：<code>SessionFactory</code> 在应用启动时创建，加载配置、映射和缓存设置（包括二级缓存）。</li>
<li><strong>创建 Session</strong>：应用通过 <code>SessionFactory</code> 创建 <code>Session</code>，每个 <code>Session</code> 维护独立的一级缓存。</li>
<li><strong>查询操作</strong>：<ul>
<li><code>Session</code> 首先检查一级缓存。</li>
<li>如果一级缓存未命中，检查二级缓存（若启用）。</li>
<li>如果二级缓存未命中，查询数据库，并将结果存入一级缓存和二级缓存（若启用）。</li>
</ul>
</li>
<li><strong>事务提交</strong>：<ul>
<li><code>Session</code> 执行脏检查，同步一级缓存中的变化到数据库。</li>
<li>二级缓存根据策略（如 <code>READ_WRITE</code>）更新。</li>
</ul>
</li>
<li><strong>关闭</strong>：<code>Session</code> 关闭，一级缓存失效；<code>SessionFactory</code> 和二级缓存保持有效，直到应用关闭。</li>
</ol>
<hr>
<h3 id="5-实践中的注意事项"><a href="#5-实践中的注意事项" class="headerlink" title="5. 实践中的注意事项"></a><strong>5. 实践中的注意事项</strong></h3><ol>
<li><p><strong>Session 管理</strong>：</p>
<ul>
<li>避免长时间持有 <code>Session</code>，防止内存泄漏。</li>
<li>在 Spring 中，使用 <code>@Transactional</code> 自动管理 <code>Session</code>（通过 <code>getCurrentSession()</code>）。</li>
<li>总是关闭 <code>Session</code>（<code>close()</code>），或依赖 Spring 管理。</li>
</ul>
</li>
<li><p><strong>SessionFactory 配置</strong>：</p>
<ul>
<li>确保 <code>SessionFactory</code> 单例，避免重复创建。</li>
<li>合理配置数据库连接池（如 HikariCP）和 Hibernate 属性（如 <code>hibernate.dialect</code>）。</li>
</ul>
</li>
<li><p><strong>缓存优化</strong>：</p>
<ul>
<li><strong>一级缓存</strong>：避免在单一 <code>Session</code> 内加载过多实体，防止内存溢出。</li>
<li><strong>二级缓存</strong>：仅缓存不常修改的数据，配置合适的并发策略（如 <code>READ_ONLY</code> 或 <code>READ_WRITE</code>）。</li>
<li><strong>查询缓存</strong>：谨慎使用，适合高频、参数固定的查询。</li>
</ul>
</li>
<li><p><strong>性能调试</strong>：</p>
<ul>
<li>开启 <code>hibernate.show_sql</code> 和 <code>hibernate.format_sql</code> 查看生成的 SQL。</li>
<li>使用 <code>statistics</code> 检查缓存命中率：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sessionFactory.getStatistics().setStatisticsEnabled(<span class="literal">true</span>);</span><br><span class="line">System.out.println(sessionFactory.getStatistics().getSecondLevelCacheHitCount());</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>常见问题</strong>：</p>
<ul>
<li><strong>LazyInitializationException</strong>：因 <code>Session</code> 关闭后访问延迟加载的关联对象，解决方法是提前加载或使用 Spring 的 <code>OpenSessionInView</code>。</li>
<li><strong>N+1 查询问题</strong>：因一级缓存未命中或关联对象逐个加载，解决方法是使用 <code>JOIN FETCH</code> 或批量加载。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="6-示例代码：展示-Session、SessionFactory-和缓存"><a href="#6-示例代码：展示-Session、SessionFactory-和缓存" class="headerlink" title="6. 示例代码：展示 Session、SessionFactory 和缓存"></a><strong>6. 示例代码：展示 Session、SessionFactory 和缓存</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置 SessionFactory</span></span><br><span class="line"><span class="type">Configuration</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configure();</span><br><span class="line">config.addAnnotatedClass(User.class);</span><br><span class="line"><span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> config.buildSessionFactory();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 Session 和一级缓存</span></span><br><span class="line"><span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line"><span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> session.beginTransaction();</span><br><span class="line"></span><br><span class="line"><span class="type">User</span> <span class="variable">user1</span> <span class="operator">=</span> session.get(User.class, <span class="number">1L</span>); <span class="comment">// 查询数据库，放入一级缓存</span></span><br><span class="line"><span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> session.get(User.class, <span class="number">1L</span>); <span class="comment">// 从一级缓存返回</span></span><br><span class="line">System.out.println(user1 == user2); <span class="comment">// true，同一对象</span></span><br><span class="line"></span><br><span class="line">tx.commit();</span><br><span class="line">session.close(); <span class="comment">// 一级缓存失效</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 二级缓存示例（需配置 EHCache 和 @Cache）</span></span><br><span class="line"><span class="type">Session</span> <span class="variable">session2</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line"><span class="type">Transaction</span> <span class="variable">tx2</span> <span class="operator">=</span> session2.beginTransaction();</span><br><span class="line"></span><br><span class="line"><span class="type">User</span> <span class="variable">user3</span> <span class="operator">=</span> session2.get(User.class, <span class="number">1L</span>); <span class="comment">// 从二级缓存加载（若命中）</span></span><br><span class="line">tx2.commit();</span><br><span class="line">session2.close();</span><br><span class="line"></span><br><span class="line">sessionFactory.close(); <span class="comment">// 关闭 SessionFactory，二级缓存失效</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="7-总结"><a href="#7-总结" class="headerlink" title="7. 总结"></a><strong>7. 总结</strong></h3><ul>
<li><strong>Session</strong>：<ul>
<li>作用：管理数据库操作和一级缓存，非线程安全，短生命周期。</li>
<li>核心方法：<code>save</code>、<code>get</code>、<code>createQuery</code>、<code>flush</code>。</li>
</ul>
</li>
<li><strong>SessionFactory</strong>：<ul>
<li>作用：创建 <code>Session</code>，管理全局配置和二级缓存，线程安全，单例。</li>
<li>核心方法：<code>openSession</code>、<code>getCurrentSession</code>。</li>
</ul>
</li>
<li><strong>缓存机制</strong>：<ul>
<li><strong>一级缓存</strong>：<code>Session</code> 级别，自动启用，存储当前会话实体，负责脏检查。</li>
<li><strong>二级缓存</strong>：<code>SessionFactory</code> 级别，可选启用，跨 <code>Session</code> 共享，适合只读数据。</li>
<li><strong>查询缓存</strong>：缓存查询结果，依赖二级缓存。</li>
</ul>
</li>
<li><strong>相关性</strong>：<ul>
<li><code>SessionFactory</code> 创建 <code>Session</code>，提供配置和二级缓存。</li>
<li><code>Session</code> 维护一级缓存，执行操作，可能访问二级缓存。</li>
<li>缓存机制通过减少数据库访问优化性能，与 <code>Session</code> 和 <code>SessionFactory</code> 的生命周期紧密相关。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="进一步学习建议"><a href="#进一步学习建议" class="headerlink" title="进一步学习建议"></a><strong>进一步学习建议</strong></h3><ol>
<li><strong>实践</strong>：搭建一个 Spring Boot + Hibernate 项目，测试一级缓存和二级缓存的效果。</li>
<li><strong>调试</strong>：使用 Hibernate 的 <code>Statistics</code> API 监控缓存命中率，优化查询。</li>
<li><strong>深入</strong>：学习关联映射（如 <code>@OneToMany</code>）和 <code>fetch</code> 策略，结合缓存优化性能。</li>
<li><strong>资源</strong>：参考 <a target="_blank" rel="noopener" href="https://docs.jboss.org/hibernate/orm/5.6/userguide/html_single/Hibernate_User_Guide.html#caching">Hibernate 官方文档</a> 的缓存章节。</li>
</ol>
<p>如果你有具体场景（如缓存配置、性能问题、代码调试），请提供细节，我可以进一步提供定制化指导！</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>要熟悉使用 Hibernate 作为 ORM 框架，建议从理解其核心概念开始，逐步通过实践掌握常用类、接口和方法。以下是一个系统化的学习路径，以及 Hibernate 中常用的类、接口和方法的详细说明，帮助你快速上手。</p>
<hr>
<h3 id="学习路径：如何入手-Hibernate"><a href="#学习路径：如何入手-Hibernate" class="headerlink" title="学习路径：如何入手 Hibernate"></a><strong>学习路径：如何入手 Hibernate</strong></h3><ol>
<li><p><strong>理解核心概念</strong></p>
<ul>
<li><strong>ORM 原理</strong>：了解对象-关系映射，Hibernate 如何将 Java 对象映射到数据库表。</li>
<li><strong>Session 和 SessionFactory</strong>：掌握 Hibernate 的核心工作单元。</li>
<li><strong>事务管理</strong>：理解事务在 Hibernate 中的作用。</li>
<li><strong>一级缓存和查询</strong>：学习 Hibernate 如何缓存对象和执行查询。</li>
</ul>
</li>
<li><p><strong>搭建开发环境</strong></p>
<ul>
<li><strong>依赖配置</strong>：使用 Maven 或 Gradle 引入 Hibernate 依赖（参考之前的回答）。</li>
<li><strong>数据库准备</strong>：选择一个数据库（如 MySQL、H2），创建表结构。</li>
<li><strong>Spring 集成</strong>：推荐结合 Spring（或 Spring Boot）简化配置，Spring Boot 的 <code>spring-boot-starter-data-jpa</code> 是快速入门的首选。</li>
</ul>
</li>
<li><p><strong>实践基础操作</strong></p>
<ul>
<li><strong>创建实体类</strong>：使用注解（如 <code>@Entity</code>、<code>@Id</code>）定义 Java 类与数据库表的映射。</li>
<li><strong>配置 Hibernate</strong>：设置 <code>hibernate.cfg.xml</code> 或 <code>application.properties</code>（Spring Boot）。</li>
<li><strong>实现 CRUD</strong>：通过 <code>Session</code> 或 JPA 的 <code>EntityManager</code> 实现增删改查。</li>
<li><strong>练习查询</strong>：使用 HQL（Hibernate Query Language）或 Criteria API 编写查询。</li>
</ul>
</li>
<li><p><strong>深入高级功能</strong></p>
<ul>
<li><strong>关联映射</strong>：学习 <code>@OneToMany</code>、<code>@ManyToOne</code> 等关联关系。</li>
<li><strong>延迟加载</strong>：理解 <code>fetch</code> 策略（如 <code>FetchType.LAZY</code>）。</li>
<li><strong>事务管理</strong>：结合 Spring 的 <code>@Transactional</code> 管理事务。</li>
<li><strong>性能优化</strong>：探索一级缓存、二级缓存、批量操作。</li>
</ul>
</li>
<li><p><strong>通过项目巩固</strong></p>
<ul>
<li>构建一个简单的应用（如用户管理系统），包含实体、DAO、服务层和控制器。</li>
<li>使用 Spring Boot + Hibernate 实现 REST API，涵盖 CRUD 和关联查询。</li>
<li>调试常见问题（如 <code>LazyInitializationException</code>、N+1 查询问题）。</li>
</ul>
</li>
<li><p><strong>查阅官方资源</strong></p>
<ul>
<li><strong>Hibernate 文档</strong>：参考 <a target="_blank" rel="noopener" href="https://hibernate.org/orm/documentation/">Hibernate 官方文档</a>。</li>
<li><strong>教程和社区</strong>：学习 Baeldung、Mkyong 等网站的 Hibernate 教程，参与 Stack Overflow 讨论。</li>
<li><strong>源码和示例</strong>：查看 Hibernate 的 GitHub 仓库或官方示例项目。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="常用类、接口和方法"><a href="#常用类、接口和方法" class="headerlink" title="常用类、接口和方法"></a><strong>常用类、接口和方法</strong></h3><p>以下是 Hibernate 中最常用的类、接口及其核心方法，分为 **Hibernate 核心（Session 模式）**和 <strong>JPA 模式</strong>（Spring Boot 常用）。</p>
<h4 id="1-Hibernate-核心（Session-模式）"><a href="#1-Hibernate-核心（Session-模式）" class="headerlink" title="1. Hibernate 核心（Session 模式）"></a><strong>1. Hibernate 核心（Session 模式）</strong></h4><p>这些类和接口用于传统的 Hibernate 操作，基于 <code>Session</code> 和 <code>SessionFactory</code>。</p>
<h5 id="常用类和接口"><a href="#常用类和接口" class="headerlink" title="常用类和接口"></a><strong>常用类和接口</strong></h5><ol>
<li><p><strong><code>org.hibernate.Session</code></strong></p>
<ul>
<li><strong>作用</strong>：核心接口，管理实体对象的持久化操作，维护一级缓存。</li>
<li><strong>非线程安全</strong>，每个线程应有独立的 <code>Session</code>。</li>
<li><strong>获取方式</strong>：通过 <code>SessionFactory.openSession()</code> 获取。</li>
</ul>
</li>
<li><p><strong><code>org.hibernate.SessionFactory</code></strong></p>
<ul>
<li><strong>作用</strong>：线程安全的工厂类，负责创建 <code>Session</code>，初始化 Hibernate 配置。</li>
<li><strong>特点</strong>：全局单例，创建开销大，应用启动时初始化。</li>
</ul>
</li>
<li><p><strong><code>org.hibernate.Transaction</code></strong></p>
<ul>
<li><strong>作用</strong>：管理数据库事务，确保操作的原子性。</li>
<li><strong>获取方式</strong>：通过 <code>Session.beginTransaction()</code> 获取。</li>
</ul>
</li>
<li><p><strong><code>org.hibernate.query.Query</code></strong></p>
<ul>
<li><strong>作用</strong>：执行 HQL 或 SQL 查询，返回结果集。</li>
<li><strong>获取方式</strong>：通过 <code>Session.createQuery()</code> 创建。</li>
</ul>
</li>
</ol>
<h5 id="常用方法-2"><a href="#常用方法-2" class="headerlink" title="常用方法"></a><strong>常用方法</strong></h5><ul>
<li><p><strong><code>Session</code> 方法</strong>：</p>
<ul>
<li><code>save(Object)</code>：保存实体，返回标识符。</li>
<li><code>update(Object)</code>：更新实体。</li>
<li><code>merge(Object)</code>：合并 detached 状态的实体。</li>
<li><code>delete(Object)</code>：删除实体。</li>
<li><code>get(Class, Serializable)</code>：根据 ID 立即加载实体。</li>
<li><code>load(Class, Serializable)</code>：延迟加载实体。</li>
<li><code>createQuery(String)</code>：创建 HQL 查询。</li>
<li><code>flush()</code>：同步持久化上下文到数据库。</li>
<li><code>clear()</code>：清空一级缓存。</li>
<li><code>beginTransaction()</code>：开启事务。</li>
</ul>
</li>
<li><p><strong><code>SessionFactory</code> 方法</strong>：</p>
<ul>
<li><code>openSession()</code>：创建新的 <code>Session</code>。</li>
<li><code>getCurrentSession()</code>：获取当前线程绑定的 <code>Session</code>（需配置事务上下文）。</li>
<li><code>close()</code>：关闭工厂，释放资源。</li>
</ul>
</li>
<li><p><strong><code>Transaction</code> 方法</strong>：</p>
<ul>
<li><code>commit()</code>：提交事务。</li>
<li><code>rollback()</code>：回滚事务。</li>
</ul>
</li>
<li><p><strong><code>Query</code> 方法</strong>：</p>
<ul>
<li><code>getResultList()</code>：返回查询结果列表。</li>
<li><code>getSingleResult()</code>：返回单个结果。</li>
<li><code>setParameter(String, Object)</code>：设置查询参数。</li>
<li><code>setMaxResults(int)</code>：限制结果数量。</li>
</ul>
</li>
</ul>
<h5 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a><strong>示例代码</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">SessionFactory</span> <span class="variable">sessionFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>().configure().buildSessionFactory();</span><br><span class="line"><span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> sessionFactory.openSession();</span><br><span class="line"><span class="type">Transaction</span> <span class="variable">tx</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    tx = session.beginTransaction();</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;Alice&quot;</span>);</span><br><span class="line">    session.save(user); <span class="comment">// 保存</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">loaded</span> <span class="operator">=</span> session.get(User.class, user.getId()); <span class="comment">// 查询</span></span><br><span class="line">    tx.commit();</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    <span class="keyword">if</span> (tx != <span class="literal">null</span>) tx.rollback();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-JPA-模式（EntityManager-模式）"><a href="#2-JPA-模式（EntityManager-模式）" class="headerlink" title="2. JPA 模式（EntityManager 模式）"></a><strong>2. JPA 模式（EntityManager 模式）</strong></h4><p>在 Spring Boot 或现代项目中，通常使用 Hibernate 作为 JPA 实现，基于 <code>EntityManager</code>。</p>
<h5 id="常用类和接口-1"><a href="#常用类和接口-1" class="headerlink" title="常用类和接口"></a><strong>常用类和接口</strong></h5><ol>
<li><p><strong><code>javax.persistence.EntityManager</code>（或 <code>jakarta.persistence</code>）</strong></p>
<ul>
<li><strong>作用</strong>：JPA 的核心接口，类似 <code>Session</code>，管理实体的持久化操作。</li>
<li><strong>获取方式</strong>：通过 Spring 注入或 <code>EntityManagerFactory</code> 创建。</li>
</ul>
</li>
<li><p><strong><code>javax.persistence.EntityManagerFactory</code></strong></p>
<ul>
<li><strong>作用</strong>：创建 <code>EntityManager</code>，类似 <code>SessionFactory</code>。</li>
<li><strong>特点</strong>：线程安全，全局单例。</li>
</ul>
</li>
<li><p><strong><code>javax.persistence.Query</code></strong></p>
<ul>
<li><strong>作用</strong>：执行 JPQL（类似 HQL）或原生 SQL 查询。</li>
<li><strong>获取方式</strong>：通过 <code>EntityManager.createQuery()</code> 创建。</li>
</ul>
</li>
<li><p><strong><code>javax.persistence.EntityTransaction</code></strong></p>
<ul>
<li><strong>作用</strong>：管理 JPA 事务。</li>
<li><strong>获取方式</strong>：通过 <code>EntityManager.getTransaction()</code> 获取。</li>
</ul>
</li>
</ol>
<h5 id="常用方法-3"><a href="#常用方法-3" class="headerlink" title="常用方法"></a><strong>常用方法</strong></h5><ul>
<li><p><strong><code>EntityManager</code> 方法</strong>：</p>
<ul>
<li><code>persist(Object)</code>：将实体设为持久化状态。</li>
<li><code>merge(Object)</code>：合并 detached 状态的实体。</li>
<li><code>remove(Object)</code>：删除实体。</li>
<li><code>find(Class, Object)</code>：根据 ID 查找实体。</li>
<li><code>createQuery(String)</code>：创建 JPQL 查询。</li>
<li><code>createNativeQuery(String)</code>：创建原生 SQL 查询。</li>
<li><code>flush()</code>：同步持久化上下文。</li>
<li><code>detach(Object)</code>：将实体从持久化上下文中分离。</li>
<li><code>getTransaction()</code>：获取事务对象。</li>
</ul>
</li>
<li><p><strong><code>EntityManagerFactory</code> 方法</strong>：</p>
<ul>
<li><code>createEntityManager()</code>：创建 <code>EntityManager</code>。</li>
<li><code>close()</code>：关闭工厂。</li>
</ul>
</li>
<li><p><strong><code>Query</code> 方法</strong>：</p>
<ul>
<li>类似 <code>Session</code> 的 <code>Query</code> 方法，如 <code>getResultList()</code>、<code>setParameter()</code>。</li>
</ul>
</li>
</ul>
<h5 id="Spring-Boot-示例（JPA）"><a href="#Spring-Boot-示例（JPA）" class="headerlink" title="Spring Boot 示例（JPA）"></a><strong>Spring Boot 示例（JPA）</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="comment">// Getters and Setters</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserRepository</span> &#123;</span><br><span class="line">    <span class="meta">@PersistenceContext</span></span><br><span class="line">    <span class="keyword">private</span> EntityManager entityManager;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        entityManager.persist(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">findById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> entityManager.find(User.class, id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-常用注解"><a href="#3-常用注解" class="headerlink" title="3. 常用注解"></a><strong>3. 常用注解</strong></h4><p>Hibernate 依赖注解定义实体和映射关系，常用注解包括：</p>
<ul>
<li><strong><code>@Entity</code></strong>：标记类为实体。</li>
<li><strong><code>@Table(name)</code></strong>：指定数据库表名。</li>
<li><strong><code>@Id</code></strong>：标记主键。</li>
<li><strong><code>@GeneratedValue</code></strong>：定义主键生成策略（如 <code>AUTO</code>、<code>IDENTITY</code>）。</li>
<li><strong><code>@Column</code></strong>：映射字段到列，指定属性（如 <code>nullable</code>、<code>length</code>）。</li>
<li><strong><code>@OneToMany</code> &#x2F; <code>@ManyToOne</code> &#x2F; <code>@ManyToMany</code></strong>：定义关联关系。</li>
<li><strong><code>@JoinColumn</code></strong>：指定外键列。</li>
<li><strong><code>@Fetch</code></strong>：设置加载策略（<code>FetchType.LAZY</code> 或 <code>EAGER</code>）。</li>
<li><strong><code>@Transactional</code></strong>（Spring）：管理事务。</li>
</ul>
<hr>
<h3 id="实践建议：掌握-Hibernate-的步骤"><a href="#实践建议：掌握-Hibernate-的步骤" class="headerlink" title="实践建议：掌握 Hibernate 的步骤"></a><strong>实践建议：掌握 Hibernate 的步骤</strong></h3><ol>
<li><p><strong>从简单实体开始</strong>：</p>
<ul>
<li>创建一个简单的实体类（如 <code>User</code>），使用 <code>@Entity</code>、<code>@Id</code> 等注解。</li>
<li>配置 <code>hibernate.cfg.xml</code> 或 Spring Boot 的 <code>application.properties</code>。</li>
<li>实现基本的 CRUD 操作，熟悉 <code>Session</code> 或 <code>EntityManager</code>。</li>
</ul>
</li>
<li><p><strong>学习 HQL 和 JPQL</strong>：</p>
<ul>
<li>编写简单的 HQL 查询（如 <code>from User where name = :name</code>）。</li>
<li>使用 <code>Query</code> 设置参数和分页。</li>
</ul>
</li>
<li><p><strong>探索关联映射</strong>：</p>
<ul>
<li>创建两个实体（如 <code>User</code> 和 <code>Order</code>），使用 <code>@OneToMany</code> 建立关系。</li>
<li>测试级联操作（如 <code>CascadeType.ALL</code>）和延迟加载。</li>
</ul>
</li>
<li><p><strong>集成 Spring</strong>：</p>
<ul>
<li>使用 Spring 的 <code>@Repository</code> 和 <code>@Transactional</code> 管理 <code>Session</code> 或 <code>EntityManager</code>。</li>
<li>尝试 Spring Data JPA，简化 DAO 层代码。</li>
</ul>
</li>
<li><p><strong>调试和优化</strong>：</p>
<ul>
<li>开启 <code>hibernate.show_sql</code> 和 <code>hibernate.format_sql</code> 查看生成的 SQL。</li>
<li>解决常见问题，如 <code>LazyInitializationException</code> 或 N+1 查询。</li>
<li>学习使用 <code>@BatchSize</code> 或二级缓存优化性能。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="推荐练习项目"><a href="#推荐练习项目" class="headerlink" title="推荐练习项目"></a><strong>推荐练习项目</strong></h3><ol>
<li><p><strong>用户管理系统</strong>：</p>
<ul>
<li>实体：<code>User</code>（ID、姓名、邮箱）、<code>Role</code>（ID、名称）。</li>
<li>功能：用户增删改查、角色分配（多对多关系）。</li>
<li>技术：Spring Boot + Hibernate + MySQL。</li>
</ul>
</li>
<li><p><strong>博客系统</strong>：</p>
<ul>
<li>实体：<code>Post</code>（ID、标题、内容）、<code>Comment</code>（ID、内容、Post）。</li>
<li>功能：发布帖子、添加评论（一对多关系）。</li>
<li>技术：Spring Boot + JPA + H2 数据库。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="注意事项-1"><a href="#注意事项-1" class="headerlink" title="注意事项"></a><strong>注意事项</strong></h3><ul>
<li><strong>版本兼容</strong>：确保 Hibernate、Spring 和数据库驱动版本兼容（如 Hibernate 5.x 搭配 Spring 5.x）。</li>
<li><strong>事务管理</strong>：始终在事务中执行写操作，避免非事务性错误。</li>
<li><strong>资源释放</strong>：手动管理 <code>Session</code> 时，确保关闭（Spring 自动管理）。</li>
<li><strong>性能监控</strong>：关注生成的 SQL，避免 N+1 查询问题。</li>
</ul>
<hr>
<h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a><strong>总结</strong></h3><ul>
<li><strong>入手方式</strong>：从配置环境、创建简单实体开始，逐步学习 CRUD、HQL 和关联映射，结合 Spring 实践。</li>
<li><strong>核心类&#x2F;接口</strong>：<code>Session</code>、<code>SessionFactory</code>（Hibernate 模式）或 <code>EntityManager</code>、<code>EntityManagerFactory</code>（JPA 模式）。</li>
<li><strong>核心方法</strong>：<code>save</code>、<code>get</code>、<code>createQuery</code>（Session）或 <code>persist</code>、<code>find</code>、<code>createQuery</code>（EntityManager）。</li>
<li><strong>实践重点</strong>：搭建小项目，熟悉注解、查询和事务管理。</li>
</ul>
<p>如果你有具体问题（如配置示例、某个方法的用法、调试错误），请提供更多细节，我可以进一步指导！</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/objective-c/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/objective-c/" class="post-title-link" itemprop="url">Objective-C 面向对象</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2025-11-26 00:00:00 / Modified: 15:43:52" itemprop="dateCreated datePublished" datetime="2025-11-26T00:00:00+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>[TOC]</p>
<h1 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h1><h3 id="1-Category-分类"><a href="#1-Category-分类" class="headerlink" title="1. Category(分类)"></a>1. <strong>Category(分类)</strong></h3><p><strong>Category</strong> 是 Objective-C 中用于扩展已有类功能的一种机制，无需继承即可为类添加方法。它的主要用途是增强类的功能或将类的实现分模块组织。</p>
<h4 id="特点："><a href="#特点：" class="headerlink" title="特点："></a>特点：</h4><ul>
<li><strong>无需子类化</strong>：可以在不修改原始类源码的情况下，为类添加新的方法。</li>
<li><strong>动态扩展</strong>：Category 在运行时动态地将方法添加到类中。</li>
<li><strong>模块化开发</strong>：可以将类的功能拆分成多个文件，便于团队协作或代码管理。</li>
<li><strong>限制</strong>：<ul>
<li>不能添加实例变量，只能添加方法。</li>
<li>如果 Category 中定义的方法与原始类或另一个 Category 中的方法同名，会覆盖原始方法（可能导致不可预测的行为）。</li>
<li>不能直接访问原始类的私有方法或变量。</li>
</ul>
</li>
</ul>
<h4 id="语法："><a href="#语法：" class="headerlink" title="语法："></a>语法：</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> 原类名 (<span class="title">CategoryName</span>)</span></span><br><span class="line"><span class="comment">// 声明新方法</span></span><br><span class="line">- (<span class="type">void</span>)newMethod;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> 原类名 (<span class="title">CategoryName</span>)</span></span><br><span class="line"><span class="comment">// 实现新方法</span></span><br><span class="line">- (<span class="type">void</span>)newMethod &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;This is a new method added by Category.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<h4 id="应用场景："><a href="#应用场景：" class="headerlink" title="应用场景："></a>应用场景：</h4><ol>
<li><p><strong>扩展系统类</strong>：例如，为 <code>NSString</code> 添加一个自定义方法：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSString</span> (<span class="title">MyExtension</span>)</span></span><br><span class="line">- (<span class="built_in">NSString</span> *)reverseString;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NSString</span> (<span class="title">MyExtension</span>)</span></span><br><span class="line">- (<span class="built_in">NSString</span> *)reverseString &#123;</span><br><span class="line">    <span class="built_in">NSMutableString</span> *reversed = [<span class="built_in">NSMutableString</span> stringWithCapacity:<span class="keyword">self</span>.length];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="keyword">self</span>.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        [reversed appendString:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@&quot;%C&quot;</span>, [<span class="keyword">self</span> characterAtIndex:i]]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> reversed;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>使用：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *str = <span class="string">@&quot;Hello&quot;</span>;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;%@&quot;</span>, [str reverseString]); <span class="comment">// 输出: olleH</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>代码组织</strong>：将大类的实现分成多个 Category，增强可读性和维护性。例如，<code>UIViewController</code> 可以按功能分为 <code>DataHandling</code> 和 <code>UIConfiguration</code> 两个 Category。</p>
</li>
<li><p><strong>修复或增强功能</strong>：在不修改第三方库的情况下，为其类添加功能。</p>
</li>
</ol>
<h4 id="注意事项："><a href="#注意事项：" class="headerlink" title="注意事项："></a>注意事项：</h4><ul>
<li><strong>方法冲突</strong>：如果多个 Category 或原始类定义了同名方法，运行时会选择其中一个（不可预测），应避免命名冲突。</li>
<li><strong>调试困难</strong>：Category 的方法覆盖可能导致调试复杂。</li>
<li><strong>最佳实践</strong>：为避免冲突，建议在方法名中加入前缀（如 <code>my_reverseString</code>）。</li>
</ul>
<hr>
<h3 id="2-Protocol（协议）"><a href="#2-Protocol（协议）" class="headerlink" title="2. Protocol（协议）"></a>2. <strong>Protocol（协议）</strong></h3><p><strong>Protocol</strong> 是 Objective-C 中定义一组方法规范的机制，类似于接口（interface）。它用于声明一组方法，供类实现，以保证类具有特定行为。</p>
<h4 id="特点：-1"><a href="#特点：-1" class="headerlink" title="特点："></a>特点：</h4><ul>
<li><strong>抽象性</strong>：Protocol 仅定义方法签名，不提供实现。</li>
<li><strong>多类共享</strong>：多个类可以实现同一个 Protocol，实现代码共享或行为一致性。</li>
<li><strong>可选与必须</strong>：方法可以标记为 <code>@required</code>（默认，必须实现）或 <code>@optional</code>（可选实现）。</li>
<li><strong>类型检查</strong>：编译器可以检查类是否遵循某个 Protocol。</li>
</ul>
<h4 id="语法：-1"><a href="#语法：-1" class="headerlink" title="语法："></a>语法：</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">MyProtocol</span> &lt;<span class="title">NSObject</span>&gt;</span></span><br><span class="line"><span class="comment">// 必须实现的方法</span></span><br><span class="line"><span class="keyword">@required</span></span><br><span class="line">- (<span class="type">void</span>)requiredMethod;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可选实现的方法</span></span><br><span class="line"><span class="keyword">@optional</span></span><br><span class="line">- (<span class="type">void</span>)optionalMethod;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyClass</span> : <span class="title">NSObject</span> &lt;<span class="title">MyProtocol</span>&gt;</span></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MyClass</span></span></span><br><span class="line">- (<span class="type">void</span>)requiredMethod &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;Required method implemented.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<h4 id="应用场景：-1"><a href="#应用场景：-1" class="headerlink" title="应用场景："></a>应用场景：</h4><ol>
<li><p><strong>委托模式（Delegate）</strong>：最常见的用途，例如 <code>UITableViewDelegate</code> 和 <code>UITableViewDataSource</code>。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">MyDelegate</span> &lt;<span class="title">NSObject</span>&gt;</span></span><br><span class="line"><span class="keyword">@required</span></span><br><span class="line">- (<span class="type">void</span>)didCompleteTask;</span><br><span class="line"><span class="keyword">@optional</span></span><br><span class="line">- (<span class="type">void</span>)progressUpdated:(<span class="type">float</span>)progress;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyClass</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="type">id</span>&lt;MyDelegate&gt; delegate;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>接口定义</strong>：定义一组标准接口，供不同类实现。例如，多个视图控制器实现同一个数据处理协议。</p>
</li>
<li><p><strong>类型安全</strong>：通过 Protocol 限制对象类型，确保对象支持特定方法：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">id</span>&lt;MyProtocol&gt; obj = [[MyClass alloc] init];</span><br><span class="line">[obj requiredMethod]; <span class="comment">// 编译器确保方法存在</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="注意事项：-1"><a href="#注意事项：-1" class="headerlink" title="注意事项："></a>注意事项：</h4><ul>
<li><strong>NSObject 协议</strong>：通常 Protocol 会继承 <code>&lt;NSObject&gt;</code> 协议，以确保对象支持基本方法（如 <code>respondsToSelector:</code>）。</li>
<li><strong>动态检查</strong>：使用 <code>conformsToProtocol:</code> 和 <code>respondsToSelector:</code> 检查对象是否遵循协议或实现某方法： <figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ([obj conformsToProtocol:<span class="class"><span class="keyword">@protocol</span>(<span class="title">MyProtocol</span>)]) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ([obj respondsToSelector:<span class="keyword">@selector</span>(optionalMethod)]) &#123;</span><br><span class="line">        [obj optionalMethod];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="3-Extension（类扩展）"><a href="#3-Extension（类扩展）" class="headerlink" title="3 Extension（类扩展）"></a>3 <strong>Extension（类扩展）</strong></h3><ul>
<li><strong>定义</strong>：类扩展是匿名的 Category，通常用于在类的实现文件中声明私有方法或属性。</li>
<li><strong>特点</strong>：<ul>
<li>可以在 <code>.m</code> 文件中声明私有方法或属性。</li>
<li>可以添加实例变量（与 Category 不同）。</li>
<li>仅在当前类实现文件可见，外部无法访问。</li>
</ul>
</li>
<li><strong>语法</strong>：<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyClass</span> ()</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSString</span> *privateProperty;</span><br><span class="line">- (<span class="type">void</span>)privateMethod;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MyClass</span></span></span><br><span class="line">- (<span class="type">void</span>)privateMethod &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;This is a private method.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></li>
<li><strong>用途</strong>：隐藏实现细节，声明私有接口，或为只读属性添加私有读写支持。</li>
</ul>
<h3 id="4-Dynamic-Runtime（运行时动态性）"><a href="#4-Dynamic-Runtime（运行时动态性）" class="headerlink" title="4  Dynamic Runtime（运行时动态性）"></a>4  <strong>Dynamic Runtime（运行时动态性）</strong></h3><ul>
<li>Objective-C 的运行时系统提供了强大的动态特性，支持以下功能：<ul>
<li><strong>方法交换（Method Swizzling）</strong>：在运行时替换方法实现，常用于调试或修改系统类行为。</li>
<li><strong>动态添加方法</strong>：通过 <code>class_addMethod</code> 动态为类添加方法。</li>
<li><strong>关联对象（Associated Objects）</strong>：通过 <code>objc_setAssociatedObject</code> 为 Category 添加“伪属性”。</li>
<li><strong>示例</strong>（添加关联对象）：<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&lt;objc/runtime.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSObject</span> (<span class="title">MyCategory</span>)</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSString</span> *associatedString;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NSObject</span> (<span class="title">MyCategory</span>)</span></span><br><span class="line"><span class="keyword">static</span> <span class="type">char</span> kAssociatedStringKey;</span><br><span class="line">- (<span class="type">void</span>)setAssociatedString:(<span class="built_in">NSString</span> *)string &#123;</span><br><span class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, &amp;kAssociatedStringKey, string, OBJC_ASSOCIATION_RETAIN_NONATOMIC);</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="built_in">NSString</span> *)associatedString &#123;</span><br><span class="line">    <span class="keyword">return</span> objc_getAssociatedObject(<span class="keyword">self</span>, &amp;kAssociatedStringKey);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></li>
<li><strong>用途</strong>：增强 Category 功能，实现动态行为修改。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="5-Category-vs-Protocol-vs-其他方案对比"><a href="#5-Category-vs-Protocol-vs-其他方案对比" class="headerlink" title="5. Category vs Protocol vs 其他方案对比"></a>5. <strong>Category vs Protocol vs 其他方案对比</strong></h3><table>
<thead>
<tr>
<th>特性&#x2F;机制</th>
<th>Category</th>
<th>Protocol</th>
<th>Extension</th>
<th>Block</th>
</tr>
</thead>
<tbody><tr>
<td><strong>用途</strong></td>
<td>扩展类方法</td>
<td>定义接口规范</td>
<td>声明私有方法&#x2F;属性</td>
<td>回调和函数式编程</td>
</tr>
<tr>
<td><strong>添加实例变量</strong></td>
<td>否（可通过关联对象实现）</td>
<td>否</td>
<td>是</td>
<td>否</td>
</tr>
<tr>
<td><strong>代码复用</strong></td>
<td>高（直接扩展类）</td>
<td>中（需实现）</td>
<td>低（仅限当前类）</td>
<td>高（独立逻辑）</td>
</tr>
<tr>
<td><strong>动态性</strong></td>
<td>高（运行时添加方法）</td>
<td>中（运行时检查方法）</td>
<td>低（编译时确定）</td>
<td>高（捕获上下文）</td>
</tr>
<tr>
<td><strong>典型场景</strong></td>
<td>系统类扩展、代码模块化</td>
<td>委托模式、接口定义</td>
<td>私有接口、属性扩展</td>
<td>异步回调、事件处理</td>
</tr>
</tbody></table>
<hr>
<h3 id="6-总结与建议"><a href="#6-总结与建议" class="headerlink" title="6. 总结与建议"></a>6. <strong>总结与建议</strong></h3><ul>
<li><strong>Category</strong> 适合快速扩展类功能，特别是为系统类或第三方库添加方法，但需注意方法冲突。</li>
<li><strong>Protocol</strong> 适合定义标准接口，确保类行为一致，广泛用于委托模式。</li>
<li><strong>Extension</strong> 用于私有接口，适合隐藏实现细节。</li>
<li><strong>Block</strong> 提供轻量级回调，适合异步任务。</li>
<li><strong>运行时动态性</strong> 提供了强大的灵活性，但需谨慎使用以避免复杂性。</li>
</ul>
<p>根据具体需求选择合适的方案：</p>
<ul>
<li>如果需要扩展现有类，使用 <strong>Category</strong>。</li>
<li>如果需要定义行为规范，使用 <strong>Protocol</strong>。</li>
<li>如果需要私有方法或属性，使用 <strong>Extension</strong>。</li>
<li>如果需要动态或回调逻辑，考虑 <strong>Block</strong> 或 <strong>运行时特性</strong>。</li>
</ul>
<p>如需更具体示例或深入探讨某一机制，请告诉我！</p>
<h1 id="NSURL"><a href="#NSURL" class="headerlink" title="NSURL"></a>NSURL</h1><h2 id="NSURLProtocol"><a href="#NSURLProtocol" class="headerlink" title="NSURLProtocol"></a>NSURLProtocol</h2><p>In the context of <code>WKWebView</code>, requests are generally <strong>not</strong> handled by <code>NSURLProtocol</code>, especially for custom schemes or even for <code>http/https</code> in most cases. Apple restricts <code>NSURLProtocol</code> usage in <code>WKWebView</code> for security and performance reasons.</p>
<p><strong>However, requests can be handled by <code>NSURLProtocol</code> in these scenarios:</strong></p>
<ul>
<li>When using <code>NSURLConnection</code> or <code>NSURLSession</code> <strong>outside</strong> of <code>WKWebView</code>, and you register a custom <code>NSURLProtocol</code> class, all matching requests (e.g., <code>http</code>, <code>https</code>, or custom schemes if registered) will be intercepted by your protocol handler.</li>
<li>In <code>UIWebView</code> (deprecated), <code>NSURLProtocol</code> can intercept requests.</li>
<li>In <code>WKWebView</code>, only if you use a custom <code>NSURLSession</code> (not the web view’s internal networking), and you register a protocol class on that session’s configuration, then requests made by that session (not the web view) can be intercepted.</li>
</ul>
<p><strong>Summary:</strong><br>In <code>WKWebView</code>, requests are not forwarded to <code>NSURLProtocol</code>. Only network requests made by your own <code>NSURLSession</code> or <code>NSURLConnection</code> (outside of <code>WKWebView</code>) can be intercepted by <code>NSURLProtocol</code>.</p>
<hr>
<h2 id="WKURLSchemeHandler"><a href="#WKURLSchemeHandler" class="headerlink" title="WKURLSchemeHandler"></a>WKURLSchemeHandler</h2><ul>
<li><p>拦截处理自定义 scheme（非 https&#x2F;http） </p>
<blockquote>
<p>通过实现WKURLSchemeHandler protocol，可以拦截和处理 WKWebView 发起的特定 scheme（如 http&#x2F;https 以外的自定义协议）请求，实现自定义的网络请求逻辑</p>
</blockquote>
</li>
<li><p>apple 推荐的官方协议，用来处理自定义的 scheme</p>
</li>
<li><p><strong><code> https/http</code> 请求无法在 wkwebview 中被拦截处理</strong></p>
</li>
<li><p>WKWebview 不支持使用<code>NSURLProtocol</code>来拦截请求，forward 到<code>NSURLSession</code>是官方推荐可信任的做法</p>
</li>
</ul>
<hr>
<h2 id="NSURLSessionDelegate"><a href="#NSURLSessionDelegate" class="headerlink" title="NSURLSessionDelegate"></a>NSURLSessionDelegate</h2><ul>
<li><code>WKURLSchemeHandler</code> 拦截的请求，会被转发到<code>NSURLSession</code>， 并通过 NSURLSessionDelegate 进行处理。</li>
</ul>
<h1 id="UIViewController"><a href="#UIViewController" class="headerlink" title="UIViewController"></a>UIViewController</h1><p>UIViewController的生命周期函数介绍：</p>
<h2 id="主要生命周期方法"><a href="#主要生命周期方法" class="headerlink" title="主要生命周期方法"></a>主要生命周期方法</h2><h3 id="1-viewDidLoad"><a href="#1-viewDidLoad" class="headerlink" title="1. viewDidLoad"></a>1. <code>viewDidLoad</code></h3><ul>
<li><strong>调用时机</strong>：视图控制器的视图层次结构加载到内存中后调用</li>
<li><strong>用途</strong>：进行一次性初始化，如创建UI元素、设置初始状态</li>
<li><strong>特点</strong>：只调用一次</li>
</ul>
<h3 id="2-viewWillAppear"><a href="#2-viewWillAppear" class="headerlink" title="2. viewWillAppear:"></a>2. <code>viewWillAppear:</code></h3><ul>
<li><strong>调用时机</strong>：视图即将显示前调用</li>
<li><strong>用途</strong>：准备显示视图，如刷新数据、重置UI状态</li>
<li><strong>特点</strong>：每次视图显示前都会调用</li>
</ul>
<h3 id="3-viewDidAppear"><a href="#3-viewDidAppear" class="headerlink" title="3. viewDidAppear:"></a>3. <code>viewDidAppear:</code></h3><ul>
<li><strong>调用时机</strong>：视图已经显示后调用</li>
<li><strong>用途</strong>：启动动画、开始定时器、注册通知等</li>
<li><strong>特点</strong>：每次视图显示后都会调用</li>
</ul>
<h3 id="4-viewWillDisappear"><a href="#4-viewWillDisappear" class="headerlink" title="4. viewWillDisappear:"></a>4. <code>viewWillDisappear:</code></h3><ul>
<li><strong>调用时机</strong>：视图即将消失前调用</li>
<li><strong>用途</strong>：保存数据、暂停操作、验证输入等</li>
<li><strong>特点</strong>：每次视图消失前都会调用</li>
</ul>
<h3 id="5-viewDidDisappear"><a href="#5-viewDidDisappear" class="headerlink" title="5. viewDidDisappear:"></a>5. <code>viewDidDisappear:</code></h3><ul>
<li><strong>调用时机</strong>：视图已经消失后调用</li>
<li><strong>用途</strong>：停止定时器、取消网络请求、清理资源等</li>
<li><strong>特点</strong>：每次视图消失后都会调用</li>
</ul>
<h3 id="6-viewDidUnload-iOS-6之前"><a href="#6-viewDidUnload-iOS-6之前" class="headerlink" title="6. viewDidUnload (iOS 6之前)"></a>6. <code>viewDidUnload</code> (iOS 6之前)</h3><ul>
<li><strong>调用时机</strong>：内存不足时系统卸载视图</li>
<li><strong>用途</strong>：清理视图相关资源</li>
<li><strong>特点</strong>：iOS 6后已废弃</li>
</ul>
<h2 id="生命周期顺序"><a href="#生命周期顺序" class="headerlink" title="生命周期顺序"></a>生命周期顺序</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">创建 → viewDidLoad → viewWillAppear → viewDidAppear</span><br><span class="line">     ↓</span><br><span class="line">显示中的视图</span><br><span class="line">     ↓</span><br><span class="line">viewWillDisappear → viewDidDisappear → 销毁</span><br></pre></td></tr></table></figure>

<h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><ul>
<li><strong>viewDidLoad</strong>：创建UI、设置委托、初始化数据源</li>
<li><strong>viewWillAppear</strong>：刷新界面数据、重置状态</li>
<li><strong>viewDidAppear</strong>：开始网络请求、启动动画</li>
<li><strong>viewWillDisappear</strong>：保存用户输入、暂停活动</li>
<li><strong>viewDidDisappear</strong>：清理资源、停止后台任务</li>
</ul>
<h1 id="UIApplication"><a href="#UIApplication" class="headerlink" title="UIApplication"></a>UIApplication</h1><h2 id="UIViewController-和-UIApplication-的关系"><a href="#UIViewController-和-UIApplication-的关系" class="headerlink" title="UIViewController 和 UIApplication 的关系"></a>UIViewController 和 UIApplication 的关系</h2><h3 id="层次关系"><a href="#层次关系" class="headerlink" title="层次关系"></a>层次关系</h3><ul>
<li><strong>UIApplication</strong>：应用程序的单例对象，管理整个应用的生命周期</li>
<li><strong>UIViewController</strong>：管理单个视图的控制器，是UIApplication管理的视图层次结构的一部分</li>
</ul>
<h3 id="包含关系"><a href="#包含关系" class="headerlink" title="包含关系"></a>包含关系</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">UIApplication</span><br><span class="line">├── UIWindow</span><br><span class="line">    ├── Root UIViewController</span><br><span class="line">        ├── Child UIViewController</span><br><span class="line">        └── Presented UIViewController</span><br></pre></td></tr></table></figure>

<h2 id="生命周期函数对应关系"><a href="#生命周期函数对应关系" class="headerlink" title="生命周期函数对应关系"></a>生命周期函数对应关系</h2><h3 id="UIApplication-生命周期方法（AppDelegate）"><a href="#UIApplication-生命周期方法（AppDelegate）" class="headerlink" title="UIApplication 生命周期方法（AppDelegate）"></a>UIApplication 生命周期方法（AppDelegate）</h3><h4 id="1-application-didFinishLaunchingWithOptions"><a href="#1-application-didFinishLaunchingWithOptions" class="headerlink" title="1. application:didFinishLaunchingWithOptions:"></a>1. <code>application:didFinishLaunchingWithOptions:</code></h4><ul>
<li><strong>对应UIViewController</strong>：在root view controller的<code>viewDidLoad</code>之前调用</li>
<li><strong>关系</strong>：应用启动完成 → 创建window和root view controller</li>
</ul>
<h4 id="2-applicationDidBecomeActive"><a href="#2-applicationDidBecomeActive" class="headerlink" title="2. applicationDidBecomeActive:"></a>2. <code>applicationDidBecomeActive:</code></h4><ul>
<li><strong>对应UIViewController</strong>：当前可见view controller的<code>viewWillAppear:</code>和<code>viewDidAppear:</code></li>
<li><strong>关系</strong>：应用变为活跃状态 → 视图控制器开始显示</li>
</ul>
<h4 id="3-applicationWillResignActive"><a href="#3-applicationWillResignActive" class="headerlink" title="3. applicationWillResignActive:"></a>3. <code>applicationWillResignActive:</code></h4><ul>
<li><strong>对应UIViewController</strong>：当前可见view controller的<code>viewWillDisappear:</code></li>
<li><strong>关系</strong>：应用即将失去焦点 → 视图即将不可交互</li>
</ul>
<h4 id="4-applicationDidEnterBackground"><a href="#4-applicationDidEnterBackground" class="headerlink" title="4. applicationDidEnterBackground:"></a>4. <code>applicationDidEnterBackground:</code></h4><ul>
<li><strong>对应UIViewController</strong>：当前可见view controller的<code>viewDidDisappear:</code></li>
<li><strong>关系</strong>：应用进入后台 → 视图完全不可见</li>
</ul>
<h4 id="5-applicationWillEnterForeground"><a href="#5-applicationWillEnterForeground" class="headerlink" title="5. applicationWillEnterForeground:"></a>5. <code>applicationWillEnterForeground:</code></h4><ul>
<li><strong>对应UIViewController</strong>：即将显示的view controller的<code>viewWillAppear:</code></li>
<li><strong>关系</strong>：应用即将回到前台 → 视图即将重新显示</li>
</ul>
<h4 id="6-applicationWillTerminate"><a href="#6-applicationWillTerminate" class="headerlink" title="6. applicationWillTerminate:"></a>6. <code>applicationWillTerminate:</code></h4><ul>
<li><strong>对应UIViewController</strong>：所有view controller的清理工作</li>
<li><strong>关系</strong>：应用即将终止 → 所有视图控制器被销毁</li>
</ul>
<h2 id="调用顺序示例"><a href="#调用顺序示例" class="headerlink" title="调用顺序示例"></a>调用顺序示例</h2><h3 id="应用启动"><a href="#应用启动" class="headerlink" title="应用启动"></a>应用启动</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. application:didFinishLaunchingWithOptions:</span><br><span class="line">2. viewDidLoad (root ViewController)</span><br><span class="line">3. viewWillAppear: (root ViewController) </span><br><span class="line">4. applicationDidBecomeActive:</span><br><span class="line">5. viewDidAppear: (root ViewController)</span><br></pre></td></tr></table></figure>

<h3 id="应用进入后台"><a href="#应用进入后台" class="headerlink" title="应用进入后台"></a>应用进入后台</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. applicationWillResignActive:</span><br><span class="line">2. viewWillDisappear: (current ViewController)</span><br><span class="line">3. applicationDidEnterBackground:</span><br><span class="line">4. viewDidDisappear: (current ViewController)</span><br></pre></td></tr></table></figure>

<h3 id="应用回到前台"><a href="#应用回到前台" class="headerlink" title="应用回到前台"></a>应用回到前台</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. applicationWillEnterForeground:</span><br><span class="line">2. viewWillAppear: (current ViewController)</span><br><span class="line">3. applicationDidBecomeActive:</span><br><span class="line">4. viewDidAppear: (current ViewController)</span><br></pre></td></tr></table></figure>

<h2 id="实际应用建议"><a href="#实际应用建议" class="headerlink" title="实际应用建议"></a>实际应用建议</h2><ul>
<li><strong>UIApplication级别</strong>：处理全局状态、推送通知、应用级别的数据保存</li>
<li><strong>UIViewController级别</strong>：处理界面相关的逻辑、用户交互、视图状态管理</li>
<li><strong>协调使用</strong>：在AppDelegate中可以通知当前的view controller应用状态变化</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/homeDocs/Spring/Spring%20AOP%20%E4%BA%8B%E5%8A%A1%E5%A4%B1%E6%95%88%E4%B8%8E%E5%BA%95%E5%B1%82%E4%BB%A3%E7%90%86%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/homeDocs/Spring/Spring%20AOP%20%E4%BA%8B%E5%8A%A1%E5%A4%B1%E6%95%88%E4%B8%8E%E5%BA%95%E5%B1%82%E4%BB%A3%E7%90%86%E6%80%BB%E7%BB%93/" class="post-title-link" itemprop="url">Spring AOP 事务失效与底层代理总结</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2025-11-26 00:00:00 / Modified: 15:43:52" itemprop="dateCreated datePublished" datetime="2025-11-26T00:00:00+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Spring-AOP-事务失效与底层代理机制深度总结"><a href="#Spring-AOP-事务失效与底层代理机制深度总结" class="headerlink" title="Spring AOP 事务失效与底层代理机制深度总结"></a>Spring AOP 事务失效与底层代理机制深度总结</h1><h2 id="1-核心问题-为什么自调用导致事务失效"><a href="#1-核心问题-为什么自调用导致事务失效" class="headerlink" title="1. 核心问题:为什么自调用导致事务失效?"></a>1. 核心问题:为什么自调用导致事务失效?</h2><h3 id="现象"><a href="#现象" class="headerlink" title="现象"></a>现象</h3><p>在同一个类中，方法 A 调用方法 B（<code>this.methodB()</code>），即使方法 B 上加了 <code>@Transactional</code> 注解，事务依然不生效。</p>
<h3 id="根本原因"><a href="#根本原因" class="headerlink" title="根本原因"></a>根本原因</h3><p>Spring AOP 的默认实现基于 <strong>代理模式 (Proxy Pattern)</strong>。Spring 容器中注入的 Bean 实际上是一个 <strong>代理对象 (Proxy)</strong>，它持有你编写的 <strong>目标对象 (Target)</strong>。</p>
<ul>
<li><strong>生效路径</strong>：外部调用 $\rightarrow$ Proxy $\rightarrow$ 事务拦截器 (Interceptor) $\rightarrow$ Target。</li>
<li><strong>失效路径</strong>：Target 内部调用 $\rightarrow$ <code>this.methodB()</code> $\rightarrow$ Target。</li>
</ul>
<p>此时，<code>this</code> 指针指向的是<strong>目标对象本身</strong>。代码执行流直接在目标对象内部流转，完全<strong>绕过</strong>了外层的代理对象及其持有的事务拦截器。</p>
<h3 id="形象比喻"><a href="#形象比喻" class="headerlink" title="形象比喻"></a>形象比喻</h3><ul>
<li><strong>Proxy (代理)</strong>：大楼门口的<strong>安检员</strong>。</li>
<li><strong>Target (目标)</strong>：大楼里的<strong>员工</strong>。</li>
<li><strong>外部访问</strong>：访客找员工，必须经过安检（事务生效）。</li>
<li><strong>内部自调用</strong>：员工之间互找，直接在楼里见面，不需要跑出去再过一次安检（事务失效）。</li>
</ul>
<hr>
<h2 id="2-解决方案-按架构师推荐度排序"><a href="#2-解决方案-按架构师推荐度排序" class="headerlink" title="2. 解决方案 (按架构师推荐度排序)"></a>2. 解决方案 (按架构师推荐度排序)</h2><table>
<thead>
<tr>
<th><strong>方案</strong></th>
<th><strong>具体做法</strong></th>
<th><strong>评价</strong></th>
<th><strong>适用场景</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>1. 架构重构 (Refactoring)</strong></td>
<td>将需要事务的方法提取到<strong>独立的 Service</strong> 中，通过 Bean 注入调用。</td>
<td>⭐⭐⭐⭐⭐ (强烈推荐)</td>
<td>符合单一职责原则 (SRP)，代码结构最清晰。</td>
</tr>
<tr>
<td><strong>2. 自我注入 (Self-Injection)</strong></td>
<td>在类中注入自身 (<code>@Lazy</code> 解决循环依赖)，调用 <code>self.methodB()</code>。</td>
<td>⭐⭐⭐ (可用)</td>
<td>业务逻辑紧密耦合，不适合拆分文件时。</td>
</tr>
<tr>
<td><strong>3. AopContext</strong></td>
<td>使用 <code>AopContext.currentProxy()</code> 强转获取当前代理对象。</td>
<td>⭐ (不推荐)</td>
<td>代码侵入性强，与 Spring API 强耦合。</td>
</tr>
<tr>
<td><strong>4. AspectJ</strong></td>
<td>放弃代理模式，使用字节码织入 (Weaving)。</td>
<td>N&#x2F;A (特殊需求)</td>
<td>追求极致性能或必须在 private&#x2F;自调用中生效时。</td>
</tr>
</tbody></table>
<hr>
<h2 id="3-深度辨析：JDK-动态代理-vs-CGLIB"><a href="#3-深度辨析：JDK-动态代理-vs-CGLIB" class="headerlink" title="3. 深度辨析：JDK 动态代理 vs CGLIB"></a>3. 深度辨析：JDK 动态代理 vs CGLIB</h2><p><img src="/../../Pics/image-20251126101915903.png" alt="image-20251126101915903"></p>
<h3 id="常见误区"><a href="#常见误区" class="headerlink" title="常见误区"></a>常见误区</h3><blockquote>
<p><strong>误区</strong>：”JDK Proxy 会导致自调用失效，换成 CGLIB 就能解决了。”</p>
<p><strong>真相</strong>：<strong>错误的。</strong> 无论是 JDK Proxy 还是 CGLIB，只要是基于<strong>代理模式</strong>，自调用都会失效。因为它们底层架构都是 <code>Proxy</code> 持有 <code>Target</code>。</p>
</blockquote>
<h3 id="技术对比表"><a href="#技术对比表" class="headerlink" title="技术对比表"></a>技术对比表</h3><table>
<thead>
<tr>
<th><strong>维度</strong></th>
<th><strong>JDK 动态代理</strong></th>
<th><strong>CGLIB (Code Generation Library)</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>实现机制</strong></td>
<td>基于 <strong>接口 (Interface)</strong></td>
<td>基于 <strong>继承 (Subclass)</strong></td>
</tr>
<tr>
<td><strong>类关系</strong></td>
<td>代理类与目标类是 <strong>兄弟关系</strong></td>
<td>代理类是目标类的 <strong>子类</strong></td>
</tr>
<tr>
<td><strong>核心限制</strong></td>
<td>目标类 <strong>必须实现接口</strong></td>
<td>目标类或方法 <strong>不能是 Final</strong></td>
</tr>
<tr>
<td><strong>调用方式</strong></td>
<td><strong>反射</strong> (<code>Method.invoke</code>)</td>
<td><strong>FastClass 索引</strong> (直接调用)</td>
</tr>
<tr>
<td><strong>自调用支持</strong></td>
<td>❌ 不支持</td>
<td>❌ 不支持</td>
</tr>
<tr>
<td><strong>Spring 默认</strong></td>
<td>旧版本 (有接口时默认)</td>
<td><strong>Spring Boot 2.0+ 默认</strong></td>
</tr>
</tbody></table>
<hr>
<h2 id="4-性能黑科技：CGLIB-的-FastClass-机制"><a href="#4-性能黑科技：CGLIB-的-FastClass-机制" class="headerlink" title="4. 性能黑科技：CGLIB 的 FastClass 机制"></a>4. 性能黑科技：CGLIB 的 FastClass 机制</h2><p>CGLIB 在运行时之所以高效，是因为它通过 <strong>FastClass</strong> 机制规避了 Java 反射 API 的开销。</p>
<h3 id="FastClass-原理"><a href="#FastClass-原理" class="headerlink" title="FastClass 原理"></a>FastClass 原理</h3><p>CGLIB 在生成代理类时，会利用 ASM 字节码技术额外生成一个 <code>FastClass</code>。它相当于把”反射查找”变成了”硬编码的索引跳转”。</p>
<p><strong>伪代码逻辑：</strong></p>
<p>Java</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// FastClass 就像一个巨大的 switch-case，建立了 方法签名 -&gt; 索引 的映射</span><br><span class="line">public Object invoke(int index, Object target, Object[] args) &#123;</span><br><span class="line">    MyService service = (MyService) target;</span><br><span class="line">    // 直接调用，没有反射的 invoke() 开销</span><br><span class="line">    switch (index) &#123;</span><br><span class="line">        case 1: return service.login(); </span><br><span class="line">        case 2: return service.logout();</span><br><span class="line">    &#125;</span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="总结-FastClass"><a href="#总结-FastClass" class="headerlink" title="总结 FastClass"></a>总结 FastClass</h3><ul>
<li><strong>本质</strong>：<strong>空间换时间</strong>。通过生成更多的字节码类，建立索引。</li>
<li><strong>优势</strong>：<strong>运行时 (Runtime)</strong> 调用速度极快，接近原生 Java 方法调用，不仅省去了反射的安全检查，还能享受 JVM 的内联优化。</li>
<li><strong>劣势</strong>：<strong>启动时间</strong>稍慢（需要生成和加载字节码）。</li>
</ul>
<hr>
<h2 id="5-架构师建议-“The-Spring-Way”"><a href="#5-架构师建议-“The-Spring-Way”" class="headerlink" title="5. 架构师建议 (“The Spring Way”)"></a>5. 架构师建议 (“The Spring Way”)</h2><ol>
<li><strong>首选重构</strong>：遇到自调用失效，首先反思类的职责是否过重。将事务逻辑拆分到不同 Service 是最优雅的解法。</li>
<li><strong>拥抱 CGLIB</strong>：在 Spring Boot 2.x&#x2F;3.x 时代，默认使用 CGLIB 是最佳实践（稳定、高效、无需接口），除非你有特殊的 JDK 原生洁癖。</li>
<li><strong>避坑 Final</strong>：使用 Spring 管理的 Bean（尤其是涉及 AOP&#x2F;事务的），<strong>严禁</strong>将类或方法设为 <code>final</code>，否则 CGLIB 无法生成子类代理，会导致启动报错或 AOP 失效。</li>
<li><strong>理解原理</strong>：不要盲目背诵“CGLIB 比 JDK 快”，要理解它是通过“启动时的复杂”换取了“运行时的简单”。</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/MDM/Stolen%20Device%20Protection/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/MDM/Stolen%20Device%20Protection/" class="post-title-link" itemprop="url">Stolen Device Protection</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2025-11-26 00:00:00 / Modified: 15:43:52" itemprop="dateCreated datePublished" datetime="2025-11-26T00:00:00+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Reference Doc: <a target="_blank" rel="noopener" href="https://support.apple.com/en-us/120340">https://support.apple.com/en-us/120340</a></p>
<h3 id="1-Executive-Summary-of-the-Article"><a href="#1-Executive-Summary-of-the-Article" class="headerlink" title="1. Executive Summary of the Article"></a><strong>1. Executive Summary of the Article</strong></h3><p><strong>“Stolen Device Protection”</strong> is a security feature introduced in iOS 17.3 designed to protect users if their iPhone is stolen <em>and</em> the thief knows their passcode.</p>
<p>Prior to this feature, a passcode was enough to reset the Apple ID password, turn off Find My, and access passwords. This feature adds a layer of security that requires <strong>Face ID or Touch ID</strong> (biometrics) without a passcode fallback when the device detects it is away from <strong>“Familiar Locations”</strong> (like home or work).</p>
<h3 id="2-Key-Mechanisms"><a href="#2-Key-Mechanisms" class="headerlink" title="2. Key Mechanisms"></a><strong>2. Key Mechanisms</strong></h3><p>The feature details two specific restrictions applied when the device is in an unfamiliar location:</p>
<ul>
<li><strong>Biometric Authentication (No Passcode Fallback):</strong><ul>
<li>Use passwords or passkeys saved in Keychain</li>
<li>Use payment methods saved in Safari (AutoFill)</li>
<li>Turn off Lost Mode</li>
<li>Open a locked app</li>
<li>Erase all content and settings</li>
<li>Apply for a new Apple Card</li>
<li>View your Apple Card or Apple Cash virtual card number</li>
<li>Take certain Apple Cash and Savings actions in Wallet (for example, Apple Cash or Savings transfers)</li>
<li>Use your iPhone to set up a new device (for example, Quick Start)</li>
<li>Set up or transfer an eSIM</li>
<li><em><strong>Impact</strong>:</em> Even if a thief knows the passcode, they cannot access money or credentials.</li>
</ul>
</li>
<li><strong>Security Delay (1-Hour Wait):</strong><ul>
<li>Following critical security changes, the device imposes a <strong>1-hour delay</strong>.<ul>
<li>Change your Apple Account password</li>
<li>Sign out of your Apple Account</li>
<li>Update Apple Account security settings (such as adding or removing a trusted device, Recovery Key, or Recovery Contact)</li>
<li>Add or remove Face ID or Touch ID</li>
<li>Change your passcode</li>
<li>Reset All Settings</li>
<li>Enroll in Mobile Device Management</li>
<li>Turn off Stolen Device Protection</li>
</ul>
</li>
<li><strong>The Workflow:</strong> User authenticates with Face ID &#x3D;&gt; Wait 1 hour &#x3D;&gt; User authenticates with Face ID again.</li>
<li><em><strong>Purpose</strong>:</em> This gives the original owner time to mark the device as lost before the thief can lock them out of their account.</li>
</ul>
</li>
</ul>
<hr>
<h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a><strong>Conclusion</strong></h3><ul>
<li>The feature describes a powerful anti-theft tool that shifts security from “What you know” (Passcode) to “Who you are” (Biometrics). </li>
<li><strong>There is no specific MDM command, payload, or configuration key</strong> that allows an MDM provider to directly enable, disable, or configure Stolen Device Protection. This is a user-centric security feature tied to the user’s personal Apple ID and biometric data (Face ID&#x2F;Touch ID), designed to prevent unauthorized changes even if the device is managed.</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/MDM/UserEnrollment/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/MDM/UserEnrollment/" class="post-title-link" itemprop="url">MDM Enrolment Types</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2025-11-26 00:00:00 / Modified: 15:43:52" itemprop="dateCreated datePublished" datetime="2025-11-26T00:00:00+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="MDM-Enrolment-Types"><a href="#MDM-Enrolment-Types" class="headerlink" title="MDM Enrolment Types"></a>MDM Enrolment Types</h1><p><a target="_blank" rel="noopener" href="https://support.apple.com/en-sg/guide/deployment/dep08f54fcf6/web">Enrolment methods for Apple devices</a></p>
<h2 id="1-Profile-based-Device-Enrollment"><a href="#1-Profile-based-Device-Enrollment" class="headerlink" title="1. Profile-based Device Enrollment"></a>1. Profile-based Device Enrollment</h2><p><a target="_blank" rel="noopener" href="https://support.apple.com/en-in/guide/deployment/depd1c27dfe6/1/web/1.0">https://support.apple.com/en-in/guide/deployment/depd1c27dfe6/1/web/1.0</a></p>
<blockquote>
<p><em>Profile-based Device Enrolment:</em> Users get an enrolment profile they must install on their device.</p>
</blockquote>
<h2 id="2-Account-Driven-Device-Enrollment"><a href="#2-Account-Driven-Device-Enrollment" class="headerlink" title="2. Account-Driven Device Enrollment"></a>2. Account-Driven Device Enrollment</h2><p><a target="_blank" rel="noopener" href="https://support.apple.com/en-in/guide/deployment/depd1c27dfe6/1/web/1.0">https://support.apple.com/en-in/guide/deployment/depd1c27dfe6/1/web/1.0</a></p>
<blockquote>
<p><em>Account-driven Device Enrolment:</em> Users sign in with their Managed Apple Account in Settings or System Settings.</p>
</blockquote>
<h2 id="3-Automated-Device-Enrollment"><a href="#3-Automated-Device-Enrollment" class="headerlink" title="3. Automated Device Enrollment"></a>3. Automated Device Enrollment</h2><p><a target="_blank" rel="noopener" href="https://support.apple.com/en-in/guide/deployment/dep73069dd57/1/web/1.0">https://support.apple.com/en-in/guide/deployment/dep73069dd57/1/web/1.0</a></p>
<h2 id="4-Profile-based-User-Enrollment"><a href="#4-Profile-based-User-Enrollment" class="headerlink" title="4. Profile-based User Enrollment"></a>4. <del>Profile-based User Enrollment</del></h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://support.apple.com/en-in/121158">https://support.apple.com/en-in/121158</a>: <strong>Profile-based is no longer supported since iOS 18.</strong></p>
</blockquote>
<h2 id="5-Account-Driven-User-Enrollment"><a href="#5-Account-Driven-User-Enrollment" class="headerlink" title="5. Account-Driven User Enrollment"></a>5. Account-Driven User Enrollment</h2><h3 id="Concept"><a href="#Concept" class="headerlink" title="Concept"></a>Concept</h3><p><a target="_blank" rel="noopener" href="https://support.apple.com/en-in/guide/deployment/dep23db2037d/1/web/1.0">https://support.apple.com/en-in/guide/deployment/dep23db2037d/1/web/1.0</a></p>
<p>Users sign in with their Managed Apple Account in Settings or System Settings.</p>
<h3 id="Key-Points"><a href="#Key-Points" class="headerlink" title="Key Points"></a>Key Points</h3><ul>
<li>Organisations can take advantage of integrating with an IdP, Google Workspace or Microsoft Entra ID: <a target="_blank" rel="noopener" href="https://support.apple.com/guide/apple-business-manager/axmb19317543">Intro to federated authentication with Apple Business Manager</a>.</li>
<li>Federated authentication - Integrate Apple devices with Microsoft: <a target="_blank" rel="noopener" href="https://support.apple.com/en-sg/guide/deployment/depa85a35cf2/1/web/1.0">https://support.apple.com/en-sg/guide/deployment/depa85a35cf2/1/web/1.0</a></li>
<li><a target="_blank" rel="noopener" href="https://support.apple.com/en-sg/guide/deployment/enrolment-sso-iphone-ipad-apple-vision-pro-dep267836bdc/1/web/1.0">Enrolment Single Sign-on for iPhone, iPad and Apple Vision Pro</a>.</li>
</ul>
<p>![image-20250407150326290](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20250407150326290.png)</p>
<p>![image-20250407150250557](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20250407150250557.png)</p>
<h3 id="Authenticate-Methods"><a href="#Authenticate-Methods" class="headerlink" title="Authenticate Methods"></a>Authenticate Methods</h3><h4 id="Simple-Authentication"><a href="#Simple-Authentication" class="headerlink" title="Simple Authentication"></a>Simple Authentication</h4><p>This method was introduced in iOS 15.</p>
<p>Guide: <a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/devicemanagement/implementing-the-simple-authentication-user-enrollment-flow">Implementing the simple authentication user-enrollment flow</a></p>
<p><img src="https://docs-assets.developer.apple.com/published/0d3c28bcc45f65cb5210f9635b1a95a6/media-4091468@2x.png" alt="A sequence diagram showing the first 5 interactions between the user, client, server, and Apple servers for simple authentication."></p>
<p><img src="https://docs-assets.developer.apple.com/published/be55f211bba11bab44eff9ec91bf8764/media-4091469@2x.png" alt="A sequence diagram showing interactions 6-11 between the user, client, server, and Apple servers for simple authentication."></p>
<p><img src="https://docs-assets.developer.apple.com/published/0d9a9bb4703ca84da712f9b77ec825d1/media-4091470@2x.png" alt="A sequence diagram showing interactions 12-20 between the user, client, server, and Apple servers for simple authentication."></p>
<h4 id="OAuth2-Authentication"><a href="#OAuth2-Authentication" class="headerlink" title="OAuth2 Authentication"></a>OAuth2 Authentication</h4><p>This method was introduced in iOS 16.</p>
<p>Guide: <a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/devicemanagement/implementing-the-oauth2-authentication-user-enrollment-flow">Implementing the OAuth2 authentication user-enrollment flow</a></p>
<p><img src="https://docs-assets.developer.apple.com/published/0d3c28bcc45f65cb5210f9635b1a95a6/media-4091468@2x.png" alt="A sequence diagram showing the first 5 interactions between the user, client, server, and Apple servers for simple authentication."></p>
<p>401 Response Bearer scheme</p>
<table>
<thead>
<tr>
<th align="left">Name</th>
<th align="left">Content</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>method</code></td>
<td align="left">(Required) A string that must be <code>apple-oauth2</code>, defining the authentication protocol.</td>
</tr>
<tr>
<td align="left"><code>authorization-url</code></td>
<td align="left">(Required) The OAuth2 protocol authorization endpoint URL, for the initial ASWebAuthenticationSession HTTP request. The URL scheme must be <code>https</code>.</td>
</tr>
<tr>
<td align="left"><code>token-url</code></td>
<td align="left">(Required) The OAuth2 protocol token endpoint URL, for the token request. The URL scheme must be <code>https</code>.</td>
</tr>
<tr>
<td align="left"><code>redirect-url</code></td>
<td align="left">(Required) The OAuth2 protocol redirection endpoint URL, where the OAuth2 authorization request redirects to on success. Since the authorization request uses the <a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/AuthenticationServices/ASWebAuthenticationSession"><code>ASWebAuthenticationSession</code></a> protocol, this URL scheme must be set to <code>apple-remotemanagement-user-login</code> and have a path component set to the server’s redirection endpoint.</td>
</tr>
<tr>
<td align="left"><code>client-id</code></td>
<td align="left">(Required) The OAuth2 protocol client identifier that the client must use in the OAuth2 authorization request.</td>
</tr>
<tr>
<td align="left"><code>scope</code></td>
<td align="left">The OAuth2 protocol access token scope the client must use in the OAuth2 authorization request.</td>
</tr>
</tbody></table>
<p><img src="https://docs-assets.developer.apple.com/published/28b776ef1f3d2b49cde6c822b6ae94f0/media-4091472@2x.png" alt="A sequence diagram showing interactions 6-11 between the user, client, server, and Apple servers for OAuth2 authentication."></p>
<p><img src="https://docs-assets.developer.apple.com/published/a35a8a1b9c4a92b221ca627681a6fa5c/media-4091471@2x.png" alt="A sequence diagram showing interactions 12 and 13 between the user, client, server, and Apple servers for OAuth2 authentication."></p>
<p><img src="https://docs-assets.developer.apple.com/published/6a9f1c4d34cfffc5b380b886414e97cb/media-4091473@2x.png" alt="A sequence diagram showing interactions 14-20 between the user, client, server, and Apple servers for OAuth2 authentication."></p>
<h4 id="Enrollment-SSO-Based-on-OAuth2"><a href="#Enrollment-SSO-Based-on-OAuth2" class="headerlink" title="Enrollment SSO (Based on OAuth2)"></a>Enrollment SSO (Based on OAuth2)</h4><h3 id="Account-driven-enrolment-process"><a href="#Account-driven-enrolment-process" class="headerlink" title="Account-driven enrolment process"></a>Account-driven enrolment process</h3><h4 id="Simple-Authentication-1"><a href="#Simple-Authentication-1" class="headerlink" title="Simple Authentication"></a>Simple Authentication</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">	Participant a as ADS</span><br><span class="line">	Participant b as Device</span><br><span class="line">	Participant c as MDM Server</span><br><span class="line">	Participant d as IDP</span><br><span class="line">	</span><br><span class="line">	autonumber</span><br><span class="line">	</span><br><span class="line">	Note over a,b: 1. Service discovery</span><br><span class="line">	b -&gt;&gt; a: https://&lt;domain&gt;/.well-known/com.apple.remotemanagement</span><br><span class="line">	a --&gt;&gt; b: MDM URL</span><br><span class="line">	</span><br><span class="line">	Note over b,c: 2. first enrollment attempt - fetch enrollment profile</span><br><span class="line">	b -&gt;&gt; c: POST /enroll</span><br><span class="line">  c --&gt;&gt; b: 401 response with new URL: https://xxx/authenticate</span><br><span class="line">  </span><br><span class="line">  Note over b,d: 3. Authentication flow</span><br><span class="line">  </span><br><span class="line">  b -&gt;&gt; c: GET /authenticate?user-identifier=xxx</span><br><span class="line">  c -&gt;&gt; d: auth request</span><br><span class="line">  d --&gt;&gt; c: auth successfully</span><br><span class="line">  c --&gt;&gt; b: 200 OK with HTML Login Page</span><br><span class="line">  b -&gt;&gt; c: POST /authenticate-results</span><br><span class="line">  c --&gt;&gt; b: 308 permanent Redirect - with token</span><br><span class="line">  </span><br><span class="line">  Note over b,c : 4. second enrollment attempt - fetch enrollment profile</span><br><span class="line">  b -&gt;&gt; c: POST /enroll with token</span><br><span class="line">  c --&gt;&gt; b: 200 with enrollment profile</span><br><span class="line">  </span><br><span class="line">  Note left of b: 4. Enroll</span><br><span class="line">  b -&gt;&gt; b: Enroll</span><br><span class="line">  </span><br><span class="line">  Note over b,c : 5. regular checkin</span><br><span class="line">  b -&gt;&gt; c: MDM Checkin request</span><br><span class="line">  </span><br></pre></td></tr></table></figure>

<h5 id="First-enrollment-attempt"><a href="#First-enrollment-attempt" class="headerlink" title="First enrollment attempt"></a>First enrollment attempt</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;&lt;&lt;&lt; Request</span><br><span class="line">POST /enroll/byod HTTP/1.1</span><br><span class="line">Host: mdmserver.example.com</span><br><span class="line">Content-Type: application/pkcs7-signature</span><br><span class="line">Content-Length: 327</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">plist</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//Apple//DTD PLIST 1.0//EN&quot;</span> <span class="string">&quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>LANGUAGE<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>en-US<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>PRODUCT<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>iPhone10,2<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>VERSION<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>19A240<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;&gt;&gt; Response</span><br><span class="line">HTTP/1.1 401 Unauthorized</span><br><span class="line">Content-Length: 0</span><br><span class="line">WWW-Authenticate: Bearer method=&quot;apple-as-web&quot;, url=&quot;https://mdmserver.example.com/authenticate&quot;</span><br></pre></td></tr></table></figure>

<h5 id="Authentication-flow"><a href="#Authentication-flow" class="headerlink" title="Authentication flow"></a>Authentication flow</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;&lt;&lt;&lt; Request</span><br><span class="line">GET /authenticate?user-identifier=user01@example.com HTTP/1.1</span><br><span class="line">Host: mdmserver.example.com</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;&gt;&gt; Response</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Type: text/html; charset=&quot;utf-8&quot;</span><br><span class="line">Content-Length: 17643</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">…</span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;&lt;&lt;&lt; Request</span><br><span class="line">POST /authenticate-results HTTP/1.1</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundarySaBDj3Bd7BeKC1s2</span><br><span class="line">Content-Length: 236</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">------WebKitFormBoundarySaBDj3Bd7BeKC1s2</span><br><span class="line">Content-Disposition: form-data; name=&quot;username&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">user01</span><br><span class="line">------WebKitFormBoundarySaBDj3Bd7BeKC1s2</span><br><span class="line">Content-Disposition: form-data; name=&quot;password&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">secret</span><br><span class="line">------WebKitFormBoundarySaBDj3Bd7BeKC1s2--</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;&gt;&gt; Response</span><br><span class="line">HTTP/1.1 308 Permanent Redirect</span><br><span class="line">Content-Length: 0</span><br><span class="line">Location: apple-remotemanagement-user-login://authentication-results?access-token=dXNlci1pZGVudGl0eQ</span><br></pre></td></tr></table></figure>

<h5 id="Second-enrollment-attempt"><a href="#Second-enrollment-attempt" class="headerlink" title="Second enrollment attempt"></a>Second enrollment attempt</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;&lt;&lt;&lt; Request</span><br><span class="line">POST /enroll/byod HTTP/1.1</span><br><span class="line">Host: mdmserver.example.com</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 326</span><br><span class="line">Authorization: Bearer dXNlci1pZGVudGl0eQ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">plist</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//Apple//DTD PLIST 1.0//EN&quot;</span> <span class="string">&quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>LANGUAGE<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>en-US<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>PRODUCT<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>iPhone10,2<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>VERSION<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>19A240<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;&gt;&gt; Response</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Type: application/x-apple-aspen-config</span><br><span class="line">Content-Length: 6785</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">plist</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//Apple//DTD PLIST 1.0//EN&quot;</span> <span class="string">&quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>PayloadType<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>Configuration<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">   …</span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>PayloadContent<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>PayloadType<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>com.apple.security.scep<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            …</span><br><span class="line">        <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>PayloadType<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>com.apple.mdm<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            …</span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>AssignedManagedAppleID<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>user01@appleid.example.com<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>EnrollmentMode<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>BYOD<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br></pre></td></tr></table></figure>





<h4 id="OAuth2-Authentication-1"><a href="#OAuth2-Authentication-1" class="headerlink" title="OAuth2 Authentication"></a>OAuth2 Authentication</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">	Participant a as ADS</span><br><span class="line">	Participant b as Device</span><br><span class="line">	Participant c as MDM Server</span><br><span class="line">	Participant d as OAuth2 IDP</span><br><span class="line">	</span><br><span class="line">	autonumber</span><br><span class="line">	</span><br><span class="line">	Note over a,b: 1. Service discovery</span><br><span class="line">	b -&gt;&gt; a: https://&lt;domain&gt;/.well-known/com.apple.remotemanagement</span><br><span class="line">	a --&gt;&gt; b: MDM URL</span><br><span class="line">	</span><br><span class="line">	Note over b,c: 2. first enrollment attempt - fetch enrollment profile</span><br><span class="line">	b -&gt;&gt; c: POST /enroll</span><br><span class="line">  c --&gt;&gt; b: 401 response with URL</span><br><span class="line">  </span><br><span class="line">  Note over b,d: 3. Authentication flow</span><br><span class="line">  b -&gt;&gt; c: GET /oauth2/authorization</span><br><span class="line">  c -&gt;&gt; d: auth request</span><br><span class="line">  d --&gt;&gt; c: auth successfully</span><br><span class="line">  c --&gt;&gt; b: 200 OK</span><br><span class="line">  b -&gt;&gt; c: POST /oauth2/results </span><br><span class="line">  c --&gt;&gt; b: 308 permanent Redirect - with code</span><br><span class="line">  </span><br><span class="line">  Note over b,d: 4. Token request and response</span><br><span class="line">  b -&gt;&gt; d: POST /oauth2/token with code</span><br><span class="line">  d --&gt;&gt; b: 200 OK with access_token</span><br><span class="line">  </span><br><span class="line">  Note over b,c : 5. second enrollment attempt - fetch enrollment profile</span><br><span class="line">  b -&gt;&gt; c: POST /enroll with access_token</span><br><span class="line">  c --&gt;&gt; b: 200 with enrollment profile</span><br><span class="line">  </span><br><span class="line">  Note left of b: 4. Enroll</span><br><span class="line">  b -&gt;&gt; b: Enroll</span><br><span class="line">  </span><br><span class="line">  Note over b,c : 5. regular checkin</span><br><span class="line">  b -&gt;&gt; c: MDM Checkin request</span><br><span class="line">  </span><br></pre></td></tr></table></figure>

<h5 id="Authentication-flow-1"><a href="#Authentication-flow-1" class="headerlink" title="Authentication flow"></a>Authentication flow</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;&lt;&lt;&lt; Request</span><br><span class="line">GET /oauth2/authorization?response_type=code</span><br><span class="line">    &amp;client_id=03FDDE96-FDAB-45EF-A589-0E29C026E824</span><br><span class="line">    &amp;redirect_uri=apple-remotemanagement-user-login:/oauth2/redirection</span><br><span class="line">    &amp;state=340B948D-A84A-45A3-AC45-C93195124B00</span><br><span class="line">    &amp;login_hint=useroauth@example.com HTTP/1.1</span><br><span class="line">Host: mdmserver.example.com</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;&gt;&gt; Response</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Type: text/html; charset=&quot;utf-8&quot;</span><br><span class="line">Content-Length: 17643</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">…</span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;&lt;&lt;&lt; Request</span><br><span class="line">POST /oauth2/results HTTP/1.1</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundarySaBDj3Bd7BeKC1s2</span><br><span class="line">Content-Length: 236</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">------WebKitFormBoundarySaBDj3Bd7BeKC1s2</span><br><span class="line">Content-Disposition: form-data; name=&quot;username&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">user01</span><br><span class="line">------WebKitFormBoundarySaBDj3Bd7BeKC1s2</span><br><span class="line">Content-Disposition: form-data; name=&quot;password&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">secret</span><br><span class="line">------WebKitFormBoundarySaBDj3Bd7BeKC1s2--</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;&gt;&gt; Response</span><br><span class="line">HTTP/1.1 308 Permanent Redirect</span><br><span class="line">Content-Length: 0</span><br><span class="line">Location: apple-remotemanagement-user-login:/oauth2/redirection</span><br><span class="line">    ?code=Dek1jUOEcaIPGhbDrCTm9GDV5qT1sb&amp;state=340B948D-A84A-45A3-AC45-C93195124B00</span><br></pre></td></tr></table></figure>

<h5 id="Token-request-and-response"><a href="#Token-request-and-response" class="headerlink" title="Token request and response"></a>Token request and response</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;&lt;&lt;&lt; Request</span><br><span class="line">POST /oauth2/token HTTP/1.1</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 195</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">grant_type=authorization_code</span><br><span class="line">    &amp;code=Dek1jUOEcaIPGhbDrCTm9GDV5qT1sb</span><br><span class="line">    &amp;redirect_uri=apple-remotemanagement-user-login:/oauth2/redirection</span><br><span class="line">    &amp;client_id=03FDDE96-FDAB-45EF-A589-0E29C026E824</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;&gt;&gt; Response</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Length: 245</span><br><span class="line">Content-Type: application/json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;token_type&quot;: &quot;Bearer&quot;,</span><br><span class="line">    &quot;scope&quot;: &quot;MDM&quot;,</span><br><span class="line">    &quot;access_token&quot;: &quot;dXNlcm9hdXRo.MjZkNTkzZmMtNzk4MC00OWFkLTllZTAtZTA2NzhmNmVhNzg5&quot;,</span><br><span class="line">    &quot;expires_in&quot;: 3600,</span><br><span class="line">    &quot;refresh_token&quot;: &quot;dXNlcm9hdXRo.NzhiNWU0NWQtMDVlZS00MTAwLThhMjEtZDA5MzI2N2RjNzUx&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h3><ol>
<li><p>Make the auth process works with CEM AD configuration.</p>
</li>
<li><p>Configure ADS Service</p>
</li>
<li><p>Configure federated auth with AAD </p>
<ul>
<li>Need more information from Apple before we can start this</li>
</ul>
</li>
<li><p>Customize the UE enrollment UI</p>
</li>
<li><p>Add new policy which account-driven UE newly supports</p>
</li>
<li><p>Dynamically disable commands that do not apply to UE (wipe device, etc.)</p>
</li>
<li><p>How to make sure that there won’t be duplicate device info if one device enroll to CEM many times?</p>
<ul>
<li>How to identify the device</li>
</ul>
</li>
</ol>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul>
<li>Developer Doc: <a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/devicemanagement/user-enrollment">https://developer.apple.com/documentation/devicemanagement/user-enrollment</a></li>
<li>Account-driven enrolment methods with Apple devices: <a target="_blank" rel="noopener" href="https://support.apple.com/en-sg/guide/deployment/dep4d9e9cd26/1/web/1.0">https://support.apple.com/en-sg/guide/deployment/dep4d9e9cd26/1/web/1.0</a></li>
<li>User Enrolment MDM information: <a target="_blank" rel="noopener" href="https://support.apple.com/en-in/guide/deployment/dep6ae3f1d5a/1/web/1.0">https://support.apple.com/en-in/guide/deployment/dep6ae3f1d5a/1/web/1.0</a><ul>
<li>MDM payloads for User Enrolment</li>
<li>MDM commands for User Enrolment</li>
<li>MDM queries for User Enrolment</li>
</ul>
</li>
</ul>
<h1 id="Reference-1"><a href="#Reference-1" class="headerlink" title="Reference"></a>Reference</h1><p>Apple资料是这一个 <a target="_blank" rel="noopener" href="https://support.apple.com/en-hk/guide/deployment/dep23db2037d/web">https://support.apple.com/en-hk/guide/deployment/dep23db2037d/web</a></p>
<p>内部资料都在这个comment里面 - <a target="_blank" rel="noopener" href="https://issues.citrite.net/browse/CXM-112317">https://issues.citrite.net/browse/CXM-112317</a></p>
<p>这个是epic - <a target="_blank" rel="noopener" href="https://issues.citrite.net/browse/CXM-112218">https://issues.citrite.net/browse/CXM-112218</a></p>
<p><a target="_blank" rel="noopener" href="https://support.apple.com/en-in/121158">What’s new for enterprise in iOS 18</a></p>
<h1 id="Apple-Officials"><a href="#Apple-Officials" class="headerlink" title="Apple Officials"></a>Apple Officials</h1><p>Apple Support:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://support.apple.com/en-sg/guide/deployment/dep4d9e9cd26/1/web/1.0">Account-driven enrolment methods with Apple devices</a></li>
<li><a target="_blank" rel="noopener" href="https://support.apple.com/en-in/guide/deployment/dep23db2037d/1/web/1.0#dep6c59a3144">User Enrolment and MDM</a></li>
<li><a target="_blank" rel="noopener" href="https://support.apple.com/en-sg/guide/deployment/dep08f54fcf6/web">Enrolment methods for Apple devices</a></li>
</ul>
<p>Apple Developer:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/devicemanagement/user-enrollment">User Enrollment</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/Secure%20Mail%20and%20Secure%20Web/two-way-sync/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/11/uncategorized/officeDocuments/officeDocs/Secure%20Mail%20and%20Secure%20Web/two-way-sync/" class="post-title-link" itemprop="url">Sync with Local Contact</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2025-11-26 00:00:00 / Modified: 15:43:52" itemprop="dateCreated datePublished" datetime="2025-11-26T00:00:00+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Sync-with-Local-Contact"><a href="#Sync-with-Local-Contact" class="headerlink" title="Sync with Local Contact"></a>Sync with Local Contact</h1><blockquote>
<p>Import contacts from the native app to SM </p>
</blockquote>
<h2 id="Import-Time"><a href="#Import-Time" class="headerlink" title="Import Time"></a>Import Time</h2><p><strong>ContactFolderViewController</strong></p>
<ul>
<li>Every time the app will enter foreground (<code>UIApplicationWillEnterForegroundNotification</code>)</li>
<li>viewDidLoad - every time other view switch to ContactFolderViewController</li>
</ul>
<h2 id="Code-Change"><a href="#Code-Change" class="headerlink" title="Code Change"></a>Code Change</h2><ul>
<li>New-added class -<code>ContactImportOperation.m</code> : Handle async import local contact to SM contact</li>
</ul>
<h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><ul>
<li><p><input disabled="" type="checkbox"> 
Sync local contact detailed information to SM contact(Only sync contact name currently)</p>
</li>
<li><p><input disabled="" type="checkbox"> 
ContactFolderViewController will flink if returning from background into foreground (-[ContactImportOperation parseAllContacts])</p>
<blockquote>
<p>It’s by design. If the contact data gonna updates, it will refresh the viewcontroll cells. We could reduce the update times if no changes added.</p>
</blockquote>
</li>
</ul>
<h2 id="Issues"><a href="#Issues" class="headerlink" title="Issues"></a>Issues</h2><ul>
<li><p>If there are 2 contact accounts in the device,  sync contact to local will failed, throws error - <code>CNErrorCodeParentContainerNotWritable</code></p>
<p>![image-20250519104334506](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20250519104334506.png)</p>
</li>
<li><p>Contact view controller has empty data, need to uncomment below code</p>
</li>
<li><p>![image-20250805145348639](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20250805145348639.png)</p>
</li>
</ul>
<h1 id="Sync-contacts"><a href="#Sync-contacts" class="headerlink" title="Sync contacts"></a>Sync contacts</h1><blockquote>
<p>Sync contacts with the Exchange server.</p>
</blockquote>
<ul>
<li><input disabled="" type="checkbox"> Turn off Sync: disable sync request to exchange server</li>
</ul>
<h1 id="Multi-Accounts"><a href="#Multi-Accounts" class="headerlink" title="Multi Accounts"></a>Multi Accounts</h1><h3 id="Export"><a href="#Export" class="headerlink" title="Export"></a>Export</h3><p>Export contact</p>
<ul>
<li><input disabled="" type="checkbox"> Create corresponding local contact  folder for the account</li>
<li><input disabled="" type="checkbox"> Update corresponding local contact folder</li>
<li><input disabled="" type="checkbox"> Delete corresponding local contact  folder</li>
</ul>
<p><strong>Contact Update</strong></p>
<p>Save Button on each contact will only sync one contact - increment updates</p>
<p>Switch on the sync local contact will sync all contacts - full updates</p>
<p><strong>Export - Code Change</strong></p>
<ul>
<li>AddOrCreateOperation(need accountid) -&gt; ExportOperation(will pass securemail_group_name from AddOrCreateOperation)</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">asyncStartCreateOrCopySecureMailGroupForServiceContext</span><br></pre></td></tr></table></figure>

<ul>
<li>RemoveContactOpertaion -&gt; DeleteSecureMailContactGroupOperation</li>
</ul>
<p><strong>@”16B4F2B6-9733-4836-8C92-DA36EDAD2CF2”</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[WMExchangeAccount findWithAccountId:self.accountId managedObjectContext:self.managedObjectContext] displayName]</span><br></pre></td></tr></table></figure>









<h3 id="Import"><a href="#Import" class="headerlink" title="Import"></a>Import</h3><p>Import contact</p>
<ul>
<li><input disabled="" type="checkbox"> Import local contact changes to target contact folder.</li>
</ul>
<h1 id="Import-Contacts"><a href="#Import-Contacts" class="headerlink" title="Import Contacts"></a>Import Contacts</h1><p>Import Contact will compare and  decide to overrite, do not need the option like below as it will cause local contact has more contacts if no delete before the add</p>
<ul>
<li>ContactExportOptionDeleteSecureMailGroupBeforeExporting</li>
</ul>
<p>Validate import contact failure cases</p>
<h1 id="MOC-and-CNContact"><a href="#MOC-and-CNContact" class="headerlink" title="MOC and CNContact"></a>MOC and CNContact</h1><p>MOC(NSManagedObjectContext):</p>
<ul>
<li>Core Data entity</li>
<li>Persisted in the local DB</li>
<li>Used for WorxMail Contact Management</li>
</ul>
<p>CNContact:</p>
<ul>
<li>iOS system contact object</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">    A[iOS 通讯录] --&gt;|获取联系人数据| B[CNContact]</span><br><span class="line">    B --&gt;|数据提取| C&#123;字段映射&#125;</span><br><span class="line">    C --&gt;|转换| D[ManagedObjectContactOrGroup]</span><br><span class="line">    D --&gt;|导入| E[WorxMail 联系人]</span><br><span class="line">    </span><br><span class="line">    C --&gt;|姓名| D1[Name]</span><br><span class="line">    C --&gt;|电话| D2[Phone]</span><br><span class="line">    C --&gt;|邮箱| D3[Email]</span><br><span class="line">    C --&gt;|群组| D4[Group]</span><br><span class="line">    </span><br><span class="line">    D1 --&gt; D</span><br><span class="line">    D2 --&gt; D</span><br><span class="line">    D3 --&gt; D</span><br><span class="line">    D4 --&gt; D</span><br></pre></td></tr></table></figure>





<h1 id="Pull-Request"><a href="#Pull-Request" class="headerlink" title="Pull Request"></a>Pull Request</h1><ul>
<li><p><input checked="" disabled="" type="checkbox"> 
Remove comments -  <code>ExchangeMail/models/ManagedObjectContactOrGroup/ManagedObjectContactOrGroup.m</code></p>
</li>
<li><p><input checked="" disabled="" type="checkbox"> 
Revert code change:</p>
</li>
<li><p><code>ExchangeMail/Activity/ContactSharingActivityViewController.h/m</code></p>
</li>
<li><p><code>ExchangeMail/AppDelegate/AppDelegate.m</code></p>
</li>
<li><p><code>ExchangeMail/models/WMExchangeAccount.h/m</code></p>
</li>
<li><p><code>ExchangeMail/TabBarSupport/ContactFolderEditTabBarController.m</code></p>
</li>
<li><p><code>ExchangeMail/viewcontrollers/SettingsViewController/SettingsViewController.m</code></p>
</li>
<li><p><code>SecureMailNotificationExtension/SocksServer/INSOCKSConnection.m</code></p>
</li>
<li><p><input disabled="" type="checkbox"> 
Check the code change:</p>
</li>
<li><p><code>ExchangeMail/Activity/ExportToContactsActivity.m</code></p>
</li>
<li><p><input disabled="" type="checkbox"> 
delete local contact if mail is removed</p>
</li>
<li><p><input disabled="" type="checkbox"> 
add member and delete member to group</p>
</li>
</ul>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>SecureMail currently supports exporting contacts to a native contact group named <code>Secure Mail</code>. This PR adds implementation for <strong>contact import functionality</strong> and <strong>multi-account support</strong> to enable two-way contact synchronization.</p>
<h2 id="Code-Changes"><a href="#Code-Changes" class="headerlink" title="Code Changes"></a>Code Changes</h2><h3 id="Feature-Flag"><a href="#Feature-Flag" class="headerlink" title="Feature Flag"></a>Feature Flag</h3><ul>
<li>Created feature flag: <code>cxm-111320-two-way-sync-support-for-contacts</code></li>
</ul>
<h3 id="Contact-Import-Implementation"><a href="#Contact-Import-Implementation" class="headerlink" title="Contact Import Implementation"></a>Contact Import Implementation</h3><ul>
<li><strong>New class</strong>: <code>ContactImportOperation</code> - handles contact import scenarios</li>
<li><strong>New contact operation dispositions</strong>:<ul>
<li><code>ContactOperationDispositionImport</code></li>
<li><code>ContactOperationDispositionRemoveContactOnImportFail</code></li>
</ul>
</li>
<li><strong>Handle MDX policy setting</strong> : <code>ExportableContactFields</code></li>
<li><strong>Import triggers</strong> (in <code>ContactFolderViewController.m</code>):<ul>
<li><code>UIApplicationWillEnterForegroundNotification</code></li>
<li><code>viewDidLoad</code></li>
</ul>
</li>
</ul>
<h3 id="Multi-Account-Support"><a href="#Multi-Account-Support" class="headerlink" title="Multi-Account Support"></a>Multi-Account Support</h3><ul>
<li><strong>Enhanced contact export functions</strong>: Added <code>accountId</code> parameter to all contact sync methods</li>
<li><strong>Account-specific group naming</strong>: Native contact groups now follow the pattern <code>Secure Mail_${displayName}</code> for each account</li>
<li><strong>Special Cleanup logic</strong>: Contact groups are removed when feature flag is disabled, including:<ul>
<li>Account-specific groups: <code>Secure Mail_${displayName}</code></li>
<li>Legacy hardcoded group: <code>Secure Mail</code></li>
</ul>
</li>
</ul>
<h2 id="Testing"><a href="#Testing" class="headerlink" title="Testing"></a>Testing</h2><ul>
<li>Development testing for overall functionality is currently in progress</li>
<li><strong>Demo video</strong>:<a target="_blank" rel="noopener" href="https://drive.google.com/drive/u/0/folders/1mJBXYaEEkscIPSMf9xOTSPUbk3l3gcEq">https://drive.google.com/drive/u/0/folders/1mJBXYaEEkscIPSMf9xOTSPUbk3l3gcEq</a></li>
</ul>
<h1 id="GDMF-Cert-Update"><a href="#GDMF-Cert-Update" class="headerlink" title="GDMF Cert Update"></a>GDMF Cert Update</h1><h2 id="Old"><a href="#Old" class="headerlink" title="Old"></a>Old</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">MIIEnTCCA4WgAwIBAgIQCxtwox/Vy8pCg6I+cZvdPzANBgkqhkiG9w0BAQsFADBt</span><br><span class="line">MScwJQYDVQQDDB5BcHBsZSBTZXJ2ZXIgQXV0aGVudGljYXRpb24gQ0ExIDAeBgNV</span><br><span class="line">BAsMF0NlcnRpZmljYXRpb24gQXV0aG9yaXR5MRMwEQYDVQQKDApBcHBsZSBJbmMu</span><br><span class="line">MQswCQYDVQQGEwJVUzAeFw0yNDA4MTAwMjEwMjZaFw0yNTA5MDkwMjEwMjVaMFAx</span><br><span class="line">FzAVBgNVBAMMDmdkbWYuYXBwbGUuY29tMRMwEQYDVQQKDApBcHBsZSBJbmMuMRMw</span><br><span class="line">EQYDVQQIDApDYWxpZm9ybmlhMQswCQYDVQQGEwJVUzCCASIwDQYJKoZIhvcNAQEB</span><br><span class="line">BQADggEPADCCAQoCggEBAN8jV9D67Wm4mnUzcLNT6P8NaDd71dHyTc7476Dp433E</span><br><span class="line">tmM9PJbI/4wqovJ3BSUuTf6cCNGFPR5oOxp7uCiYAwlQATNEnaTBxZSBx1n+llNM</span><br><span class="line">JI+iykFSXUMqvhlRkpzItsfuJ0RxrIPWmtKT88Fg5qJxThp0j9RMdjfVLgzk55Ex</span><br><span class="line">XdrmybaZ4lIDByE6wL//Q8t8sdKj08G276HtEeli1lJuDXSAEmzy2YXSg7zhLbsl</span><br><span class="line">95AUzVVix1t5aRkBe2x1ODZ/6KuKgx7c/RYTaVQ0SMozzpsdyGdKNl581rWB20Nx</span><br><span class="line">I/diO8JyHNi5gLQSUSzZhF0hMKanP/y8etwAURLDga0CAwEAAaOCAVQwggFQMAwG</span><br><span class="line">A1UdEwEB/wQCMAAwHwYDVR0jBBgwFoAULMVtUt0x74zsCIHt39zKQwBFAdAwSgYI</span><br><span class="line">KwYBBQUHAQEEPjA8MDoGCCsGAQUFBzABhi5odHRwOi8vb2NzcC5hcHBsZS5jb20v</span><br><span class="line">b2NzcDAzLWFwcGxlc2VydmVyYXV0aDEyMC4GA1UdEQQnMCWCE2dkbWYtYWRvcy5h</span><br><span class="line">cHBsZS5jb22CDmdkbWYuYXBwbGUuY29tMBMGA1UdJQQMMAoGCCsGAQUFBwMBMDwG</span><br><span class="line">A1UdHwQ1MDMwMaAvoC2GK2h0dHA6Ly9jcmwuYXBwbGUuY29tL2FwcGxlc2VydmVy</span><br><span class="line">YXV0aGNhMS5jcmwwHQYDVR0OBBYEFJVHlJzS1C/p5iwsDCUPscrvmYnVMA4GA1Ud</span><br><span class="line">DwEB/wQEAwIFoDAQBgoqhkiG92NkBhsQBAIFADAPBgkqhkiG92NkBlYEAgUAMA0G</span><br><span class="line">CSqGSIb3DQEBCwUAA4IBAQBHthUnfW2SiURlpCeO/HcX6eI4f5+beS93w488qNdT</span><br><span class="line">pjeqlSsOs4WJu0PlgiEkle4XTUXxaqGMbORoufkyovA/d/4H4Idn4Is7PAnvlS5g</span><br><span class="line">ObBZJK+hDUPy2TL4Yr0gyIgfNptQ9NkHplNr2CrAB2mADe4QsHUBV3lqUbc6wvr0</span><br><span class="line">5a+7qUuCGQ1Yb/zQl0Q06MEHtYnCwy+i2ZU5ZlVt/XAwSLES9SFdKH3gah0xVUXR</span><br><span class="line">740AjNdZuiJjuaU0dLzHioq9lhRC36aZrUPu70GExWWw9uT/trgcrYWtX/7+kmw6</span><br><span class="line">AAE2bRYjvDAYoCuDaz13nQJqmoDdBFF4m+UDa3GgBROG</span><br><span class="line">-----END CERTIFICATE-----</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="new"><a href="#new" class="headerlink" title="new"></a>new</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">MIIEnTCCA4WgAwIBAgIQRGTHFw9vtptjMtXWMrJlXzANBgkqhkiG9w0BAQsFADBt</span><br><span class="line">MScwJQYDVQQDDB5BcHBsZSBTZXJ2ZXIgQXV0aGVudGljYXRpb24gQ0ExIDAeBgNV</span><br><span class="line">BAsMF0NlcnRpZmljYXRpb24gQXV0aG9yaXR5MRMwEQYDVQQKDApBcHBsZSBJbmMu</span><br><span class="line">MQswCQYDVQQGEwJVUzAeFw0yNTA4MDUyMDU5MzJaFw0yNjA5MDIxOTU5NTlaMFAx</span><br><span class="line">FzAVBgNVBAMMDmdkbWYuYXBwbGUuY29tMRMwEQYDVQQKDApBcHBsZSBJbmMuMRMw</span><br><span class="line">EQYDVQQIDApDYWxpZm9ybmlhMQswCQYDVQQGEwJVUzCCASIwDQYJKoZIhvcNAQEB</span><br><span class="line">BQADggEPADCCAQoCggEBAMoz/6FK4vN5tcaYLgAqzk/O2WNCcZWOvOC3O8CyAFvF</span><br><span class="line">zUX7BGX7Ft4nBGKPvw3ngsgUjM1kQMox2AaGvPJFQxBPFcAokPBMs2OWWRIMozxv</span><br><span class="line">II09WMNvnAg/KHrLY9Qp5n6bpcjojMP2kxDhiDBp/jeq4G+UG31/pL/arZiQJfFY</span><br><span class="line">Kfkk9kBCjNT4XwQxSFWZolH11B016VjxomIkEESOek+q5kHEe5tRmmrL2VKf04Lx</span><br><span class="line">vvqHzUm+yyAiW8RbjAdNM50jvAmE4zg2rDj6O/0yHsbU+ZFKoUVzKFSU0vI7zNZ1</span><br><span class="line">uzYm8mw5TAO2NHVwjyS2NiZEi5bKu1IMBeBg7BkVrcMCAwEAAaOCAVQwggFQMAwG</span><br><span class="line">A1UdEwEB/wQCMAAwHwYDVR0jBBgwFoAULMVtUt0x74zsCIHt39zKQwBFAdAwSgYI</span><br><span class="line">KwYBBQUHAQEEPjA8MDoGCCsGAQUFBzABhi5odHRwOi8vb2NzcC5hcHBsZS5jb20v</span><br><span class="line">b2NzcDAzLWFwcGxlc2VydmVyYXV0aDEyMC4GA1UdEQQnMCWCE2dkbWYtYWRvcy5h</span><br><span class="line">cHBsZS5jb22CDmdkbWYuYXBwbGUuY29tMBMGA1UdJQQMMAoGCCsGAQUFBwMBMDwG</span><br><span class="line">A1UdHwQ1MDMwMaAvoC2GK2h0dHA6Ly9jcmwuYXBwbGUuY29tL2FwcGxlc2VydmVy</span><br><span class="line">YXV0aGNhMS5jcmwwHQYDVR0OBBYEFC7POVlZpOX6KHWI4hlO4HxvAGFaMA4GA1Ud</span><br><span class="line">DwEB/wQEAwIFoDAQBgoqhkiG92NkBhsQBAIFADAPBgkqhkiG92NkBlYEAgUAMA0G</span><br><span class="line">CSqGSIb3DQEBCwUAA4IBAQCXU/snqK9MZ9zHHLSyo13eNrbuypmfGIxP1SbfT6OL</span><br><span class="line">j4jakkxaaj44BsBWZ2+wlJCCbLPFt/OUR80KmJphUzZV/0R9ZdFs0dlDcmIQ0Msb</span><br><span class="line">0nXqvIK7h/fpezcZdkY1wZgoPHyReHvixZQKN1fDBnyoxmC8Tg0z5S44+UcGeq9B</span><br><span class="line">q8IWxiRjJNsRpz8867RWHBZfC0uJjZzsm4AsBgJn1SD3G0GmZbuhrFg/QidNFRoU</span><br><span class="line">2xYIGjoZJSA1w4pIbuDXuytnoRZ8PZuYbYoebIMNSQ1IEkxm78J5wDRZikvHAYji</span><br><span class="line">2CRQ6+juNEm3og68+i58nU8X91+wqA8+Kbeq8vWkELnW</span><br><span class="line">-----END CERTIFICATE-----</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Dev-Test"><a href="#Dev-Test" class="headerlink" title="Dev Test"></a>Dev Test</h1><ol>
<li>Remove contact from list if the contact is from another group, it will delete the contact in another group either.</li>
</ol>
<p>New Contact</p>
<p>Add from list  - Junkang Du</p>
<p>Remove from list - Test</p>
<p>Delete Contact - Znzn</p>
<h1 id="Emtpy-Contact-Issue"><a href="#Emtpy-Contact-Issue" class="headerlink" title="Emtpy Contact Issue"></a>Emtpy Contact Issue</h1><ol>
<li>First time sync: will trigger <code>CNChangeHistoryDropEverythingEvent</code> and then bunches of <code>CNChangeHistoryAddContactEvent</code> pop up, at last the </li>
<li>Not first time sync: <ul>
<li><code>CNChangeHistoryUpdateGroupEvent</code> : fetch the zero count contact from native.</li>
</ul>
</li>
</ol>
<p>From several testing of race condition between SM and iCloud, we could know that </p>
<ul>
<li>Even if corresponding folder’s contacts are cleared, but the contacts are still under the <code>All</code> folder</li>
<li>Hard to recognize the scenario and disable the import behaviour.</li>
</ul>
<p>From the test results, we could know that:</p>
<ul>
<li><strong>Contact Persistence</strong>: Even when contacts are removed from specific folders, they remain accessible in the “All” folder</li>
<li><strong>Detection Challenges</strong>: Difficult to programmatically distinguish between legitimate empty states and unintended contact clearing</li>
</ul>
<p>Proposed Solutions:</p>
<ol>
<li>Manual Operation</li>
</ol>
<ul>
<li>Enable users to manually import contacts from “All” folder to specific email folders (e.g., <code>user@domain.com</code>)</li>
</ul>
<ol start="2">
<li>User Confirmation Dialog</li>
</ol>
<ul>
<li><strong>Trigger Condition</strong>: When contact deletion triggered</li>
<li><strong>Action</strong>: Display confirmation dialog asking user whether to proceed with contact import&#x2F;clearing</li>
</ul>
<ol start="3">
<li>Manual Control Toggle</li>
</ol>
<ul>
<li>Add user setting to manually disable Exchange contact synchronization</li>
<li>Allow users to pause sync during troubleshooting</li>
</ul>
<ol start="4">
<li>Contact Data Backup</li>
</ol>
<ul>
<li>Implement automatic backup mechanism with timer-based intervals</li>
<li>Preserve contact data before major sync operations</li>
<li>Enable rollback capability if needed</li>
</ul>
<p>limitation：</p>
<ul>
<li><p>This feature may be affected by iCloud Contact synchronazation, leading to unexpected data loss. Consider disabling two-way sync to prevent concurrent modification conflicts.</p>
</li>
<li><p>Two-way contact synchronization between Secure Mail and local contacts may result in data loss when concurrent modifications occur with iCloud Contact synchronization. If issues occur, consider disabling two-way sync to prevent concurrent modification conflicts.</p>
</li>
<li><p>This feature may be affected by iCloud Contact synchronization, leading to unexpected data loss. If issues occur, consider disabling two-way sync to prevent concurrent modification conflicts.</p>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/7/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/9/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Supremes</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>

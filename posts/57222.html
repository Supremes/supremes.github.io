<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Objective-C 面向对象编程详解 | Supremes</title><meta name="keywords" content="Objective-C,iOS,面向对象,Category,Protocol"><meta name="author" content="Supremes"><meta name="copyright" content="Supremes"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Objective-C 面向对象编程详解"><meta name="application-name" content="Objective-C 面向对象编程详解"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#ffffff"><meta property="og:type" content="article"><meta property="og:title" content="Objective-C 面向对象编程详解"><meta property="og:url" content="https://supremes.github.io/posts/57222.html"><meta property="og:site_name" content="Supremes"><meta property="og:description" content="深入解析 Objective-C 的面向对象特性，包括 Category、Protocol、Extension 等核心概念，以及 UIViewController 和 UIApplication 的生命周期详解"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://supremes.github.io/imgs/avatar.jpg"><meta property="article:author" content="Supremes"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://supremes.github.io/imgs/avatar.jpg"><meta name="description" content="深入解析 Objective-C 的面向对象特性，包括 Category、Protocol、Extension 等核心概念，以及 UIViewController 和 UIApplication 的生命周期详解"><link rel="shortcut icon" href="/favicon/favicon.ico"><link rel="canonical" href="https://supremes.github.io/posts/57222.html"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: undefined,
  friends_vue_info: undefined,
  navMusic: false,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: Supremes","link":"链接: ","source":"来源: Supremes","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Supremes',
  title: 'Objective-C 面向对象编程详解',
  postAI: '',
  pageFillDescription: '面向对象, 1. Category（分类）, 特点：, 语法：, 应用场景：, 注意事项：, 2. Protocol（协议）, 特点：, 语法：, 应用场景：, 注意事项：, 3 Extension（类扩展）, 4  Dynamic Runtime（运行时动态性）, 5. Category vs Protocol vs 其他方案对比, 6. 总结与建议, NSURL, NSURLProtocol, WKURLSchemeHandler, NSURLSessionDelegate, UIViewController, 主要生命周期方法, 1. viewDidLoad, 2. viewWillAppear, 3. viewDidAppear, 4. viewWillDisappear, 5. viewDidDisappear, 6. viewDidUnload (iOS 6之前), 生命周期顺序, 最佳实践, UIApplication, UIViewController 和 UIApplication 的关系, 层次关系, 包含关系, 生命周期函数对应关系, UIApplication 生命周期方法（AppDelegate）, 1. applicationdidFinishLaunchingWithOptions, 2. applicationDidBecomeActive, 3. applicationWillResignActive, 4. applicationDidEnterBackground, 5. applicationWillEnterForeground, 6. applicationWillTerminate, 调用顺序示例, 应用启动, 应用进入后台, 应用回到前台, 实际应用建议面向对象分类是中用于扩展已有类功能的一种机制无需继承即可为类添加方法它的主要用途是增强类的功能或将类的实现分模块组织特点无需子类化可以在不修改原始类源码的情况下为类添加新的方法动态扩展在运行时动态地将方法添加到类中模块化开发可以将类的功能拆分成多个文件便于团队协作或代码管理限制不能添加实例变量只能添加方法如果中定义的方法与原始类或另一个中的方法同名会覆盖原始方法可能导致不可预测的行为不能直接访问原始类的私有方法或变量语法原类名声明新方法原类名实现新方法应用场景扩展系统类例如为添加一个自定义方法使用输出代码组织将大类的实现分成多个增强可读性和维护性例如可以按功能分为和两个修复或增强功能在不修改第三方库的情况下为其类添加功能注意事项方法冲突如果多个或原始类定义了同名方法运行时会选择其中一个不可预测应避免命名冲突调试困难的方法覆盖可能导致调试复杂最佳实践为避免冲突建议在方法名中加入前缀如协议是中定义一组方法规范的机制类似于接口它用于声明一组方法供类实现以保证类具有特定行为特点抽象性仅定义方法签名不提供实现多类共享多个类可以实现同一个实现代码共享或行为一致性可选与必须方法可以标记为默认必须实现或可选实现类型检查编译器可以检查类是否遵循某个语法必须实现的方法可选实现的方法应用场景委托模式最常见的用途例如和接口定义定义一组标准接口供不同类实现例如多个视图控制器实现同一个数据处理协议类型安全通过限制对象类型确保对象支持特定方法编译器确保方法存在注意事项协议通常会继承协议以确保对象支持基本方法如动态检查使用和检查对象是否遵循协议或实现某方法类扩展定义类扩展是匿名的通常用于在类的实现文件中声明私有方法或属性特点可以在文件中声明私有方法或属性可以添加实例变量与不同仅在当前类实现文件可见外部无法访问语法用途隐藏实现细节声明私有接口或为只读属性添加私有读写支持运行时动态性的运行时系统提供了强大的动态特性支持以下功能方法交换在运行时替换方法实现常用于调试或修改系统类行为动态添加方法通过动态为类添加方法关联对象通过为添加伪属性示例添加关联对象用途增强功能实现动态行为修改其他方案对比特性机制用途扩展类方法定义接口规范声明私有方法属性回调和函数式编程添加实例变量否可通过关联对象实现否是否代码复用高直接扩展类中需实现低仅限当前类高独立逻辑动态性高运行时添加方法中运行时检查方法低编译时确定高捕获上下文典型场景系统类扩展代码模块化委托模式接口定义私有接口属性扩展异步回调事件处理总结与建议适合快速扩展类功能特别是为系统类或第三方库添加方法但需注意方法冲突适合定义标准接口确保类行为一致广泛用于委托模式用于私有接口适合隐藏实现细节提供轻量级回调适合异步任务运行时动态性提供了强大的灵活性但需谨慎使用以避免复杂性根据具体需求选择合适的方案如果需要扩展现有类使用如果需要定义行为规范使用如果需要私有方法或属性使用如果需要动态或回调逻辑考虑或运行时特性如需更具体示例或深入探讨某一机制请告诉我拦截处理自定义非通过实现可以拦截和处理发起的特定如以外的自定义协议请求实现自定义的网络请求逻辑推荐的官方协议用来处理自定义的请求无法在中被拦截处理不支持使用来拦截请求到是官方推荐可信任的做法拦截的请求会被转发到并通过进行处理的生命周期函数介绍主要生命周期方法调用时机视图控制器的视图层次结构加载到内存中后调用用途进行一次性初始化如创建元素设置初始状态特点只调用一次调用时机视图即将显示前调用用途准备显示视图如刷新数据重置状态特点每次视图显示前都会调用调用时机视图已经显示后调用用途启动动画开始定时器注册通知等特点每次视图显示后都会调用调用时机视图即将消失前调用用途保存数据暂停操作验证输入等特点每次视图消失前都会调用调用时机视图已经消失后调用用途停止定时器取消网络请求清理资源等特点每次视图消失后都会调用之前调用时机内存不足时系统卸载视图用途清理视图相关资源特点后已废弃生命周期顺序创建显示中的视图销毁最佳实践创建设置委托初始化数据源刷新界面数据重置状态开始网络请求启动动画保存用户输入暂停活动清理资源停止后台任务和的关系层次关系应用程序的单例对象管理整个应用的生命周期管理单个视图的控制器是管理的视图层次结构的一部分包含关系生命周期函数对应关系生命周期方法对应在的之前调用关系应用启动完成创建和对应当前可见的和关系应用变为活跃状态视图控制器开始显示对应当前可见的关系应用即将失去焦点视图即将不可交互对应当前可见的关系应用进入后台视图完全不可见对应即将显示的的关系应用即将回到前台视图即将重新显示对应所有的清理工作关系应用即将终止所有视图控制器被销毁调用顺序示例应用启动应用进入后台应用回到前台实际应用建议级别处理全局状态推送通知应用级别的数据保存级别处理界面相关的逻辑用户交互视图状态管理协调使用在中可以通知当前的应用状态变化',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-11-30 14:02:36',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 8.1.1"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">Supremes</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fas fa-home faa-tada"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><i class="fas fa-archive faa-tada"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fas fa-folder-open faa-tada"></i><span> 分类</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/database/"><i class="fas fa-database faa-tada"></i><span> 数据库</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/message-queue/"><i class="fas fa-envelope faa-tada"></i><span> 消息队列</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/Spring/"><i class="fas fa-leaf faa-tada"></i><span> Spring</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/security/"><i class="fas fa-shield-alt faa-tada"></i><span> 网络安全</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/AI/"><i class="fas fa-robot faa-tada"></i><span> AI</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/mobile/"><i class="fas fa-mobile-alt faa-tada"></i><span> 移动开发</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/tools/"><i class="fas fa-tools faa-tada"></i><span> 工具效率</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/diary/"><i class="fas fa-book faa-tada"></i><span> 日记</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fas fa-list faa-tada"></i><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/about_me"><i class="fas fa-user faa-tada"></i><span> 关于我</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/my_notes"><i class="fas fa-note-sticky faa-tada"></i><span> 备忘录</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/ACME/" style="font-size: 1.05rem;">ACME<sup>1</sup></a><a href="/tags/AI/" style="font-size: 1.05rem;">AI<sup>1</sup></a><a href="/tags/AI-Agent/" style="font-size: 1.05rem;">AI-Agent<sup>1</sup></a><a href="/tags/AOP/" style="font-size: 1.05rem;">AOP<sup>1</sup></a><a href="/tags/APNS/" style="font-size: 1.05rem;">APNS<sup>1</sup></a><a href="/tags/CA/" style="font-size: 1.05rem;">CA<sup>1</sup></a><a href="/tags/Category/" style="font-size: 1.05rem;">Category<sup>1</sup></a><a href="/tags/Chromium/" style="font-size: 1.05rem;">Chromium<sup>1</sup></a><a href="/tags/Claude/" style="font-size: 1.05rem;">Claude<sup>1</sup></a><a href="/tags/Embedding/" style="font-size: 1.05rem;">Embedding<sup>1</sup></a><a href="/tags/Function-Calling/" style="font-size: 1.05rem;">Function-Calling<sup>1</sup></a><a href="/tags/Hibernate/" style="font-size: 1.05rem;">Hibernate<sup>1</sup></a><a href="/tags/JPA/" style="font-size: 1.05rem;">JPA<sup>1</sup></a><a href="/tags/Java/" style="font-size: 1.05rem;">Java<sup>2</sup></a><a href="/tags/Kafka/" style="font-size: 1.05rem;">Kafka<sup>1</sup></a><a href="/tags/LLM/" style="font-size: 1.05rem;">LLM<sup>1</sup></a><a href="/tags/MCP/" style="font-size: 1.05rem;">MCP<sup>1</sup></a><a href="/tags/Model-Context-Protocol/" style="font-size: 1.05rem;">Model Context Protocol<sup>1</sup></a><a href="/tags/MySQL/" style="font-size: 1.05rem;">MySQL<sup>1</sup></a><a href="/tags/ORM/" style="font-size: 1.05rem;">ORM<sup>1</sup></a><a href="/tags/Objective-C/" style="font-size: 1.05rem;">Objective-C<sup>1</sup></a><a href="/tags/Obsidian/" style="font-size: 1.05rem;">Obsidian<sup>1</sup></a><a href="/tags/PKCS/" style="font-size: 1.05rem;">PKCS<sup>1</sup></a><a href="/tags/PKI/" style="font-size: 1.05rem;">PKI<sup>1</sup></a><a href="/tags/Protocol/" style="font-size: 1.05rem;">Protocol<sup>1</sup></a><a href="/tags/RAG/" style="font-size: 1.05rem;">RAG<sup>1</sup></a><a href="/tags/RabbitMQ/" style="font-size: 1.05rem;">RabbitMQ<sup>1</sup></a><a href="/tags/ReAct/" style="font-size: 1.05rem;">ReAct<sup>1</sup></a><a href="/tags/Redis/" style="font-size: 1.05rem;">Redis<sup>1</sup></a><a href="/tags/SCEP/" style="font-size: 1.05rem;">SCEP<sup>1</sup></a><a href="/tags/Spring/" style="font-size: 1.05rem;">Spring<sup>1</sup></a><a href="/tags/golang/" style="font-size: 1.05rem;">golang<sup>1</sup></a><a href="/tags/iOS/" style="font-size: 1.05rem;">iOS<sup>1</sup></a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/" style="font-size: 1.05rem;">分布式系统<sup>2</sup></a><a href="/tags/%E5%8A%A0%E5%AF%86/" style="font-size: 1.05rem;">加密<sup>1</sup></a><a href="/tags/%E5%8D%8F%E8%AE%AE%E6%A0%87%E5%87%86/" style="font-size: 1.05rem;">协议标准<sup>1</sup></a><a href="/tags/%E5%90%91%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 1.05rem;">向量数据库<sup>1</sup></a><a href="/tags/%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/" style="font-size: 1.05rem;">开发指南<sup>1</sup></a><a href="/tags/%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/" style="font-size: 1.05rem;">数字证书<sup>1</sup></a><a href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" style="font-size: 1.05rem;">面向对象<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/11/"><span class="card-archive-list-date">十一月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">19</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/mobile/" itemprop="url">移动开发</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Objective-C/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Objective-C</span></a><a class="article-meta__tags" href="/tags/iOS/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>iOS</span></a><a class="article-meta__tags" href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>面向对象</span></a><a class="article-meta__tags" href="/tags/Category/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Category</span></a><a class="article-meta__tags" href="/tags/Protocol/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Protocol</span></a></span></div></div><h1 class="post-title" itemprop="name headline">Objective-C 面向对象编程详解</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-11-28T14:30:00.000Z" title="发表于 2025-11-28 14:30:00">2025-11-28</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-11-30T14:02:36.515Z" title="更新于 2025-11-30 14:02:36">2025-11-30</time></span></div><div class="meta-secondline"></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src=""></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://supremes.github.io/posts/57222.html"><header><a class="post-meta-categories" href="/categories/mobile/" itemprop="url">移动开发</a><a href="/tags/Objective-C/" tabindex="-1" itemprop="url">Objective-C</a><a href="/tags/iOS/" tabindex="-1" itemprop="url">iOS</a><a href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" tabindex="-1" itemprop="url">面向对象</a><a href="/tags/Category/" tabindex="-1" itemprop="url">Category</a><a href="/tags/Protocol/" tabindex="-1" itemprop="url">Protocol</a><h1 id="CrawlerTitle" itemprop="name headline">Objective-C 面向对象编程详解</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Supremes</span><time itemprop="dateCreated datePublished" datetime="2025-11-28T14:30:00.000Z" title="发表于 2025-11-28 14:30:00">2025-11-28</time><time itemprop="dateCreated datePublished" datetime="2025-11-30T14:02:36.515Z" title="更新于 2025-11-30 14:02:36">2025-11-30</time></header><h1 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h1><h3 id="1-Category（分类）"><a href="#1-Category（分类）" class="headerlink" title="1. Category（分类）"></a>1. <strong>Category（分类）</strong></h3><p><strong>Category</strong> 是 Objective-C 中用于扩展已有类功能的一种机制，无需继承即可为类添加方法。它的主要用途是增强类的功能或将类的实现分模块组织。</p>
<h4 id="特点："><a href="#特点：" class="headerlink" title="特点："></a>特点：</h4><ul>
<li><strong>无需子类化</strong>：可以在不修改原始类源码的情况下，为类添加新的方法。</li>
<li><strong>动态扩展</strong>：Category 在运行时动态地将方法添加到类中。</li>
<li><strong>模块化开发</strong>：可以将类的功能拆分成多个文件，便于团队协作或代码管理。</li>
<li><strong>限制</strong>：<ul>
<li>不能添加实例变量，只能添加方法。</li>
<li>如果 Category 中定义的方法与原始类或另一个 Category 中的方法同名，会覆盖原始方法（可能导致不可预测的行为）。</li>
<li>不能直接访问原始类的私有方法或变量。</li>
</ul>
</li>
</ul>
<h4 id="语法："><a href="#语法：" class="headerlink" title="语法："></a>语法：</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> 原类名 (<span class="title">CategoryName</span>)</span></span><br><span class="line"><span class="comment">// 声明新方法</span></span><br><span class="line">- (<span class="type">void</span>)newMethod;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> 原类名 (<span class="title">CategoryName</span>)</span></span><br><span class="line"><span class="comment">// 实现新方法</span></span><br><span class="line">- (<span class="type">void</span>)newMethod &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;This is a new method added by Category.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<h4 id="应用场景："><a href="#应用场景：" class="headerlink" title="应用场景："></a>应用场景：</h4><ol>
<li><p><strong>扩展系统类</strong>：例如，为 <code>NSString</code> 添加一个自定义方法：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSString</span> (<span class="title">MyExtension</span>)</span></span><br><span class="line">- (<span class="built_in">NSString</span> *)reverseString;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NSString</span> (<span class="title">MyExtension</span>)</span></span><br><span class="line">- (<span class="built_in">NSString</span> *)reverseString &#123;</span><br><span class="line">    <span class="built_in">NSMutableString</span> *reversed = [<span class="built_in">NSMutableString</span> stringWithCapacity:<span class="keyword">self</span>.length];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="keyword">self</span>.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        [reversed appendString:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@&quot;%C&quot;</span>, [<span class="keyword">self</span> characterAtIndex:i]]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> reversed;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>使用：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *str = <span class="string">@&quot;Hello&quot;</span>;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;%@&quot;</span>, [str reverseString]); <span class="comment">// 输出: olleH</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>代码组织</strong>：将大类的实现分成多个 Category，增强可读性和维护性。例如，<code>UIViewController</code> 可以按功能分为 <code>DataHandling</code> 和 <code>UIConfiguration</code> 两个 Category。</p>
</li>
<li><p><strong>修复或增强功能</strong>：在不修改第三方库的情况下，为其类添加功能。</p>
</li>
</ol>
<h4 id="注意事项："><a href="#注意事项：" class="headerlink" title="注意事项："></a>注意事项：</h4><ul>
<li><strong>方法冲突</strong>：如果多个 Category 或原始类定义了同名方法，运行时会选择其中一个（不可预测），应避免命名冲突。</li>
<li><strong>调试困难</strong>：Category 的方法覆盖可能导致调试复杂。</li>
<li><strong>最佳实践</strong>：为避免冲突，建议在方法名中加入前缀（如 <code>my_reverseString</code>）。</li>
</ul>
<hr>
<h3 id="2-Protocol（协议）"><a href="#2-Protocol（协议）" class="headerlink" title="2. Protocol（协议）"></a>2. <strong>Protocol（协议）</strong></h3><p><strong>Protocol</strong> 是 Objective-C 中定义一组方法规范的机制，类似于接口（interface）。它用于声明一组方法，供类实现，以保证类具有特定行为。</p>
<h4 id="特点：-1"><a href="#特点：-1" class="headerlink" title="特点："></a>特点：</h4><ul>
<li><strong>抽象性</strong>：Protocol 仅定义方法签名，不提供实现。</li>
<li><strong>多类共享</strong>：多个类可以实现同一个 Protocol，实现代码共享或行为一致性。</li>
<li><strong>可选与必须</strong>：方法可以标记为 <code>@required</code>（默认，必须实现）或 <code>@optional</code>（可选实现）。</li>
<li><strong>类型检查</strong>：编译器可以检查类是否遵循某个 Protocol。</li>
</ul>
<h4 id="语法：-1"><a href="#语法：-1" class="headerlink" title="语法："></a>语法：</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">MyProtocol</span> &lt;<span class="title">NSObject</span>&gt;</span></span><br><span class="line"><span class="comment">// 必须实现的方法</span></span><br><span class="line"><span class="keyword">@required</span></span><br><span class="line">- (<span class="type">void</span>)requiredMethod;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可选实现的方法</span></span><br><span class="line"><span class="keyword">@optional</span></span><br><span class="line">- (<span class="type">void</span>)optionalMethod;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyClass</span> : <span class="title">NSObject</span> &lt;<span class="title">MyProtocol</span>&gt;</span></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MyClass</span></span></span><br><span class="line">- (<span class="type">void</span>)requiredMethod &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;Required method implemented.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<h4 id="应用场景：-1"><a href="#应用场景：-1" class="headerlink" title="应用场景："></a>应用场景：</h4><ol>
<li><p><strong>委托模式（Delegate）</strong>：最常见的用途，例如 <code>UITableViewDelegate</code> 和 <code>UITableViewDataSource</code>。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">MyDelegate</span> &lt;<span class="title">NSObject</span>&gt;</span></span><br><span class="line"><span class="keyword">@required</span></span><br><span class="line">- (<span class="type">void</span>)didCompleteTask;</span><br><span class="line"><span class="keyword">@optional</span></span><br><span class="line">- (<span class="type">void</span>)progressUpdated:(<span class="type">float</span>)progress;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyClass</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="type">id</span>&lt;MyDelegate&gt; delegate;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>接口定义</strong>：定义一组标准接口，供不同类实现。例如，多个视图控制器实现同一个数据处理协议。</p>
</li>
<li><p><strong>类型安全</strong>：通过 Protocol 限制对象类型，确保对象支持特定方法：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">id</span>&lt;MyProtocol&gt; obj = [[MyClass alloc] init];</span><br><span class="line">[obj requiredMethod]; <span class="comment">// 编译器确保方法存在</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="注意事项：-1"><a href="#注意事项：-1" class="headerlink" title="注意事项："></a>注意事项：</h4><ul>
<li><strong>NSObject 协议</strong>：通常 Protocol 会继承 <code>&lt;NSObject&gt;</code> 协议，以确保对象支持基本方法（如 <code>respondsToSelector:</code>）。</li>
<li><strong>动态检查</strong>：使用 <code>conformsToProtocol:</code> 和 <code>respondsToSelector:</code> 检查对象是否遵循协议或实现某方法： <figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ([obj conformsToProtocol:<span class="class"><span class="keyword">@protocol</span>(<span class="title">MyProtocol</span>)]) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ([obj respondsToSelector:<span class="keyword">@selector</span>(optionalMethod)]) &#123;</span><br><span class="line">        [obj optionalMethod];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="3-Extension（类扩展）"><a href="#3-Extension（类扩展）" class="headerlink" title="3 Extension（类扩展）"></a>3 <strong>Extension（类扩展）</strong></h3><ul>
<li><strong>定义</strong>：类扩展是匿名的 Category，通常用于在类的实现文件中声明私有方法或属性。</li>
<li><strong>特点</strong>：<ul>
<li>可以在 <code>.m</code> 文件中声明私有方法或属性。</li>
<li>可以添加实例变量（与 Category 不同）。</li>
<li>仅在当前类实现文件可见，外部无法访问。</li>
</ul>
</li>
<li><strong>语法</strong>：<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyClass</span> ()</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSString</span> *privateProperty;</span><br><span class="line">- (<span class="type">void</span>)privateMethod;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MyClass</span></span></span><br><span class="line">- (<span class="type">void</span>)privateMethod &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;This is a private method.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></li>
<li><strong>用途</strong>：隐藏实现细节，声明私有接口，或为只读属性添加私有读写支持。</li>
</ul>
<h3 id="4-Dynamic-Runtime（运行时动态性）"><a href="#4-Dynamic-Runtime（运行时动态性）" class="headerlink" title="4  Dynamic Runtime（运行时动态性）"></a>4  <strong>Dynamic Runtime（运行时动态性）</strong></h3><ul>
<li>Objective-C 的运行时系统提供了强大的动态特性，支持以下功能：<ul>
<li><strong>方法交换（Method Swizzling）</strong>：在运行时替换方法实现，常用于调试或修改系统类行为。</li>
<li><strong>动态添加方法</strong>：通过 <code>class_addMethod</code> 动态为类添加方法。</li>
<li><strong>关联对象（Associated Objects）</strong>：通过 <code>objc_setAssociatedObject</code> 为 Category 添加“伪属性”。</li>
<li><strong>示例</strong>（添加关联对象）：<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&lt;objc/runtime.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSObject</span> (<span class="title">MyCategory</span>)</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSString</span> *associatedString;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NSObject</span> (<span class="title">MyCategory</span>)</span></span><br><span class="line"><span class="keyword">static</span> <span class="type">char</span> kAssociatedStringKey;</span><br><span class="line">- (<span class="type">void</span>)setAssociatedString:(<span class="built_in">NSString</span> *)string &#123;</span><br><span class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, &amp;kAssociatedStringKey, string, OBJC_ASSOCIATION_RETAIN_NONATOMIC);</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="built_in">NSString</span> *)associatedString &#123;</span><br><span class="line">    <span class="keyword">return</span> objc_getAssociatedObject(<span class="keyword">self</span>, &amp;kAssociatedStringKey);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></li>
<li><strong>用途</strong>：增强 Category 功能，实现动态行为修改。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="5-Category-vs-Protocol-vs-其他方案对比"><a href="#5-Category-vs-Protocol-vs-其他方案对比" class="headerlink" title="5. Category vs Protocol vs 其他方案对比"></a>5. <strong>Category vs Protocol vs 其他方案对比</strong></h3><table>
<thead>
<tr>
<th>特性&#x2F;机制</th>
<th>Category</th>
<th>Protocol</th>
<th>Extension</th>
<th>Block</th>
</tr>
</thead>
<tbody><tr>
<td><strong>用途</strong></td>
<td>扩展类方法</td>
<td>定义接口规范</td>
<td>声明私有方法&#x2F;属性</td>
<td>回调和函数式编程</td>
</tr>
<tr>
<td><strong>添加实例变量</strong></td>
<td>否（可通过关联对象实现）</td>
<td>否</td>
<td>是</td>
<td>否</td>
</tr>
<tr>
<td><strong>代码复用</strong></td>
<td>高（直接扩展类）</td>
<td>中（需实现）</td>
<td>低（仅限当前类）</td>
<td>高（独立逻辑）</td>
</tr>
<tr>
<td><strong>动态性</strong></td>
<td>高（运行时添加方法）</td>
<td>中（运行时检查方法）</td>
<td>低（编译时确定）</td>
<td>高（捕获上下文）</td>
</tr>
<tr>
<td><strong>典型场景</strong></td>
<td>系统类扩展、代码模块化</td>
<td>委托模式、接口定义</td>
<td>私有接口、属性扩展</td>
<td>异步回调、事件处理</td>
</tr>
</tbody></table>
<hr>
<h3 id="6-总结与建议"><a href="#6-总结与建议" class="headerlink" title="6. 总结与建议"></a>6. <strong>总结与建议</strong></h3><ul>
<li><strong>Category</strong> 适合快速扩展类功能，特别是为系统类或第三方库添加方法，但需注意方法冲突。</li>
<li><strong>Protocol</strong> 适合定义标准接口，确保类行为一致，广泛用于委托模式。</li>
<li><strong>Extension</strong> 用于私有接口，适合隐藏实现细节。</li>
<li><strong>Block</strong> 提供轻量级回调，适合异步任务。</li>
<li><strong>运行时动态性</strong> 提供了强大的灵活性，但需谨慎使用以避免复杂性。</li>
</ul>
<p>根据具体需求选择合适的方案：</p>
<ul>
<li>如果需要扩展现有类，使用 <strong>Category</strong>。</li>
<li>如果需要定义行为规范，使用 <strong>Protocol</strong>。</li>
<li>如果需要私有方法或属性，使用 <strong>Extension</strong>。</li>
<li>如果需要动态或回调逻辑，考虑 <strong>Block</strong> 或 <strong>运行时特性</strong>。</li>
</ul>
<p>如需更具体示例或深入探讨某一机制，请告诉我！</p>
<h1 id="NSURL"><a href="#NSURL" class="headerlink" title="NSURL"></a>NSURL</h1><h2 id="NSURLProtocol"><a href="#NSURLProtocol" class="headerlink" title="NSURLProtocol"></a>NSURLProtocol</h2><p>In the context of <code>WKWebView</code>, requests are generally <strong>not</strong> handled by <code>NSURLProtocol</code>, especially for custom schemes or even for <code>http/https</code> in most cases. Apple restricts <code>NSURLProtocol</code> usage in <code>WKWebView</code> for security and performance reasons.</p>
<p><strong>However, requests can be handled by <code>NSURLProtocol</code> in these scenarios:</strong></p>
<ul>
<li>When using <code>NSURLConnection</code> or <code>NSURLSession</code> <strong>outside</strong> of <code>WKWebView</code>, and you register a custom <code>NSURLProtocol</code> class, all matching requests (e.g., <code>http</code>, <code>https</code>, or custom schemes if registered) will be intercepted by your protocol handler.</li>
<li>In <code>UIWebView</code> (deprecated), <code>NSURLProtocol</code> can intercept requests.</li>
<li>In <code>WKWebView</code>, only if you use a custom <code>NSURLSession</code> (not the web view’s internal networking), and you register a protocol class on that session’s configuration, then requests made by that session (not the web view) can be intercepted.</li>
</ul>
<p><strong>Summary:</strong><br>In <code>WKWebView</code>, requests are not forwarded to <code>NSURLProtocol</code>. Only network requests made by your own <code>NSURLSession</code> or <code>NSURLConnection</code> (outside of <code>WKWebView</code>) can be intercepted by <code>NSURLProtocol</code>.</p>
<hr>
<h2 id="WKURLSchemeHandler"><a href="#WKURLSchemeHandler" class="headerlink" title="WKURLSchemeHandler"></a>WKURLSchemeHandler</h2><ul>
<li><p>拦截处理自定义 scheme（非 https&#x2F;http） </p>
<blockquote>
<p>通过实现WKURLSchemeHandler protocol，可以拦截和处理 WKWebView 发起的特定 scheme（如 http&#x2F;https 以外的自定义协议）请求，实现自定义的网络请求逻辑</p>
</blockquote>
</li>
<li><p>apple 推荐的官方协议，用来处理自定义的 scheme</p>
</li>
<li><p><strong><code> https/http</code> 请求无法在 wkwebview 中被拦截处理</strong></p>
</li>
<li><p>WKWebview 不支持使用<code>NSURLProtocol</code>来拦截请求，forward 到<code>NSURLSession</code>是官方推荐可信任的做法</p>
</li>
</ul>
<hr>
<h2 id="NSURLSessionDelegate"><a href="#NSURLSessionDelegate" class="headerlink" title="NSURLSessionDelegate"></a>NSURLSessionDelegate</h2><ul>
<li><code>WKURLSchemeHandler</code> 拦截的请求，会被转发到<code>NSURLSession</code>， 并通过 NSURLSessionDelegate 进行处理。</li>
</ul>
<h1 id="UIViewController"><a href="#UIViewController" class="headerlink" title="UIViewController"></a>UIViewController</h1><p>UIViewController的生命周期函数介绍：</p>
<h2 id="主要生命周期方法"><a href="#主要生命周期方法" class="headerlink" title="主要生命周期方法"></a>主要生命周期方法</h2><h3 id="1-viewDidLoad"><a href="#1-viewDidLoad" class="headerlink" title="1. viewDidLoad"></a>1. <code>viewDidLoad</code></h3><ul>
<li><strong>调用时机</strong>：视图控制器的视图层次结构加载到内存中后调用</li>
<li><strong>用途</strong>：进行一次性初始化，如创建UI元素、设置初始状态</li>
<li><strong>特点</strong>：只调用一次</li>
</ul>
<h3 id="2-viewWillAppear"><a href="#2-viewWillAppear" class="headerlink" title="2. viewWillAppear:"></a>2. <code>viewWillAppear:</code></h3><ul>
<li><strong>调用时机</strong>：视图即将显示前调用</li>
<li><strong>用途</strong>：准备显示视图，如刷新数据、重置UI状态</li>
<li><strong>特点</strong>：每次视图显示前都会调用</li>
</ul>
<h3 id="3-viewDidAppear"><a href="#3-viewDidAppear" class="headerlink" title="3. viewDidAppear:"></a>3. <code>viewDidAppear:</code></h3><ul>
<li><strong>调用时机</strong>：视图已经显示后调用</li>
<li><strong>用途</strong>：启动动画、开始定时器、注册通知等</li>
<li><strong>特点</strong>：每次视图显示后都会调用</li>
</ul>
<h3 id="4-viewWillDisappear"><a href="#4-viewWillDisappear" class="headerlink" title="4. viewWillDisappear:"></a>4. <code>viewWillDisappear:</code></h3><ul>
<li><strong>调用时机</strong>：视图即将消失前调用</li>
<li><strong>用途</strong>：保存数据、暂停操作、验证输入等</li>
<li><strong>特点</strong>：每次视图消失前都会调用</li>
</ul>
<h3 id="5-viewDidDisappear"><a href="#5-viewDidDisappear" class="headerlink" title="5. viewDidDisappear:"></a>5. <code>viewDidDisappear:</code></h3><ul>
<li><strong>调用时机</strong>：视图已经消失后调用</li>
<li><strong>用途</strong>：停止定时器、取消网络请求、清理资源等</li>
<li><strong>特点</strong>：每次视图消失后都会调用</li>
</ul>
<h3 id="6-viewDidUnload-iOS-6之前"><a href="#6-viewDidUnload-iOS-6之前" class="headerlink" title="6. viewDidUnload (iOS 6之前)"></a>6. <code>viewDidUnload</code> (iOS 6之前)</h3><ul>
<li><strong>调用时机</strong>：内存不足时系统卸载视图</li>
<li><strong>用途</strong>：清理视图相关资源</li>
<li><strong>特点</strong>：iOS 6后已废弃</li>
</ul>
<h2 id="生命周期顺序"><a href="#生命周期顺序" class="headerlink" title="生命周期顺序"></a>生命周期顺序</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">创建 → viewDidLoad → viewWillAppear → viewDidAppear</span><br><span class="line">     ↓</span><br><span class="line">显示中的视图</span><br><span class="line">     ↓</span><br><span class="line">viewWillDisappear → viewDidDisappear → 销毁</span><br></pre></td></tr></table></figure>

<h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><ul>
<li><strong>viewDidLoad</strong>：创建UI、设置委托、初始化数据源</li>
<li><strong>viewWillAppear</strong>：刷新界面数据、重置状态</li>
<li><strong>viewDidAppear</strong>：开始网络请求、启动动画</li>
<li><strong>viewWillDisappear</strong>：保存用户输入、暂停活动</li>
<li><strong>viewDidDisappear</strong>：清理资源、停止后台任务</li>
</ul>
<h1 id="UIApplication"><a href="#UIApplication" class="headerlink" title="UIApplication"></a>UIApplication</h1><h2 id="UIViewController-和-UIApplication-的关系"><a href="#UIViewController-和-UIApplication-的关系" class="headerlink" title="UIViewController 和 UIApplication 的关系"></a>UIViewController 和 UIApplication 的关系</h2><h3 id="层次关系"><a href="#层次关系" class="headerlink" title="层次关系"></a>层次关系</h3><ul>
<li><strong>UIApplication</strong>：应用程序的单例对象，管理整个应用的生命周期</li>
<li><strong>UIViewController</strong>：管理单个视图的控制器，是UIApplication管理的视图层次结构的一部分</li>
</ul>
<h3 id="包含关系"><a href="#包含关系" class="headerlink" title="包含关系"></a>包含关系</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">UIApplication</span><br><span class="line">├── UIWindow</span><br><span class="line">    ├── Root UIViewController</span><br><span class="line">        ├── Child UIViewController</span><br><span class="line">        └── Presented UIViewController</span><br></pre></td></tr></table></figure>

<h2 id="生命周期函数对应关系"><a href="#生命周期函数对应关系" class="headerlink" title="生命周期函数对应关系"></a>生命周期函数对应关系</h2><h3 id="UIApplication-生命周期方法（AppDelegate）"><a href="#UIApplication-生命周期方法（AppDelegate）" class="headerlink" title="UIApplication 生命周期方法（AppDelegate）"></a>UIApplication 生命周期方法（AppDelegate）</h3><h4 id="1-application-didFinishLaunchingWithOptions"><a href="#1-application-didFinishLaunchingWithOptions" class="headerlink" title="1. application:didFinishLaunchingWithOptions:"></a>1. <code>application:didFinishLaunchingWithOptions:</code></h4><ul>
<li><strong>对应UIViewController</strong>：在root view controller的<code>viewDidLoad</code>之前调用</li>
<li><strong>关系</strong>：应用启动完成 → 创建window和root view controller</li>
</ul>
<h4 id="2-applicationDidBecomeActive"><a href="#2-applicationDidBecomeActive" class="headerlink" title="2. applicationDidBecomeActive:"></a>2. <code>applicationDidBecomeActive:</code></h4><ul>
<li><strong>对应UIViewController</strong>：当前可见view controller的<code>viewWillAppear:</code>和<code>viewDidAppear:</code></li>
<li><strong>关系</strong>：应用变为活跃状态 → 视图控制器开始显示</li>
</ul>
<h4 id="3-applicationWillResignActive"><a href="#3-applicationWillResignActive" class="headerlink" title="3. applicationWillResignActive:"></a>3. <code>applicationWillResignActive:</code></h4><ul>
<li><strong>对应UIViewController</strong>：当前可见view controller的<code>viewWillDisappear:</code></li>
<li><strong>关系</strong>：应用即将失去焦点 → 视图即将不可交互</li>
</ul>
<h4 id="4-applicationDidEnterBackground"><a href="#4-applicationDidEnterBackground" class="headerlink" title="4. applicationDidEnterBackground:"></a>4. <code>applicationDidEnterBackground:</code></h4><ul>
<li><strong>对应UIViewController</strong>：当前可见view controller的<code>viewDidDisappear:</code></li>
<li><strong>关系</strong>：应用进入后台 → 视图完全不可见</li>
</ul>
<h4 id="5-applicationWillEnterForeground"><a href="#5-applicationWillEnterForeground" class="headerlink" title="5. applicationWillEnterForeground:"></a>5. <code>applicationWillEnterForeground:</code></h4><ul>
<li><strong>对应UIViewController</strong>：即将显示的view controller的<code>viewWillAppear:</code></li>
<li><strong>关系</strong>：应用即将回到前台 → 视图即将重新显示</li>
</ul>
<h4 id="6-applicationWillTerminate"><a href="#6-applicationWillTerminate" class="headerlink" title="6. applicationWillTerminate:"></a>6. <code>applicationWillTerminate:</code></h4><ul>
<li><strong>对应UIViewController</strong>：所有view controller的清理工作</li>
<li><strong>关系</strong>：应用即将终止 → 所有视图控制器被销毁</li>
</ul>
<h2 id="调用顺序示例"><a href="#调用顺序示例" class="headerlink" title="调用顺序示例"></a>调用顺序示例</h2><h3 id="应用启动"><a href="#应用启动" class="headerlink" title="应用启动"></a>应用启动</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. application:didFinishLaunchingWithOptions:</span><br><span class="line">2. viewDidLoad (root ViewController)</span><br><span class="line">3. viewWillAppear: (root ViewController) </span><br><span class="line">4. applicationDidBecomeActive:</span><br><span class="line">5. viewDidAppear: (root ViewController)</span><br></pre></td></tr></table></figure>

<h3 id="应用进入后台"><a href="#应用进入后台" class="headerlink" title="应用进入后台"></a>应用进入后台</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. applicationWillResignActive:</span><br><span class="line">2. viewWillDisappear: (current ViewController)</span><br><span class="line">3. applicationDidEnterBackground:</span><br><span class="line">4. viewDidDisappear: (current ViewController)</span><br></pre></td></tr></table></figure>

<h3 id="应用回到前台"><a href="#应用回到前台" class="headerlink" title="应用回到前台"></a>应用回到前台</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. applicationWillEnterForeground:</span><br><span class="line">2. viewWillAppear: (current ViewController)</span><br><span class="line">3. applicationDidBecomeActive:</span><br><span class="line">4. viewDidAppear: (current ViewController)</span><br></pre></td></tr></table></figure>

<h2 id="实际应用建议"><a href="#实际应用建议" class="headerlink" title="实际应用建议"></a>实际应用建议</h2><ul>
<li><strong>UIApplication级别</strong>：处理全局状态、推送通知、应用级别的数据保存</li>
<li><strong>UIViewController级别</strong>：处理界面相关的逻辑、用户交互、视图状态管理</li>
<li><strong>协调使用</strong>：在AppDelegate中可以通知当前的view controller应用状态变化</li>
</ul>
</article><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/27915.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">MCP（Model Context Protocol）详解</div></div></a></div><div class="next-post pull-right"><a href="/posts/64545.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/imgs/%E8%AE%A4%E8%AF%81%E5%92%8C%E6%8E%88%E6%9D%83%E5%B0%81%E9%9D%A2%E5%9B%BE.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">现代身份认证与授权技术完全指南 - OAuth、JWT、SAML 等协议详解</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1"><span class="toc-text">面向对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Category%EF%BC%88%E5%88%86%E7%B1%BB%EF%BC%89"><span class="toc-text">1. Category（分类）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E7%82%B9%EF%BC%9A"><span class="toc-text">特点：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95%EF%BC%9A"><span class="toc-text">语法：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%EF%BC%9A"><span class="toc-text">应用场景：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%EF%BC%9A"><span class="toc-text">注意事项：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Protocol%EF%BC%88%E5%8D%8F%E8%AE%AE%EF%BC%89"><span class="toc-text">2. Protocol（协议）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E7%82%B9%EF%BC%9A-1"><span class="toc-text">特点：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95%EF%BC%9A-1"><span class="toc-text">语法：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%EF%BC%9A-1"><span class="toc-text">应用场景：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%EF%BC%9A-1"><span class="toc-text">注意事项：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Extension%EF%BC%88%E7%B1%BB%E6%89%A9%E5%B1%95%EF%BC%89"><span class="toc-text">3 Extension（类扩展）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Dynamic-Runtime%EF%BC%88%E8%BF%90%E8%A1%8C%E6%97%B6%E5%8A%A8%E6%80%81%E6%80%A7%EF%BC%89"><span class="toc-text">4  Dynamic Runtime（运行时动态性）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Category-vs-Protocol-vs-%E5%85%B6%E4%BB%96%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94"><span class="toc-text">5. Category vs Protocol vs 其他方案对比</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%80%BB%E7%BB%93%E4%B8%8E%E5%BB%BA%E8%AE%AE"><span class="toc-text">6. 总结与建议</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NSURL"><span class="toc-text">NSURL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#NSURLProtocol"><span class="toc-text">NSURLProtocol</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WKURLSchemeHandler"><span class="toc-text">WKURLSchemeHandler</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NSURLSessionDelegate"><span class="toc-text">NSURLSessionDelegate</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#UIViewController"><span class="toc-text">UIViewController</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%96%B9%E6%B3%95"><span class="toc-text">主要生命周期方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-viewDidLoad"><span class="toc-text">1. viewDidLoad</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-viewWillAppear"><span class="toc-text">2. viewWillAppear:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-viewDidAppear"><span class="toc-text">3. viewDidAppear:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-viewWillDisappear"><span class="toc-text">4. viewWillDisappear:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-viewDidDisappear"><span class="toc-text">5. viewDidDisappear:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-viewDidUnload-iOS-6%E4%B9%8B%E5%89%8D"><span class="toc-text">6. viewDidUnload (iOS 6之前)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%A1%BA%E5%BA%8F"><span class="toc-text">生命周期顺序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-text">最佳实践</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#UIApplication"><span class="toc-text">UIApplication</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#UIViewController-%E5%92%8C-UIApplication-%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-text">UIViewController 和 UIApplication 的关系</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%82%E6%AC%A1%E5%85%B3%E7%B3%BB"><span class="toc-text">层次关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E5%85%B3%E7%B3%BB"><span class="toc-text">包含关系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB"><span class="toc-text">生命周期函数对应关系</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#UIApplication-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%96%B9%E6%B3%95%EF%BC%88AppDelegate%EF%BC%89"><span class="toc-text">UIApplication 生命周期方法（AppDelegate）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-application-didFinishLaunchingWithOptions"><span class="toc-text">1. application:didFinishLaunchingWithOptions:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-applicationDidBecomeActive"><span class="toc-text">2. applicationDidBecomeActive:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-applicationWillResignActive"><span class="toc-text">3. applicationWillResignActive:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-applicationDidEnterBackground"><span class="toc-text">4. applicationDidEnterBackground:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-applicationWillEnterForeground"><span class="toc-text">5. applicationWillEnterForeground:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-applicationWillTerminate"><span class="toc-text">6. applicationWillTerminate:</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E9%A1%BA%E5%BA%8F%E7%A4%BA%E4%BE%8B"><span class="toc-text">调用顺序示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8"><span class="toc-text">应用启动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E8%BF%9B%E5%85%A5%E5%90%8E%E5%8F%B0"><span class="toc-text">应用进入后台</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9B%9E%E5%88%B0%E5%89%8D%E5%8F%B0"><span class="toc-text">应用回到前台</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E5%BB%BA%E8%AE%AE"><span class="toc-text">实际应用建议</span></a></li></ol></li></ol></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2025 By <a class="footer-bar-link" href="/" title="Supremes" target="_blank">Supremes</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType () {
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      if (true) {
        const from = '出自 ' + data.from
        const sub = []
        sub.unshift(data.hitokoto, from)
        window.typed = new Typed('#footer-type-tips', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('footer-type-tips').innerHTML = data.hitokoto
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.cbd.int/typed.js@2.1.0/dist/typed.umd.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">50</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">11</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://hexo.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fas fa-home faa-tada"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><i class="fas fa-archive faa-tada"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fas fa-folder-open faa-tada"></i><span> 分类</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/database/"><i class="fas fa-database faa-tada"></i><span> 数据库</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/message-queue/"><i class="fas fa-envelope faa-tada"></i><span> 消息队列</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/Spring/"><i class="fas fa-leaf faa-tada"></i><span> Spring</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/security/"><i class="fas fa-shield-alt faa-tada"></i><span> 网络安全</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/AI/"><i class="fas fa-robot faa-tada"></i><span> AI</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/mobile/"><i class="fas fa-mobile-alt faa-tada"></i><span> 移动开发</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/tools/"><i class="fas fa-tools faa-tada"></i><span> 工具效率</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/diary/"><i class="fas fa-book faa-tada"></i><span> 日记</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fas fa-list faa-tada"></i><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/about_me"><i class="fas fa-user faa-tada"></i><span> 关于我</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/my_notes"><i class="fas fa-note-sticky faa-tada"></i><span> 备忘录</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/ACME/" style="font-size: 0.88rem;">ACME<sup>1</sup></a><a href="/tags/AI/" style="font-size: 0.88rem;">AI<sup>1</sup></a><a href="/tags/AI-Agent/" style="font-size: 0.88rem;">AI-Agent<sup>1</sup></a><a href="/tags/AOP/" style="font-size: 0.88rem;">AOP<sup>1</sup></a><a href="/tags/APNS/" style="font-size: 0.88rem;">APNS<sup>1</sup></a><a href="/tags/CA/" style="font-size: 0.88rem;">CA<sup>1</sup></a><a href="/tags/Category/" style="font-size: 0.88rem;">Category<sup>1</sup></a><a href="/tags/Chromium/" style="font-size: 0.88rem;">Chromium<sup>1</sup></a><a href="/tags/Claude/" style="font-size: 0.88rem;">Claude<sup>1</sup></a><a href="/tags/Embedding/" style="font-size: 0.88rem;">Embedding<sup>1</sup></a><a href="/tags/Function-Calling/" style="font-size: 0.88rem;">Function-Calling<sup>1</sup></a><a href="/tags/Hibernate/" style="font-size: 0.88rem;">Hibernate<sup>1</sup></a><a href="/tags/JPA/" style="font-size: 0.88rem;">JPA<sup>1</sup></a><a href="/tags/Java/" style="font-size: 0.88rem;">Java<sup>2</sup></a><a href="/tags/Kafka/" style="font-size: 0.88rem;">Kafka<sup>1</sup></a><a href="/tags/LLM/" style="font-size: 0.88rem;">LLM<sup>1</sup></a><a href="/tags/MCP/" style="font-size: 0.88rem;">MCP<sup>1</sup></a><a href="/tags/Model-Context-Protocol/" style="font-size: 0.88rem;">Model Context Protocol<sup>1</sup></a><a href="/tags/MySQL/" style="font-size: 0.88rem;">MySQL<sup>1</sup></a><a href="/tags/ORM/" style="font-size: 0.88rem;">ORM<sup>1</sup></a><a href="/tags/Objective-C/" style="font-size: 0.88rem;">Objective-C<sup>1</sup></a><a href="/tags/Obsidian/" style="font-size: 0.88rem;">Obsidian<sup>1</sup></a><a href="/tags/PKCS/" style="font-size: 0.88rem;">PKCS<sup>1</sup></a><a href="/tags/PKI/" style="font-size: 0.88rem;">PKI<sup>1</sup></a><a href="/tags/Protocol/" style="font-size: 0.88rem;">Protocol<sup>1</sup></a><a href="/tags/RAG/" style="font-size: 0.88rem;">RAG<sup>1</sup></a><a href="/tags/RabbitMQ/" style="font-size: 0.88rem;">RabbitMQ<sup>1</sup></a><a href="/tags/ReAct/" style="font-size: 0.88rem;">ReAct<sup>1</sup></a><a href="/tags/Redis/" style="font-size: 0.88rem;">Redis<sup>1</sup></a><a href="/tags/SCEP/" style="font-size: 0.88rem;">SCEP<sup>1</sup></a><a href="/tags/Spring/" style="font-size: 0.88rem;">Spring<sup>1</sup></a><a href="/tags/golang/" style="font-size: 0.88rem;">golang<sup>1</sup></a><a href="/tags/iOS/" style="font-size: 0.88rem;">iOS<sup>1</sup></a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/" style="font-size: 0.88rem;">分布式系统<sup>2</sup></a><a href="/tags/%E5%8A%A0%E5%AF%86/" style="font-size: 0.88rem;">加密<sup>1</sup></a><a href="/tags/%E5%8D%8F%E8%AE%AE%E6%A0%87%E5%87%86/" style="font-size: 0.88rem;">协议标准<sup>1</sup></a><a href="/tags/%E5%90%91%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 0.88rem;">向量数据库<sup>1</sup></a><a href="/tags/%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/" style="font-size: 0.88rem;">开发指南<sup>1</sup></a><a href="/tags/%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/" style="font-size: 0.88rem;">数字证书<sup>1</sup></a><a href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" style="font-size: 0.88rem;">面向对象<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date(""); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2025 By 安知鱼 V1.6.15",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Supremes 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.cbd.int/mermaid@10.2.4/dist/mermaid.min.js').then(runMermaid)
  }

  anzhiyu.addGlobalFn('themeChange', runMermaid, 'mermaid')

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://cdn.cbd.int/qrcodejs@1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>
<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>现代身份认证与授权技术完全指南 - OAuth、JWT、SAML 等协议详解 | Supremes</title><meta name="keywords" content="OAuth,JWT,SAML,OIDC,认证,授权,Token,Kerberos,LDAP"><meta name="author" content="Supremes"><meta name="copyright" content="Supremes"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="现代身份认证与授权技术完全指南 - OAuth、JWT、SAML 等协议详解"><meta name="application-name" content="现代身份认证与授权技术完全指南 - OAuth、JWT、SAML 等协议详解"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#ffffff"><meta property="og:type" content="article"><meta property="og:title" content="现代身份认证与授权技术完全指南 - OAuth、JWT、SAML 等协议详解"><meta property="og:url" content="https://supremes.github.io/posts/64545.html"><meta property="og:site_name" content="Supremes"><meta property="og:description" content="认证和授权完全指南概述在现代网络安全体系中，认证（Authentication） 和 授权（Authorization） 是保障系统安全的两大核心机制：  认证：验证用户身份（”你是谁？”） 授权：确认访问权限（”你能做什么？”）  本文将从协议和Token两个维度，系统性阐述认证授权的技术体系。"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://supremes.github.io/imgs/%E8%AE%A4%E8%AF%81%E5%92%8C%E6%8E%88%E6%9D%83%E5%B0%81%E9%9D%A2%E5%9B%BE.png"><meta property="article:author" content="Supremes"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://supremes.github.io/imgs/%E8%AE%A4%E8%AF%81%E5%92%8C%E6%8E%88%E6%9D%83%E5%B0%81%E9%9D%A2%E5%9B%BE.png"><meta name="description" content="认证和授权完全指南概述在现代网络安全体系中，认证（Authentication） 和 授权（Authorization） 是保障系统安全的两大核心机制：  认证：验证用户身份（”你是谁？”） 授权：确认访问权限（”你能做什么？”）  本文将从协议和Token两个维度，系统性阐述认证授权的技术体系。"><link rel="shortcut icon" href="/favicon/favicon.ico"><link rel="canonical" href="https://supremes.github.io/posts/64545.html"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: undefined,
  friends_vue_info: undefined,
  navMusic: false,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: Supremes","link":"链接: ","source":"来源: Supremes","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Supremes',
  title: '现代身份认证与授权技术完全指南 - OAuth、JWT、SAML 等协议详解',
  postAI: '',
  pageFillDescription: '认证和授权完全指南, 概述, 一、认证授权协议体系, 1. OAuth 2.0 - 授权标准协议, 核心角色, 四种授权模式, 典型应用场景, 2. OpenID Connect (OIDC) - 身份认证层, 核心特性, OIDC 流程, 典型应用场景, 3. SAML 2.0 - 企业级身份联邦, 核心架构, 关键组件, SAML SSO 流程, 企业应用场景, 4. LDAP - 目录服务协议, 核心功能, 常见实现, 应用场景, 5. Kerberos - 票据认证协议, 核心组件, Kerberos 认证流程, 典型应用, 二、Token技术体系, 1. Access Token - 资源访问凭证, Token格式对比, 生命周期管理, 2. Refresh Token - 令牌续期机制, 核心特性, 安全要求, 3. ID Token - 身份信息载体, 标准声明（Claims）, 安全特性, 4. JWT - 自包含令牌标准, 三段式结构, 详细结构解析, 算法选择指南, 安全注意事项, 5. Session Token - 会话状态管理, 架构模式, 存储策略, Session vs JWT 对比, 6. SAML 断言 - XML安全声明, 断言类型, 三、协议与Token协同架构, 1. OAuth 2.0 + OpenID Connect 组合, 完整流程, 技术优势, 2. SAML + LDAP 企业集成, 集成架构, 集成流程, 企业价值, 四、安全最佳实践, 1. 传输层安全, HTTPS 强制要求, Token传输方式, 2. 存储安全策略, 浏览器端安全存储, 移动端安全存储, 3. 密钥管理体系, 密钥轮换策略, 密钥管理最佳实践, 4. 攻击防护机制, 重放攻击防护, 常见攻击与防护, 五、技术选型指南, 场景化选型矩阵, 现代化选型建议, 新项目推荐, 企业级要求, 实施路线图, 第一阶段：基础实施, 第二阶段：安全加固, 第三阶段：高级特性, 六、技术发展趋势, 新兴技术标准, OAuth 2.1, WebAuthn (FIDO2), 零信任架构下的认证, 动态授权模型, 标准参考文档, RFC标准, 安全框架, 总结认证和授权完全指南概述在现代网络安全体系中认证和授权是保障系统安全的两大核心机制认证验证用户身份你是谁授权确认访问权限你能做什么本文将从协议和两个维度系统性阐述认证授权的技术体系一认证授权协议体系授权标准协议是现代互联网授权的基石专注于授权资源访问权限的委派而非直接处理用户身份认证核心角色角色说明示例资源所有者拥有资源的用户微信用户客户端请求访问资源的应用第三方小程序授权服务器颁发的服务微信授权服务器资源服务器存储受保护资源的服务微信用户信息四种授权模式授权码模式适用场景应用服务端安全安全性最高推荐使用流程用户授权获取授权码后端交换隐式模式适用场景或原生客户端不安全注意已废弃建议使用密码模式适用场景高度信任的客户端风险直接暴露用户密码客户端凭证模式适用场景服务端间通信无用户参与特点机器对机器的授权典型应用场景第三方登录微信登录访问控制移动应用授权身份认证层在基础上扩展专门解决身份认证问题是身份认证的完整解决方案核心特性格式包含用户身份信息如姓名邮箱用户端点通过获取用户详细信息标准化声明定义了标准的用户属性字段流程用户访问客户端应用重定向到提供商进行认证用户授权后返回授权码客户端交换授权码获取返回通过端点获取用户信息典型应用场景企业使用登录企业应用消费级使用登录第三方应用跨域认证多个子域名系统的统一登录企业级身份联邦是企业级认证与授权标准基于实现跨域单点登录在企业环境中广泛部署核心架构用户认证资源访问关键组件断言格式的安全声明包含用户身份和权限信息身份提供者认证用户并生成断言如企业服务提供者依赖的断言提供服务访问如应用流程用户访问应用重定向到企业验证用户身份生成断言并返回验证断言并授权访问企业应用场景集成通过实现企业应用集成等企业应用混合云环境本地与云服务的身份联邦目录服务协议是访问和维护目录服务的标准协议主要用于用户和组织信息的查询与管理核心功能目录查询用户组织架构权限信息查询身份验证用户名密码验证属性管理用户属性的增删改查常见实现域环境的标准开源实现实现的服务应用场景企业内部用户认证邮箱系统组织架构管理权限控制和用户属性查询票据认证协议是基于票据的网络认证协议通过密钥分发中心实现安全认证有效防止中间人攻击核心组件密钥分发中心用户首次认证后的长期票据服务票据访问具体服务的临时票据认证流程典型应用域环境域的默认认证机制集群大数据平台的安全认证企业网络内网资源的安全访问二技术体系资源访问凭证是客户端访问资源服务器的核心凭证是体系的关键组件格式对比类型特点验证方式适用场景不透明随机字符串无法解析需调用授权服务器验证高安全要求的企业环境自包含可本地解析本地验证签名微服务分布式系统生命周期管理短期有效通常小时内过期续期机制配合实现自动续期撤销能力支持主动撤销和黑名单机制令牌续期机制专门用于在过期后获取新的实现长期会话管理核心特性长期有效性天有效期但可被撤销存储限制仅在客户端和授权服务器间流转单次使用使用后立即失效返回新的机制安全要求传输防止网络传输中被截获安全存储客户端需安全存储如撤销机制支持用户主动撤销或异常检测自动撤销身份信息载体是的核心组件以格式承载用户身份信息标准声明发行者用户唯一标识目标客户端过期时间签发时间邮箱邮箱验证状态姓名头像安全特性数字签名算法签名防篡改时效性短期有效通常分钟完整性包含完整的用户身份信息自包含令牌标准是一种开放标准用于在各方之间安全地传输信息三段式结构详细结构解析头部签名算法令牌类型密钥标识负载主题用户签发时间过期时间权限范围受众签名算法选择指南算法类型安全性适用场景对称加密中等内部微服务非对称加密高跨域认证椭圆曲线高移动端应用安全注意事项密钥管理定期轮换签名密钥算法验证明确指定允许的签名算法时效控制设置合理的过期时间敏感信息避免在中包含敏感数据会话状态管理是传统的会话管理机制通过服务端状态存储维护用户会话架构模式存储策略服务端存储内存存储性能最优但不支持集群集群高性能分布式存储数据库存储持久化但性能较低客户端传输自动传输支持和标志手动管理存在风险对比特性状态管理有状态服务端存储无状态自包含扩展性需要共享存储天然支持分布式性能需要查库验证本地验证撤销能力立即撤销需要黑名单机制存储开销服务端存储成本网络传输成本断言安全声明断言是协议的核心载体以格式承载安全声明信息断言类型认证断言属性断言授权决策断言三协议与协同架构组合这是现代应用最常用的认证授权组合同时解决身份认证和资源授权问题完整流程用户客户端应用认证服务器资源服务器访问应用重定向到认证页面登录并授权返回授权码交换返回使用访问资源使用获取技术优势职责分离负责授权负责认证标准化广泛的行业支持和互操作性安全性多层安全机制和最佳实践灵活性支持多种客户端类型和场景企业集成传统企业环境中和的组合提供了完整的企业身份管理解决方案集成架构用户目录身份联邦业务应用集成流程用户认证用户通过企业进行身份验证断言生成生成包含用户属性的断言应用授权应用验证断言并授权访问属性同步通过查询获取最新的用户属性企业价值统一身份一套用户目录管理所有应用合规要求满足企业安全和合规标准成本效益减少重复的身份管理工作四安全最佳实践传输层安全强制要求所有传输必须使用加密证书验证确保证书有效性和域名匹配策略启用严格传输安全传输方式推荐避免参数传递存储安全策略浏览器端安全存储存储方式安全性风险风险推荐场景高免疫需防护传统应用高免疫需防护环境低高风险免疫不推荐存储敏感最高免疫免疫短期存储移动端安全存储密钥管理体系密钥轮换策略签名密钥轮换频率每个月过程生成新密钥同时支持新旧密钥验证逐步淘汰旧密钥密钥存储开发环境环境变量生产环境密钥管理最佳实践分离存储密钥与应用代码分离访问控制最小权限原则审计日志记录所有密钥操作备份恢复建立密钥备份和恢复机制攻击防护机制重放攻击防护防止重复使用签发时间过期时间随机数中使用常见攻击与防护攻击类型防护措施实现方式劫持传输加密攻击存储隔离攻击跨站防护重放攻击时间戳唯一性验证五技术选型指南场景化选型矩阵应用场景推荐协议类型优势考虑因素消费级应用标准化易集成用户体验企业断言成熟稳定合规复杂度较高移动应用离线可用性能好存储安全微服务架构自包含无状态可扩展密钥管理网关细粒度控制性能要求现代化选型建议新项目推荐现代应用的首选扩展公共客户端必须启用格式使用格式短期分钟过期企业级要求安全要求用于企业用于服务间通信用于密钥存储合规要求数据保护和用户同意访问控制和审计医疗数据保护实施路线图第一阶段基础实施选择认证协议部署身份提供商如实现基础的登录登出功能配置和基础安全策略第二阶段安全加固启用多因素认证实施轮换和撤销配置安全存储和传输建立监控和审计机制第三阶段高级特性细粒度权限控制跨域集成零信任架构实施持续安全评估六技术发展趋势新兴技术标准整合了的安全最佳实践主要改进包括强制所有公共客户端必须使用移除隐式流不再支持隐式授权模式刷新令牌安全强化的安全要求注册示例零信任架构下的认证动态授权模型零信任原则永不信任始终验证最小权限访问持续验证和监控实施策略基于风险的自适应认证上下文感知的访问控制实时威胁检测和响应标准参考文档标准安全框架安全最佳实践网络安全框架信息安全管理体系标准总结认证和授权技术体系正在快速发展从传统的管理到现代的和体系再到新兴的零信任架构技术选择需要综合考虑安全性可用性可扩展性等多个维度关键要点是现代应用的主流选择在微服务架构中具有显著优势在企业环境中仍然重要安全性始终是第一考虑因素标准化有助于系统集成和维护选择合适的认证授权方案需要基于具体的业务场景技术架构和安全要求进行综合评估',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-11-30 14:02:36',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 8.1.1"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">Supremes</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fas fa-home faa-tada"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><i class="fas fa-archive faa-tada"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fas fa-folder-open faa-tada"></i><span> 分类</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/database/"><i class="fas fa-database faa-tada"></i><span> 数据库</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/message-queue/"><i class="fas fa-envelope faa-tada"></i><span> 消息队列</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/Spring/"><i class="fas fa-leaf faa-tada"></i><span> Spring</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/security/"><i class="fas fa-shield-alt faa-tada"></i><span> 网络安全</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/AI/"><i class="fas fa-robot faa-tada"></i><span> AI</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/mobile/"><i class="fas fa-mobile-alt faa-tada"></i><span> 移动开发</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/tools/"><i class="fas fa-tools faa-tada"></i><span> 工具效率</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/diary/"><i class="fas fa-book faa-tada"></i><span> 日记</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fas fa-list faa-tada"></i><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/about_me"><i class="fas fa-user faa-tada"></i><span> 关于我</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/my_notes"><i class="fas fa-note-sticky faa-tada"></i><span> 备忘录</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/ACME/" style="font-size: 1.05rem;">ACME<sup>1</sup></a><a href="/tags/AI/" style="font-size: 1.05rem;">AI<sup>1</sup></a><a href="/tags/AI-Agent/" style="font-size: 1.05rem;">AI-Agent<sup>1</sup></a><a href="/tags/AOP/" style="font-size: 1.05rem;">AOP<sup>1</sup></a><a href="/tags/APNS/" style="font-size: 1.05rem;">APNS<sup>1</sup></a><a href="/tags/CA/" style="font-size: 1.05rem;">CA<sup>1</sup></a><a href="/tags/Category/" style="font-size: 1.05rem;">Category<sup>1</sup></a><a href="/tags/Chromium/" style="font-size: 1.05rem;">Chromium<sup>1</sup></a><a href="/tags/Claude/" style="font-size: 1.05rem;">Claude<sup>1</sup></a><a href="/tags/Embedding/" style="font-size: 1.05rem;">Embedding<sup>1</sup></a><a href="/tags/Function-Calling/" style="font-size: 1.05rem;">Function-Calling<sup>1</sup></a><a href="/tags/Hibernate/" style="font-size: 1.05rem;">Hibernate<sup>1</sup></a><a href="/tags/JPA/" style="font-size: 1.05rem;">JPA<sup>1</sup></a><a href="/tags/Java/" style="font-size: 1.05rem;">Java<sup>2</sup></a><a href="/tags/Kafka/" style="font-size: 1.05rem;">Kafka<sup>1</sup></a><a href="/tags/LLM/" style="font-size: 1.05rem;">LLM<sup>1</sup></a><a href="/tags/MCP/" style="font-size: 1.05rem;">MCP<sup>1</sup></a><a href="/tags/Model-Context-Protocol/" style="font-size: 1.05rem;">Model Context Protocol<sup>1</sup></a><a href="/tags/MySQL/" style="font-size: 1.05rem;">MySQL<sup>1</sup></a><a href="/tags/ORM/" style="font-size: 1.05rem;">ORM<sup>1</sup></a><a href="/tags/Objective-C/" style="font-size: 1.05rem;">Objective-C<sup>1</sup></a><a href="/tags/Obsidian/" style="font-size: 1.05rem;">Obsidian<sup>1</sup></a><a href="/tags/PKCS/" style="font-size: 1.05rem;">PKCS<sup>1</sup></a><a href="/tags/PKI/" style="font-size: 1.05rem;">PKI<sup>1</sup></a><a href="/tags/Protocol/" style="font-size: 1.05rem;">Protocol<sup>1</sup></a><a href="/tags/RAG/" style="font-size: 1.05rem;">RAG<sup>1</sup></a><a href="/tags/RabbitMQ/" style="font-size: 1.05rem;">RabbitMQ<sup>1</sup></a><a href="/tags/ReAct/" style="font-size: 1.05rem;">ReAct<sup>1</sup></a><a href="/tags/Redis/" style="font-size: 1.05rem;">Redis<sup>1</sup></a><a href="/tags/SCEP/" style="font-size: 1.05rem;">SCEP<sup>1</sup></a><a href="/tags/Spring/" style="font-size: 1.05rem;">Spring<sup>1</sup></a><a href="/tags/golang/" style="font-size: 1.05rem;">golang<sup>1</sup></a><a href="/tags/iOS/" style="font-size: 1.05rem;">iOS<sup>1</sup></a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/" style="font-size: 1.05rem;">分布式系统<sup>2</sup></a><a href="/tags/%E5%8A%A0%E5%AF%86/" style="font-size: 1.05rem;">加密<sup>1</sup></a><a href="/tags/%E5%8D%8F%E8%AE%AE%E6%A0%87%E5%87%86/" style="font-size: 1.05rem;">协议标准<sup>1</sup></a><a href="/tags/%E5%90%91%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 1.05rem;">向量数据库<sup>1</sup></a><a href="/tags/%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/" style="font-size: 1.05rem;">开发指南<sup>1</sup></a><a href="/tags/%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/" style="font-size: 1.05rem;">数字证书<sup>1</sup></a><a href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" style="font-size: 1.05rem;">面向对象<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/11/"><span class="card-archive-list-date">十一月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">19</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/security/" itemprop="url">网络安全</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/OAuth/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>OAuth</span></a><a class="article-meta__tags" href="/tags/JWT/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>JWT</span></a><a class="article-meta__tags" href="/tags/SAML/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>SAML</span></a><a class="article-meta__tags" href="/tags/OIDC/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>OIDC</span></a><a class="article-meta__tags" href="/tags/%E8%AE%A4%E8%AF%81/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>认证</span></a><a class="article-meta__tags" href="/tags/%E6%8E%88%E6%9D%83/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>授权</span></a><a class="article-meta__tags" href="/tags/Token/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Token</span></a><a class="article-meta__tags" href="/tags/Kerberos/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Kerberos</span></a><a class="article-meta__tags" href="/tags/LDAP/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>LDAP</span></a></span></div></div><h1 class="post-title" itemprop="name headline">现代身份认证与授权技术完全指南 - OAuth、JWT、SAML 等协议详解</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-11-28T14:06:37.000Z" title="发表于 2025-11-28 14:06:37">2025-11-28</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-11-30T14:02:36.516Z" title="更新于 2025-11-30 14:02:36">2025-11-30</time></span></div><div class="meta-secondline"></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="/imgs/%E8%AE%A4%E8%AF%81%E5%92%8C%E6%8E%88%E6%9D%83%E5%B0%81%E9%9D%A2%E5%9B%BE.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://supremes.github.io/posts/64545.html"><header><a class="post-meta-categories" href="/categories/security/" itemprop="url">网络安全</a><a href="/tags/OAuth/" tabindex="-1" itemprop="url">OAuth</a><a href="/tags/JWT/" tabindex="-1" itemprop="url">JWT</a><a href="/tags/SAML/" tabindex="-1" itemprop="url">SAML</a><a href="/tags/OIDC/" tabindex="-1" itemprop="url">OIDC</a><a href="/tags/%E8%AE%A4%E8%AF%81/" tabindex="-1" itemprop="url">认证</a><a href="/tags/%E6%8E%88%E6%9D%83/" tabindex="-1" itemprop="url">授权</a><a href="/tags/Token/" tabindex="-1" itemprop="url">Token</a><a href="/tags/Kerberos/" tabindex="-1" itemprop="url">Kerberos</a><a href="/tags/LDAP/" tabindex="-1" itemprop="url">LDAP</a><h1 id="CrawlerTitle" itemprop="name headline">现代身份认证与授权技术完全指南 - OAuth、JWT、SAML 等协议详解</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Supremes</span><time itemprop="dateCreated datePublished" datetime="2025-11-28T14:06:37.000Z" title="发表于 2025-11-28 14:06:37">2025-11-28</time><time itemprop="dateCreated datePublished" datetime="2025-11-30T14:02:36.516Z" title="更新于 2025-11-30 14:02:36">2025-11-30</time></header><h1 id="认证和授权完全指南"><a href="#认证和授权完全指南" class="headerlink" title="认证和授权完全指南"></a>认证和授权完全指南</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>在现代网络安全体系中，<strong>认证（Authentication）</strong> 和 <strong>授权（Authorization）</strong> 是保障系统安全的两大核心机制：</p>
<ul>
<li><strong>认证</strong>：验证用户身份（”你是谁？”）</li>
<li><strong>授权</strong>：确认访问权限（”你能做什么？”）</li>
</ul>
<p>本文将从协议和Token两个维度，系统性阐述认证授权的技术体系。</p>
<hr>
<h2 id="一、认证授权协议体系"><a href="#一、认证授权协议体系" class="headerlink" title="一、认证授权协议体系"></a>一、认证授权协议体系</h2><h3 id="1-OAuth-2-0-授权标准协议"><a href="#1-OAuth-2-0-授权标准协议" class="headerlink" title="1. OAuth 2.0 - 授权标准协议"></a>1. OAuth 2.0 - 授权标准协议</h3><p><strong>OAuth 2.0</strong> 是现代互联网授权的基石，专注于<strong>授权</strong>（资源访问权限的委派），而非直接处理用户身份认证。</p>
<h4 id="核心角色"><a href="#核心角色" class="headerlink" title="核心角色"></a>核心角色</h4><table>
<thead>
<tr>
<th>角色</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>资源所有者（Resource Owner）</td>
<td>拥有资源的用户</td>
<td>微信用户</td>
</tr>
<tr>
<td>客户端（Client）</td>
<td>请求访问资源的应用</td>
<td>第三方小程序</td>
</tr>
<tr>
<td>授权服务器（Authorization Server）</td>
<td>颁发Token的服务</td>
<td>微信授权服务器</td>
</tr>
<tr>
<td>资源服务器（Resource Server）</td>
<td>存储受保护资源的服务</td>
<td>微信用户信息API</td>
</tr>
</tbody></table>
<h4 id="四种授权模式"><a href="#四种授权模式" class="headerlink" title="四种授权模式"></a>四种授权模式</h4><ol>
<li><p><strong>授权码模式（Authorization Code）</strong></p>
<ul>
<li><strong>适用场景</strong>：Web应用（服务端安全）</li>
<li><strong>安全性</strong>：最高，推荐使用</li>
<li><strong>流程</strong>：用户授权 → 获取授权码 → 后端交换Token</li>
</ul>
</li>
<li><p><strong>隐式模式（Implicit）</strong></p>
<ul>
<li><strong>适用场景</strong>：SPA或原生App（客户端不安全）</li>
<li><strong>注意</strong>：OAuth 2.1已废弃，建议使用PKCE</li>
</ul>
</li>
<li><p><strong>密码模式（Resource Owner Password Credentials）</strong></p>
<ul>
<li><strong>适用场景</strong>：高度信任的客户端</li>
<li><strong>风险</strong>：直接暴露用户密码</li>
</ul>
</li>
<li><p><strong>客户端凭证模式（Client Credentials）</strong></p>
<ul>
<li><strong>适用场景</strong>：服务端间通信（无用户参与）</li>
<li><strong>特点</strong>：机器对机器的授权</li>
</ul>
</li>
</ol>
<h4 id="典型应用场景"><a href="#典型应用场景" class="headerlink" title="典型应用场景"></a>典型应用场景</h4><ul>
<li>第三方登录（微信、QQ、GitHub登录）</li>
<li>API访问控制</li>
<li>移动应用授权</li>
</ul>
<h3 id="2-OpenID-Connect-OIDC-身份认证层"><a href="#2-OpenID-Connect-OIDC-身份认证层" class="headerlink" title="2. OpenID Connect (OIDC) - 身份认证层"></a>2. OpenID Connect (OIDC) - 身份认证层</h3><p><strong>OpenID Connect</strong> 在OAuth 2.0基础上扩展，专门解决<strong>身份认证</strong>问题，是OAuth 2.0 + 身份认证的完整解决方案。</p>
<h4 id="核心特性"><a href="#核心特性" class="headerlink" title="核心特性"></a>核心特性</h4><ul>
<li><strong>ID Token</strong>：JWT格式，包含用户身份信息（如姓名、邮箱、用户ID）</li>
<li><strong>UserInfo端点</strong>：通过Access Token获取用户详细信息</li>
<li><strong>标准化声明</strong>：定义了标准的用户属性字段</li>
</ul>
<h4 id="OIDC-流程"><a href="#OIDC-流程" class="headerlink" title="OIDC 流程"></a>OIDC 流程</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 用户访问客户端应用</span><br><span class="line">2. 重定向到OIDC提供商进行认证</span><br><span class="line">3. 用户授权后返回授权码</span><br><span class="line">4. 客户端交换授权码获取Token</span><br><span class="line">5. 返回Access Token + ID Token</span><br><span class="line">6. 通过UserInfo端点获取用户信息</span><br></pre></td></tr></table></figure>

<h4 id="典型应用场景-1"><a href="#典型应用场景-1" class="headerlink" title="典型应用场景"></a>典型应用场景</h4><ul>
<li><strong>企业SSO</strong>：使用Google Workspace登录企业应用</li>
<li><strong>消费级SSO</strong>：使用Apple ID登录第三方应用</li>
<li><strong>跨域认证</strong>：多个子域名系统的统一登录</li>
</ul>
<h3 id="3-SAML-2-0-企业级身份联邦"><a href="#3-SAML-2-0-企业级身份联邦" class="headerlink" title="3. SAML 2.0 - 企业级身份联邦"></a>3. SAML 2.0 - 企业级身份联邦</h3><p><strong>SAML 2.0</strong> 是企业级<strong>认证与授权</strong>标准，基于XML实现跨域单点登录，在企业环境中广泛部署。</p>
<h4 id="核心架构"><a href="#核心架构" class="headerlink" title="核心架构"></a>核心架构</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Identity Provider (IdP) ←→ Service Provider (SP)</span><br><span class="line">      ↓                           ↓</span><br><span class="line">   用户认证                    资源访问</span><br></pre></td></tr></table></figure>

<h4 id="关键组件"><a href="#关键组件" class="headerlink" title="关键组件"></a>关键组件</h4><ul>
<li><strong>断言（Assertion）</strong>：XML格式的安全声明，包含用户身份和权限信息</li>
<li><strong>身份提供者（IdP）</strong>：认证用户并生成SAML断言（如企业AD）</li>
<li><strong>服务提供者（SP）</strong>：依赖IdP的断言提供服务访问（如SaaS应用）</li>
</ul>
<h4 id="SAML-SSO-流程"><a href="#SAML-SSO-流程" class="headerlink" title="SAML SSO 流程"></a>SAML SSO 流程</h4><ol>
<li>用户访问SP应用</li>
<li>SP重定向到企业IdP</li>
<li>IdP验证用户身份</li>
<li>生成SAML断言并返回SP</li>
<li>SP验证断言并授权访问</li>
</ol>
<h4 id="企业应用场景"><a href="#企业应用场景" class="headerlink" title="企业应用场景"></a>企业应用场景</h4><ul>
<li><strong>Office 365集成</strong>：通过ADFS实现企业SSO</li>
<li><strong>SaaS应用集成</strong>：Salesforce、ServiceNow等企业应用</li>
<li><strong>混合云环境</strong>：本地AD与云服务的身份联邦</li>
</ul>
<h3 id="4-LDAP-目录服务协议"><a href="#4-LDAP-目录服务协议" class="headerlink" title="4. LDAP - 目录服务协议"></a>4. LDAP - 目录服务协议</h3><p><strong>LDAP（Lightweight Directory Access Protocol）</strong> 是访问和维护目录服务的标准协议，主要用于用户和组织信息的查询与管理。</p>
<h4 id="核心功能"><a href="#核心功能" class="headerlink" title="核心功能"></a>核心功能</h4><ul>
<li><strong>目录查询</strong>：用户、组织架构、权限信息查询</li>
<li><strong>身份验证</strong>：用户名密码验证</li>
<li><strong>属性管理</strong>：用户属性的增删改查</li>
</ul>
<h4 id="常见实现"><a href="#常见实现" class="headerlink" title="常见实现"></a>常见实现</h4><ul>
<li><strong>Microsoft Active Directory (AD)</strong>：Windows域环境的标准</li>
<li><strong>OpenLDAP</strong>：开源LDAP实现</li>
<li><strong>Apache Directory Server</strong>：Java实现的LDAP服务</li>
</ul>
<h4 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h4><ul>
<li>企业内部用户认证（VPN、邮箱、OA系统）</li>
<li>组织架构管理</li>
<li>权限控制和用户属性查询</li>
</ul>
<h3 id="5-Kerberos-票据认证协议"><a href="#5-Kerberos-票据认证协议" class="headerlink" title="5. Kerberos - 票据认证协议"></a>5. Kerberos - 票据认证协议</h3><p><strong>Kerberos</strong> 是基于票据的网络认证协议，通过密钥分发中心（KDC）实现安全认证，有效防止中间人攻击。</p>
<h4 id="核心组件"><a href="#核心组件" class="headerlink" title="核心组件"></a>核心组件</h4><ul>
<li><strong>KDC（Key Distribution Center）</strong>：密钥分发中心</li>
<li><strong>TGT（Ticket-Granting Ticket）</strong>：用户首次认证后的长期票据</li>
<li><strong>服务票据（Service Ticket）</strong>：访问具体服务的临时票据</li>
</ul>
<h4 id="Kerberos-认证流程"><a href="#Kerberos-认证流程" class="headerlink" title="Kerberos 认证流程"></a>Kerberos 认证流程</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Client → AS (Authentication Server): AS_REQ</span><br><span class="line">AS → Client: AS_REP (TGT)</span><br><span class="line">Client → TGS (Ticket-Granting Server): TGS_REQ (TGT)</span><br><span class="line">TGS → Client: TGS_REP (Service Ticket)</span><br><span class="line">Client → Service: AP_REQ (Service Ticket)</span><br></pre></td></tr></table></figure>

<h4 id="典型应用"><a href="#典型应用" class="headerlink" title="典型应用"></a>典型应用</h4><ul>
<li><strong>Windows域环境</strong>：AD域的默认认证机制</li>
<li><strong>Hadoop集群</strong>：大数据平台的安全认证</li>
<li><strong>企业网络</strong>：内网资源的安全访问</li>
</ul>
<hr>
<h2 id="二、Token技术体系"><a href="#二、Token技术体系" class="headerlink" title="二、Token技术体系"></a>二、Token技术体系</h2><h3 id="1-Access-Token-资源访问凭证"><a href="#1-Access-Token-资源访问凭证" class="headerlink" title="1. Access Token - 资源访问凭证"></a>1. Access Token - 资源访问凭证</h3><p><strong>Access Token</strong> 是客户端访问资源服务器的核心凭证，是OAuth 2.0体系的关键组件。</p>
<h4 id="Token格式对比"><a href="#Token格式对比" class="headerlink" title="Token格式对比"></a>Token格式对比</h4><table>
<thead>
<tr>
<th>类型</th>
<th>特点</th>
<th>验证方式</th>
<th>适用场景</th>
</tr>
</thead>
<tbody><tr>
<td><strong>不透明Token</strong></td>
<td>随机字符串，无法解析</td>
<td>需调用授权服务器验证</td>
<td>高安全要求的企业环境</td>
</tr>
<tr>
<td><strong>JWT Token</strong></td>
<td>自包含，可本地解析</td>
<td>本地验证签名</td>
<td>微服务、分布式系统</td>
</tr>
</tbody></table>
<h4 id="生命周期管理"><a href="#生命周期管理" class="headerlink" title="生命周期管理"></a>生命周期管理</h4><ul>
<li><strong>短期有效</strong>：通常1小时内过期</li>
<li><strong>续期机制</strong>：配合Refresh Token实现自动续期</li>
<li><strong>撤销能力</strong>：支持主动撤销和黑名单机制</li>
</ul>
<h3 id="2-Refresh-Token-令牌续期机制"><a href="#2-Refresh-Token-令牌续期机制" class="headerlink" title="2. Refresh Token - 令牌续期机制"></a>2. Refresh Token - 令牌续期机制</h3><p><strong>Refresh Token</strong> 专门用于在Access Token过期后获取新的Access Token，实现长期会话管理。</p>
<h4 id="核心特性-1"><a href="#核心特性-1" class="headerlink" title="核心特性"></a>核心特性</h4><ul>
<li><strong>长期有效性</strong>：7-30天有效期，但可被撤销</li>
<li><strong>存储限制</strong>：仅在客户端和授权服务器间流转</li>
<li><strong>单次使用</strong>：使用后立即失效，返回新的Refresh Token（Rotation机制）</li>
</ul>
<h4 id="安全要求"><a href="#安全要求" class="headerlink" title="安全要求"></a>安全要求</h4><ul>
<li><strong>HTTPS传输</strong>：防止网络传输中被截获</li>
<li><strong>安全存储</strong>：客户端需安全存储（如Keychain、Keystore）</li>
<li><strong>撤销机制</strong>：支持用户主动撤销或异常检测自动撤销</li>
</ul>
<h3 id="3-ID-Token-身份信息载体"><a href="#3-ID-Token-身份信息载体" class="headerlink" title="3. ID Token - 身份信息载体"></a>3. ID Token - 身份信息载体</h3><p><strong>ID Token</strong> 是OpenID Connect的核心组件，以JWT格式承载用户身份信息。</p>
<h4 id="标准声明（Claims）"><a href="#标准声明（Claims）" class="headerlink" title="标准声明（Claims）"></a>标准声明（Claims）</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;iss&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://accounts.google.com&quot;</span><span class="punctuation">,</span>        <span class="comment">// 发行者</span></span><br><span class="line">  <span class="attr">&quot;sub&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1234567890&quot;</span><span class="punctuation">,</span>                         <span class="comment">// 用户唯一标识</span></span><br><span class="line">  <span class="attr">&quot;aud&quot;</span><span class="punctuation">:</span> <span class="string">&quot;your-client-id&quot;</span><span class="punctuation">,</span>                     <span class="comment">// 目标客户端</span></span><br><span class="line">  <span class="attr">&quot;exp&quot;</span><span class="punctuation">:</span> <span class="number">1620000000</span><span class="punctuation">,</span>                           <span class="comment">// 过期时间</span></span><br><span class="line">  <span class="attr">&quot;iat&quot;</span><span class="punctuation">:</span> <span class="number">1619996400</span><span class="punctuation">,</span>                           <span class="comment">// 签发时间</span></span><br><span class="line">  <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user@example.com&quot;</span><span class="punctuation">,</span>                 <span class="comment">// 邮箱</span></span><br><span class="line">  <span class="attr">&quot;email_verified&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span>                      <span class="comment">// 邮箱验证状态</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;John Doe&quot;</span><span class="punctuation">,</span>                          <span class="comment">// 姓名</span></span><br><span class="line">  <span class="attr">&quot;picture&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://example.com/avatar.jpg&quot;</span>  <span class="comment">// 头像</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="安全特性"><a href="#安全特性" class="headerlink" title="安全特性"></a>安全特性</h4><ul>
<li><strong>数字签名</strong>：RS256&#x2F;ES256算法签名，防篡改</li>
<li><strong>时效性</strong>：短期有效（通常15-60分钟）</li>
<li><strong>完整性</strong>：包含完整的用户身份信息</li>
</ul>
<h3 id="4-JWT-自包含令牌标准"><a href="#4-JWT-自包含令牌标准" class="headerlink" title="4. JWT - 自包含令牌标准"></a>4. JWT - 自包含令牌标准</h3><p><strong>JWT（JSON Web Token）</strong> 是一种开放标准（RFC 7519），用于在各方之间安全地传输信息。</p>
<h4 id="三段式结构"><a href="#三段式结构" class="headerlink" title="三段式结构"></a>三段式结构</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Header.Payload.Signature</span><br></pre></td></tr></table></figure>

<h4 id="详细结构解析"><a href="#详细结构解析" class="headerlink" title="详细结构解析"></a>详细结构解析</h4><p><strong>Header（头部）</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;alg&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RS256&quot;</span><span class="punctuation">,</span>    <span class="comment">// 签名算法</span></span><br><span class="line">  <span class="attr">&quot;typ&quot;</span><span class="punctuation">:</span> <span class="string">&quot;JWT&quot;</span><span class="punctuation">,</span>      <span class="comment">// 令牌类型</span></span><br><span class="line">  <span class="attr">&quot;kid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;key-id&quot;</span>    <span class="comment">// 密钥标识</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>Payload（负载）</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;sub&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user123&quot;</span><span class="punctuation">,</span>           <span class="comment">// 主题（用户ID）</span></span><br><span class="line">  <span class="attr">&quot;iat&quot;</span><span class="punctuation">:</span> <span class="number">1646092800</span><span class="punctuation">,</span>          <span class="comment">// 签发时间</span></span><br><span class="line">  <span class="attr">&quot;exp&quot;</span><span class="punctuation">:</span> <span class="number">1646096400</span><span class="punctuation">,</span>          <span class="comment">// 过期时间</span></span><br><span class="line">  <span class="attr">&quot;scope&quot;</span><span class="punctuation">:</span> <span class="string">&quot;read write&quot;</span><span class="punctuation">,</span>      <span class="comment">// 权限范围</span></span><br><span class="line">  <span class="attr">&quot;aud&quot;</span><span class="punctuation">:</span> <span class="string">&quot;api.example.com&quot;</span>    <span class="comment">// 受众</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>Signature（签名）</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">RSASHA256(</span><br><span class="line">  base64UrlEncode(header) + &quot;.&quot; +</span><br><span class="line">  base64UrlEncode(payload),</span><br><span class="line">  private_key</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h4 id="算法选择指南"><a href="#算法选择指南" class="headerlink" title="算法选择指南"></a>算法选择指南</h4><table>
<thead>
<tr>
<th>算法</th>
<th>类型</th>
<th>安全性</th>
<th>适用场景</th>
</tr>
</thead>
<tbody><tr>
<td><strong>HS256</strong></td>
<td>对称加密</td>
<td>中等</td>
<td>内部微服务</td>
</tr>
<tr>
<td><strong>RS256</strong></td>
<td>非对称加密</td>
<td>高</td>
<td>跨域认证</td>
</tr>
<tr>
<td><strong>ES256</strong></td>
<td>椭圆曲线</td>
<td>高</td>
<td>移动端应用</td>
</tr>
</tbody></table>
<h4 id="安全注意事项"><a href="#安全注意事项" class="headerlink" title="安全注意事项"></a>安全注意事项</h4><ul>
<li><strong>密钥管理</strong>：定期轮换签名密钥</li>
<li><strong>算法验证</strong>：明确指定允许的签名算法</li>
<li><strong>时效控制</strong>：设置合理的过期时间</li>
<li><strong>敏感信息</strong>：避免在Payload中包含敏感数据</li>
</ul>
<h3 id="5-Session-Token-会话状态管理"><a href="#5-Session-Token-会话状态管理" class="headerlink" title="5. Session Token - 会话状态管理"></a>5. Session Token - 会话状态管理</h3><p><strong>Session Token</strong> 是传统的会话管理机制，通过服务端状态存储维护用户会话。</p>
<h4 id="架构模式"><a href="#架构模式" class="headerlink" title="架构模式"></a>架构模式</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Client (SessionID) ←→ Server (Session Store)</span><br><span class="line">                           ↓</span><br><span class="line">                    Redis/Database/Memory</span><br></pre></td></tr></table></figure>

<h4 id="存储策略"><a href="#存储策略" class="headerlink" title="存储策略"></a>存储策略</h4><p><strong>服务端存储</strong></p>
<ul>
<li><strong>内存存储</strong>：性能最优，但不支持集群</li>
<li><strong>Redis集群</strong>：高性能分布式存储</li>
<li><strong>数据库存储</strong>：持久化但性能较低</li>
</ul>
<p><strong>客户端传输</strong></p>
<ul>
<li><strong>HTTP Cookie</strong>：自动传输，支持HttpOnly和Secure标志</li>
<li><strong>LocalStorage</strong>：手动管理，存在XSS风险</li>
</ul>
<h4 id="Session-vs-JWT-对比"><a href="#Session-vs-JWT-对比" class="headerlink" title="Session vs JWT 对比"></a>Session vs JWT 对比</h4><table>
<thead>
<tr>
<th>特性</th>
<th>Session Token</th>
<th>JWT</th>
</tr>
</thead>
<tbody><tr>
<td><strong>状态管理</strong></td>
<td>有状态（服务端存储）</td>
<td>无状态（自包含）</td>
</tr>
<tr>
<td><strong>扩展性</strong></td>
<td>需要共享存储</td>
<td>天然支持分布式</td>
</tr>
<tr>
<td><strong>性能</strong></td>
<td>需要查库验证</td>
<td>本地验证</td>
</tr>
<tr>
<td><strong>撤销能力</strong></td>
<td>立即撤销</td>
<td>需要黑名单机制</td>
</tr>
<tr>
<td><strong>存储开销</strong></td>
<td>服务端存储成本</td>
<td>网络传输成本</td>
</tr>
</tbody></table>
<h3 id="6-SAML-断言-XML安全声明"><a href="#6-SAML-断言-XML安全声明" class="headerlink" title="6. SAML 断言 - XML安全声明"></a>6. SAML 断言 - XML安全声明</h3><p><strong>SAML断言</strong> 是SAML 2.0协议的核心载体，以XML格式承载安全声明信息。</p>
<h4 id="断言类型"><a href="#断言类型" class="headerlink" title="断言类型"></a>断言类型</h4><p><strong>认证断言（Authentication Assertion）</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">saml:Assertion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">saml:AuthnStatement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">saml:AuthnContext</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">saml:AuthnContextClassRef</span>&gt;</span></span><br><span class="line">        urn:oasis:names:tc:SAML:2.0:ac:classes:Password</span><br><span class="line">      <span class="tag">&lt;/<span class="name">saml:AuthnContextClassRef</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">saml:AuthnContext</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">saml:AuthnStatement</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">saml:Assertion</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>属性断言（Attribute Assertion）</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">saml:AttributeStatement</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">saml:Attribute</span> <span class="attr">Name</span>=<span class="string">&quot;email&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">saml:AttributeValue</span>&gt;</span>user@company.com<span class="tag">&lt;/<span class="name">saml:AttributeValue</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">saml:Attribute</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">saml:Attribute</span> <span class="attr">Name</span>=<span class="string">&quot;department&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">saml:AttributeValue</span>&gt;</span>Engineering<span class="tag">&lt;/<span class="name">saml:AttributeValue</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">saml:Attribute</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">saml:AttributeStatement</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>授权决策断言（Authorization Decision Assertion）</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">saml:AuthzDecisionStatement</span> <span class="attr">Resource</span>=<span class="string">&quot;https://app.company.com&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">Decision</span>=<span class="string">&quot;Permit&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">saml:Action</span>&gt;</span>Read<span class="tag">&lt;/<span class="name">saml:Action</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">saml:Action</span>&gt;</span>Write<span class="tag">&lt;/<span class="name">saml:Action</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">saml:AuthzDecisionStatement</span>&gt;</span></span><br></pre></td></tr></table></figure>


<hr>
<h2 id="三、协议与Token协同架构"><a href="#三、协议与Token协同架构" class="headerlink" title="三、协议与Token协同架构"></a>三、协议与Token协同架构</h2><h3 id="1-OAuth-2-0-OpenID-Connect-组合"><a href="#1-OAuth-2-0-OpenID-Connect-组合" class="headerlink" title="1. OAuth 2.0 + OpenID Connect 组合"></a>1. OAuth 2.0 + OpenID Connect 组合</h3><p>这是现代应用最常用的认证授权组合，同时解决身份认证和资源授权问题。</p>
<h4 id="完整流程"><a href="#完整流程" class="headerlink" title="完整流程"></a>完整流程</h4><pre class="mermaid">sequenceDiagram
    participant User as 用户
    participant Client as 客户端应用
    participant AuthServer as 认证服务器
    participant Resource as 资源服务器

    User->>Client: 访问应用
    Client->>AuthServer: 重定向到认证页面
    User->>AuthServer: 登录并授权
    AuthServer->>Client: 返回授权码
    Client->>AuthServer: 交换Token
    AuthServer->>Client: 返回Access Token + ID Token
    Client->>Resource: 使用Access Token访问资源
    Client->>AuthServer: 使用Access Token获取UserInfo</pre>

<h4 id="技术优势"><a href="#技术优势" class="headerlink" title="技术优势"></a>技术优势</h4><ul>
<li><strong>职责分离</strong>：OAuth负责授权，OIDC负责认证</li>
<li><strong>标准化</strong>：广泛的行业支持和互操作性</li>
<li><strong>安全性</strong>：多层安全机制和最佳实践</li>
<li><strong>灵活性</strong>：支持多种客户端类型和场景</li>
</ul>
<h3 id="2-SAML-LDAP-企业集成"><a href="#2-SAML-LDAP-企业集成" class="headerlink" title="2. SAML + LDAP 企业集成"></a>2. SAML + LDAP 企业集成</h3><p>传统企业环境中，SAML和LDAP的组合提供了完整的企业身份管理解决方案。</p>
<h4 id="集成架构"><a href="#集成架构" class="headerlink" title="集成架构"></a>集成架构</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Enterprise AD/LDAP ←→ SAML IdP ←→ SaaS Applications</span><br><span class="line">       ↓                ↓              ↓</span><br><span class="line">   用户目录        身份联邦        业务应用</span><br></pre></td></tr></table></figure>

<h4 id="集成流程"><a href="#集成流程" class="headerlink" title="集成流程"></a>集成流程</h4><ol>
<li><strong>用户认证</strong>：用户通过企业AD&#x2F;LDAP进行身份验证</li>
<li><strong>断言生成</strong>：IdP生成包含用户属性的SAML断言</li>
<li><strong>应用授权</strong>：SaaS应用验证SAML断言并授权访问</li>
<li><strong>属性同步</strong>：通过LDAP查询获取最新的用户属性</li>
</ol>
<h4 id="企业价值"><a href="#企业价值" class="headerlink" title="企业价值"></a>企业价值</h4><ul>
<li><strong>统一身份</strong>：一套用户目录管理所有应用</li>
<li><strong>合规要求</strong>：满足企业安全和合规标准</li>
<li><strong>成本效益</strong>：减少重复的身份管理工作</li>
</ul>
<hr>
<h2 id="四、安全最佳实践"><a href="#四、安全最佳实践" class="headerlink" title="四、安全最佳实践"></a>四、安全最佳实践</h2><h3 id="1-传输层安全"><a href="#1-传输层安全" class="headerlink" title="1. 传输层安全"></a>1. 传输层安全</h3><h4 id="HTTPS-强制要求"><a href="#HTTPS-强制要求" class="headerlink" title="HTTPS 强制要求"></a>HTTPS 强制要求</h4><ul>
<li><strong>所有Token传输</strong>必须使用HTTPS加密</li>
<li><strong>证书验证</strong>：确保SSL证书有效性和域名匹配</li>
<li><strong>HSTS策略</strong>：启用HTTP严格传输安全</li>
</ul>
<h4 id="Token传输方式"><a href="#Token传输方式" class="headerlink" title="Token传输方式"></a>Token传输方式</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># ✅ 推荐：Authorization Header</span><br><span class="line"><span class="attribute">Authorization</span><span class="punctuation">: </span>Bearer eyJhbGciOiJSUzI1NiIs...</span><br><span class="line"></span><br><span class="line"># ❌ 避免：URL参数传递</span><br><span class="line">GET /api/user?access_token=eyJhbGciOiJSUzI1NiIs...</span><br></pre></td></tr></table></figure>

<h3 id="2-存储安全策略"><a href="#2-存储安全策略" class="headerlink" title="2. 存储安全策略"></a>2. 存储安全策略</h3><h4 id="浏览器端安全存储"><a href="#浏览器端安全存储" class="headerlink" title="浏览器端安全存储"></a>浏览器端安全存储</h4><table>
<thead>
<tr>
<th>存储方式</th>
<th>安全性</th>
<th>XSS风险</th>
<th>CSRF风险</th>
<th>推荐场景</th>
</tr>
</thead>
<tbody><tr>
<td><strong>HttpOnly Cookie</strong></td>
<td>高</td>
<td>免疫</td>
<td>需防护</td>
<td>传统Web应用</td>
</tr>
<tr>
<td><strong>Secure Cookie</strong></td>
<td>高</td>
<td>免疫</td>
<td>需防护</td>
<td>HTTPS环境</td>
</tr>
<tr>
<td><strong>LocalStorage</strong></td>
<td>低</td>
<td>高风险</td>
<td>免疫</td>
<td>不推荐存储敏感Token</td>
</tr>
<tr>
<td><strong>Memory</strong></td>
<td>最高</td>
<td>免疫</td>
<td>免疫</td>
<td>SPA短期存储</td>
</tr>
</tbody></table>
<h4 id="移动端安全存储"><a href="#移动端安全存储" class="headerlink" title="移动端安全存储"></a>移动端安全存储</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// iOS - Keychain Services</span></span><br><span class="line"><span class="keyword">const</span> keychain = <span class="built_in">require</span>(<span class="string">&#x27;react-native-keychain&#x27;</span>);</span><br><span class="line">keychain.<span class="title function_">setInternetCredentials</span>(<span class="string">&#x27;server&#x27;</span>, <span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;token&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Android - Keystore</span></span><br><span class="line"><span class="keyword">import</span> &#123; encrypt, decrypt &#125; <span class="keyword">from</span> <span class="string">&#x27;react-native-keystore&#x27;</span>;</span><br><span class="line"><span class="title function_">encrypt</span>(<span class="string">&#x27;tokenKey&#x27;</span>, accessToken);</span><br></pre></td></tr></table></figure>

<h3 id="3-密钥管理体系"><a href="#3-密钥管理体系" class="headerlink" title="3. 密钥管理体系"></a>3. 密钥管理体系</h3><h4 id="密钥轮换策略"><a href="#密钥轮换策略" class="headerlink" title="密钥轮换策略"></a>密钥轮换策略</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">JWT签名密钥轮换:</span></span><br><span class="line">  <span class="string">频率:</span> <span class="string">每3-6个月</span></span><br><span class="line">  <span class="string">过程:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="string">生成新密钥</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">同时支持新旧密钥验证</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">逐步淘汰旧密钥</span></span><br><span class="line">  </span><br><span class="line"><span class="string">密钥存储:</span></span><br><span class="line">  <span class="string">开发环境:</span> <span class="string">环境变量</span></span><br><span class="line">  <span class="string">生产环境:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="string">AWS</span> <span class="string">KMS</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Azure</span> <span class="string">Key</span> <span class="string">Vault</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">HashiCorp</span> <span class="string">Vault</span></span><br></pre></td></tr></table></figure>

<h4 id="密钥管理最佳实践"><a href="#密钥管理最佳实践" class="headerlink" title="密钥管理最佳实践"></a>密钥管理最佳实践</h4><ul>
<li><strong>分离存储</strong>：密钥与应用代码分离</li>
<li><strong>访问控制</strong>：最小权限原则</li>
<li><strong>审计日志</strong>：记录所有密钥操作</li>
<li><strong>备份恢复</strong>：建立密钥备份和恢复机制</li>
</ul>
<h3 id="4-攻击防护机制"><a href="#4-攻击防护机制" class="headerlink" title="4. 攻击防护机制"></a>4. 攻击防护机制</h3><h4 id="重放攻击防护"><a href="#重放攻击防护" class="headerlink" title="重放攻击防护"></a>重放攻击防护</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;jti&quot;</span><span class="punctuation">:</span> <span class="string">&quot;unique-token-id&quot;</span><span class="punctuation">,</span>     <span class="comment">// JWT ID，防止重复使用</span></span><br><span class="line">  <span class="attr">&quot;iat&quot;</span><span class="punctuation">:</span> <span class="number">1646092800</span><span class="punctuation">,</span>            <span class="comment">// 签发时间</span></span><br><span class="line">  <span class="attr">&quot;exp&quot;</span><span class="punctuation">:</span> <span class="number">1646096400</span><span class="punctuation">,</span>            <span class="comment">// 过期时间</span></span><br><span class="line">  <span class="attr">&quot;nonce&quot;</span><span class="punctuation">:</span> <span class="string">&quot;random-value&quot;</span>       <span class="comment">// 随机数，OIDC中使用</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="常见攻击与防护"><a href="#常见攻击与防护" class="headerlink" title="常见攻击与防护"></a>常见攻击与防护</h4><table>
<thead>
<tr>
<th>攻击类型</th>
<th>防护措施</th>
<th>实现方式</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Token劫持</strong></td>
<td>HTTPS + Secure Cookie</td>
<td>传输加密</td>
</tr>
<tr>
<td><strong>XSS攻击</strong></td>
<td>HttpOnly Cookie + CSP</td>
<td>存储隔离</td>
</tr>
<tr>
<td><strong>CSRF攻击</strong></td>
<td>SameSite Cookie + CSRF Token</td>
<td>跨站防护</td>
</tr>
<tr>
<td><strong>重放攻击</strong></td>
<td>时间戳 + Nonce + JTI</td>
<td>唯一性验证</td>
</tr>
</tbody></table>
<hr>
<h2 id="五、技术选型指南"><a href="#五、技术选型指南" class="headerlink" title="五、技术选型指南"></a>五、技术选型指南</h2><h3 id="场景化选型矩阵"><a href="#场景化选型矩阵" class="headerlink" title="场景化选型矩阵"></a>场景化选型矩阵</h3><table>
<thead>
<tr>
<th>应用场景</th>
<th>推荐协议</th>
<th>Token类型</th>
<th>优势</th>
<th>考虑因素</th>
</tr>
</thead>
<tbody><tr>
<td><strong>消费级应用</strong></td>
<td>OAuth 2.0 + OIDC</td>
<td>Access Token + ID Token</td>
<td>标准化、易集成</td>
<td>用户体验</td>
</tr>
<tr>
<td><strong>企业SSO</strong></td>
<td>SAML 2.0</td>
<td>SAML断言</td>
<td>成熟稳定、合规</td>
<td>复杂度较高</td>
</tr>
<tr>
<td><strong>移动应用</strong></td>
<td>OIDC + JWT</td>
<td>JWT + Refresh Token</td>
<td>离线可用、性能好</td>
<td>存储安全</td>
</tr>
<tr>
<td><strong>微服务架构</strong></td>
<td>JWT</td>
<td>自包含JWT</td>
<td>无状态、可扩展</td>
<td>密钥管理</td>
</tr>
<tr>
<td><strong>API网关</strong></td>
<td>OAuth 2.0</td>
<td>Bearer Token</td>
<td>细粒度控制</td>
<td>性能要求</td>
</tr>
</tbody></table>
<h3 id="现代化选型建议"><a href="#现代化选型建议" class="headerlink" title="现代化选型建议"></a>现代化选型建议</h3><h4 id="新项目推荐"><a href="#新项目推荐" class="headerlink" title="新项目推荐"></a>新项目推荐</h4><ol>
<li><strong>OAuth 2.1 + OIDC</strong>：现代应用的首选</li>
<li><strong>PKCE扩展</strong>：公共客户端必须启用</li>
<li><strong>JWT格式</strong>：Access Token使用JWT格式</li>
<li><strong>短期Token</strong>：Access Token 15-60分钟过期</li>
</ol>
<h4 id="企业级要求"><a href="#企业级要求" class="headerlink" title="企业级要求"></a>企业级要求</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">安全要求:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">SAML</span> <span class="number">2.0</span><span class="string">用于企业SSO</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">mTLS用于服务间通信</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">HSM用于密钥存储</span></span><br><span class="line"></span><br><span class="line"><span class="string">合规要求:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">GDPR:</span> <span class="string">数据保护和用户同意</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">SOX:</span> <span class="string">访问控制和审计</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">HIPAA:</span> <span class="string">医疗数据保护</span></span><br></pre></td></tr></table></figure>

<h3 id="实施路线图"><a href="#实施路线图" class="headerlink" title="实施路线图"></a>实施路线图</h3><h4 id="第一阶段：基础实施"><a href="#第一阶段：基础实施" class="headerlink" title="第一阶段：基础实施"></a>第一阶段：基础实施</h4><ul>
<li><input disabled="" type="checkbox"> 选择认证协议（OAuth 2.0 + OIDC）</li>
<li><input disabled="" type="checkbox"> 部署身份提供商（如Auth0、Okta）</li>
<li><input disabled="" type="checkbox"> 实现基础的登录登出功能</li>
<li><input disabled="" type="checkbox"> 配置HTTPS和基础安全策略</li>
</ul>
<h4 id="第二阶段：安全加固"><a href="#第二阶段：安全加固" class="headerlink" title="第二阶段：安全加固"></a>第二阶段：安全加固</h4><ul>
<li><input disabled="" type="checkbox"> 启用多因素认证（MFA）</li>
<li><input disabled="" type="checkbox"> 实施Token轮换和撤销</li>
<li><input disabled="" type="checkbox"> 配置安全存储和传输</li>
<li><input disabled="" type="checkbox"> 建立监控和审计机制</li>
</ul>
<h4 id="第三阶段：高级特性"><a href="#第三阶段：高级特性" class="headerlink" title="第三阶段：高级特性"></a>第三阶段：高级特性</h4><ul>
<li><input disabled="" type="checkbox"> 细粒度权限控制（RBAC&#x2F;ABAC）</li>
<li><input disabled="" type="checkbox"> 跨域SSO集成</li>
<li><input disabled="" type="checkbox"> 零信任架构实施</li>
<li><input disabled="" type="checkbox"> 持续安全评估</li>
</ul>
<h2 id="六、技术发展趋势"><a href="#六、技术发展趋势" class="headerlink" title="六、技术发展趋势"></a>六、技术发展趋势</h2><h3 id="新兴技术标准"><a href="#新兴技术标准" class="headerlink" title="新兴技术标准"></a>新兴技术标准</h3><h4 id="OAuth-2-1"><a href="#OAuth-2-1" class="headerlink" title="OAuth 2.1"></a>OAuth 2.1</h4><p>OAuth 2.1整合了OAuth 2.0的安全最佳实践，主要改进包括：</p>
<ul>
<li><strong>强制PKCE</strong>：所有公共客户端必须使用PKCE</li>
<li><strong>移除隐式流</strong>：不再支持隐式授权模式</li>
<li><strong>刷新令牌安全</strong>：强化Refresh Token的安全要求</li>
</ul>
<h4 id="WebAuthn-FIDO2"><a href="#WebAuthn-FIDO2" class="headerlink" title="WebAuthn (FIDO2)"></a>WebAuthn (FIDO2)</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// WebAuthn注册示例</span></span><br><span class="line"><span class="keyword">const</span> credential = <span class="keyword">await</span> navigator.<span class="property">credentials</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">publicKey</span>: &#123;</span><br><span class="line">    <span class="attr">challenge</span>: <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(<span class="number">32</span>),</span><br><span class="line">    <span class="attr">rp</span>: &#123; <span class="attr">name</span>: <span class="string">&quot;Example Corp&quot;</span> &#125;,</span><br><span class="line">    <span class="attr">user</span>: &#123;</span><br><span class="line">      <span class="attr">id</span>: <span class="keyword">new</span> <span class="title class_">TextEncoder</span>().<span class="title function_">encode</span>(<span class="string">&quot;user123&quot;</span>),</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;user@example.com&quot;</span>,</span><br><span class="line">      <span class="attr">displayName</span>: <span class="string">&quot;John Doe&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">pubKeyCredParams</span>: [&#123;<span class="attr">alg</span>: -<span class="number">7</span>, <span class="attr">type</span>: <span class="string">&quot;public-key&quot;</span>&#125;],</span><br><span class="line">    <span class="attr">authenticatorSelection</span>: &#123;</span><br><span class="line">      <span class="attr">authenticatorAttachment</span>: <span class="string">&quot;platform&quot;</span>,</span><br><span class="line">      <span class="attr">userVerification</span>: <span class="string">&quot;required&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="零信任架构下的认证"><a href="#零信任架构下的认证" class="headerlink" title="零信任架构下的认证"></a>零信任架构下的认证</h3><h4 id="动态授权模型"><a href="#动态授权模型" class="headerlink" title="动态授权模型"></a>动态授权模型</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">零信任原则:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">永不信任，始终验证</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">最小权限访问</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">持续验证和监控</span></span><br><span class="line"></span><br><span class="line"><span class="string">实施策略:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">基于风险的自适应认证</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">上下文感知的访问控制</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">实时威胁检测和响应</span></span><br></pre></td></tr></table></figure>

<h3 id="标准参考文档"><a href="#标准参考文档" class="headerlink" title="标准参考文档"></a>标准参考文档</h3><h4 id="RFC标准"><a href="#RFC标准" class="headerlink" title="RFC标准"></a>RFC标准</h4><ul>
<li><strong>RFC 6749</strong>: OAuth 2.0 Authorization Framework</li>
<li><strong>RFC 7519</strong>: JSON Web Token (JWT)</li>
<li><strong>RFC 7636</strong>: Proof Key for Code Exchange (PKCE)</li>
<li><strong>RFC 8414</strong>: OAuth 2.0 Authorization Server Metadata</li>
</ul>
<h4 id="安全框架"><a href="#安全框架" class="headerlink" title="安全框架"></a>安全框架</h4><ul>
<li><strong>OWASP API Security Top 10</strong>: API安全最佳实践</li>
<li><strong>NIST Cybersecurity Framework</strong>: 网络安全框架</li>
<li><strong>ISO 27001</strong>: 信息安全管理体系标准</li>
</ul>
<hr>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>认证和授权技术体系正在快速发展，从传统的Session管理到现代的JWT和OAuth体系，再到新兴的零信任架构，技术选择需要综合考虑安全性、可用性、可扩展性等多个维度。</p>
<p><strong>关键要点：</strong></p>
<ol>
<li><strong>OAuth 2.0 + OIDC</strong> 是现代应用的主流选择</li>
<li><strong>JWT</strong> 在微服务架构中具有显著优势</li>
<li><strong>SAML</strong> 在企业环境中仍然重要</li>
<li><strong>安全性</strong> 始终是第一考虑因素</li>
<li><strong>标准化</strong> 有助于系统集成和维护</li>
</ol>
<p>选择合适的认证授权方案，需要基于具体的业务场景、技术架构和安全要求进行综合评估。</p>
</article><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/57222.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Objective-C 面向对象编程详解</div></div></a></div><div class="next-post pull-right"><a href="/posts/6104.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/imgs/credential%E8%AF%81%E4%B9%A6.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">数字证书与 PKI 技术详解</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%A4%E8%AF%81%E5%92%8C%E6%8E%88%E6%9D%83%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97"><span class="toc-text">认证和授权完全指南</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E8%AE%A4%E8%AF%81%E6%8E%88%E6%9D%83%E5%8D%8F%E8%AE%AE%E4%BD%93%E7%B3%BB"><span class="toc-text">一、认证授权协议体系</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-OAuth-2-0-%E6%8E%88%E6%9D%83%E6%A0%87%E5%87%86%E5%8D%8F%E8%AE%AE"><span class="toc-text">1. OAuth 2.0 - 授权标准协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E8%A7%92%E8%89%B2"><span class="toc-text">核心角色</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9B%E7%A7%8D%E6%8E%88%E6%9D%83%E6%A8%A1%E5%BC%8F"><span class="toc-text">四种授权模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B8%E5%9E%8B%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">典型应用场景</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-OpenID-Connect-OIDC-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E5%B1%82"><span class="toc-text">2. OpenID Connect (OIDC) - 身份认证层</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E7%89%B9%E6%80%A7"><span class="toc-text">核心特性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OIDC-%E6%B5%81%E7%A8%8B"><span class="toc-text">OIDC 流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B8%E5%9E%8B%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-1"><span class="toc-text">典型应用场景</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-SAML-2-0-%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%BA%AB%E4%BB%BD%E8%81%94%E9%82%A6"><span class="toc-text">3. SAML 2.0 - 企业级身份联邦</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%9E%B6%E6%9E%84"><span class="toc-text">核心架构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E7%BB%84%E4%BB%B6"><span class="toc-text">关键组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SAML-SSO-%E6%B5%81%E7%A8%8B"><span class="toc-text">SAML SSO 流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">企业应用场景</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-LDAP-%E7%9B%AE%E5%BD%95%E6%9C%8D%E5%8A%A1%E5%8D%8F%E8%AE%AE"><span class="toc-text">4. LDAP - 目录服务协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD"><span class="toc-text">核心功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E5%AE%9E%E7%8E%B0"><span class="toc-text">常见实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">应用场景</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Kerberos-%E7%A5%A8%E6%8D%AE%E8%AE%A4%E8%AF%81%E5%8D%8F%E8%AE%AE"><span class="toc-text">5. Kerberos - 票据认证协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6"><span class="toc-text">核心组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Kerberos-%E8%AE%A4%E8%AF%81%E6%B5%81%E7%A8%8B"><span class="toc-text">Kerberos 认证流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B8%E5%9E%8B%E5%BA%94%E7%94%A8"><span class="toc-text">典型应用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81Token%E6%8A%80%E6%9C%AF%E4%BD%93%E7%B3%BB"><span class="toc-text">二、Token技术体系</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Access-Token-%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE%E5%87%AD%E8%AF%81"><span class="toc-text">1. Access Token - 资源访问凭证</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Token%E6%A0%BC%E5%BC%8F%E5%AF%B9%E6%AF%94"><span class="toc-text">Token格式对比</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%AE%A1%E7%90%86"><span class="toc-text">生命周期管理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Refresh-Token-%E4%BB%A4%E7%89%8C%E7%BB%AD%E6%9C%9F%E6%9C%BA%E5%88%B6"><span class="toc-text">2. Refresh Token - 令牌续期机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E7%89%B9%E6%80%A7-1"><span class="toc-text">核心特性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E8%A6%81%E6%B1%82"><span class="toc-text">安全要求</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-ID-Token-%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF%E8%BD%BD%E4%BD%93"><span class="toc-text">3. ID Token - 身份信息载体</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%87%E5%87%86%E5%A3%B0%E6%98%8E%EF%BC%88Claims%EF%BC%89"><span class="toc-text">标准声明（Claims）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E7%89%B9%E6%80%A7"><span class="toc-text">安全特性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-JWT-%E8%87%AA%E5%8C%85%E5%90%AB%E4%BB%A4%E7%89%8C%E6%A0%87%E5%87%86"><span class="toc-text">4. JWT - 自包含令牌标准</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89%E6%AE%B5%E5%BC%8F%E7%BB%93%E6%9E%84"><span class="toc-text">三段式结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%A6%E7%BB%86%E7%BB%93%E6%9E%84%E8%A7%A3%E6%9E%90"><span class="toc-text">详细结构解析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E9%80%89%E6%8B%A9%E6%8C%87%E5%8D%97"><span class="toc-text">算法选择指南</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">安全注意事项</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Session-Token-%E4%BC%9A%E8%AF%9D%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86"><span class="toc-text">5. Session Token - 会话状态管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F"><span class="toc-text">架构模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E7%AD%96%E7%95%A5"><span class="toc-text">存储策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Session-vs-JWT-%E5%AF%B9%E6%AF%94"><span class="toc-text">Session vs JWT 对比</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-SAML-%E6%96%AD%E8%A8%80-XML%E5%AE%89%E5%85%A8%E5%A3%B0%E6%98%8E"><span class="toc-text">6. SAML 断言 - XML安全声明</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%AD%E8%A8%80%E7%B1%BB%E5%9E%8B"><span class="toc-text">断言类型</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%8D%8F%E8%AE%AE%E4%B8%8EToken%E5%8D%8F%E5%90%8C%E6%9E%B6%E6%9E%84"><span class="toc-text">三、协议与Token协同架构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-OAuth-2-0-OpenID-Connect-%E7%BB%84%E5%90%88"><span class="toc-text">1. OAuth 2.0 + OpenID Connect 组合</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E6%B5%81%E7%A8%8B"><span class="toc-text">完整流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%80%E6%9C%AF%E4%BC%98%E5%8A%BF"><span class="toc-text">技术优势</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-SAML-LDAP-%E4%BC%81%E4%B8%9A%E9%9B%86%E6%88%90"><span class="toc-text">2. SAML + LDAP 企业集成</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E6%88%90%E6%9E%B6%E6%9E%84"><span class="toc-text">集成架构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E6%88%90%E6%B5%81%E7%A8%8B"><span class="toc-text">集成流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%81%E4%B8%9A%E4%BB%B7%E5%80%BC"><span class="toc-text">企业价值</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%AE%89%E5%85%A8%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-text">四、安全最佳实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BC%A0%E8%BE%93%E5%B1%82%E5%AE%89%E5%85%A8"><span class="toc-text">1. 传输层安全</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTPS-%E5%BC%BA%E5%88%B6%E8%A6%81%E6%B1%82"><span class="toc-text">HTTPS 强制要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Token%E4%BC%A0%E8%BE%93%E6%96%B9%E5%BC%8F"><span class="toc-text">Token传输方式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AD%98%E5%82%A8%E5%AE%89%E5%85%A8%E7%AD%96%E7%95%A5"><span class="toc-text">2. 存储安全策略</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%AB%AF%E5%AE%89%E5%85%A8%E5%AD%98%E5%82%A8"><span class="toc-text">浏览器端安全存储</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AE%89%E5%85%A8%E5%AD%98%E5%82%A8"><span class="toc-text">移动端安全存储</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AF%86%E9%92%A5%E7%AE%A1%E7%90%86%E4%BD%93%E7%B3%BB"><span class="toc-text">3. 密钥管理体系</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%E8%BD%AE%E6%8D%A2%E7%AD%96%E7%95%A5"><span class="toc-text">密钥轮换策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%E7%AE%A1%E7%90%86%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-text">密钥管理最佳实践</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%94%BB%E5%87%BB%E9%98%B2%E6%8A%A4%E6%9C%BA%E5%88%B6"><span class="toc-text">4. 攻击防护机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%87%8D%E6%94%BE%E6%94%BB%E5%87%BB%E9%98%B2%E6%8A%A4"><span class="toc-text">重放攻击防护</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%94%BB%E5%87%BB%E4%B8%8E%E9%98%B2%E6%8A%A4"><span class="toc-text">常见攻击与防护</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B%E6%8C%87%E5%8D%97"><span class="toc-text">五、技术选型指南</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF%E5%8C%96%E9%80%89%E5%9E%8B%E7%9F%A9%E9%98%B5"><span class="toc-text">场景化选型矩阵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%B0%E4%BB%A3%E5%8C%96%E9%80%89%E5%9E%8B%E5%BB%BA%E8%AE%AE"><span class="toc-text">现代化选型建议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B0%E9%A1%B9%E7%9B%AE%E6%8E%A8%E8%8D%90"><span class="toc-text">新项目推荐</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%A6%81%E6%B1%82"><span class="toc-text">企业级要求</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E6%96%BD%E8%B7%AF%E7%BA%BF%E5%9B%BE"><span class="toc-text">实施路线图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%98%B6%E6%AE%B5%EF%BC%9A%E5%9F%BA%E7%A1%80%E5%AE%9E%E6%96%BD"><span class="toc-text">第一阶段：基础实施</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%98%B6%E6%AE%B5%EF%BC%9A%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA"><span class="toc-text">第二阶段：安全加固</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E9%98%B6%E6%AE%B5%EF%BC%9A%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7"><span class="toc-text">第三阶段：高级特性</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E6%8A%80%E6%9C%AF%E5%8F%91%E5%B1%95%E8%B6%8B%E5%8A%BF"><span class="toc-text">六、技术发展趋势</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%85%B4%E6%8A%80%E6%9C%AF%E6%A0%87%E5%87%86"><span class="toc-text">新兴技术标准</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#OAuth-2-1"><span class="toc-text">OAuth 2.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebAuthn-FIDO2"><span class="toc-text">WebAuthn (FIDO2)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%B6%E4%BF%A1%E4%BB%BB%E6%9E%B6%E6%9E%84%E4%B8%8B%E7%9A%84%E8%AE%A4%E8%AF%81"><span class="toc-text">零信任架构下的认证</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E6%8E%88%E6%9D%83%E6%A8%A1%E5%9E%8B"><span class="toc-text">动态授权模型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%87%E5%87%86%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3"><span class="toc-text">标准参考文档</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RFC%E6%A0%87%E5%87%86"><span class="toc-text">RFC标准</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6"><span class="toc-text">安全框架</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol></li></ol></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2025 By <a class="footer-bar-link" href="/" title="Supremes" target="_blank">Supremes</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType () {
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      if (true) {
        const from = '出自 ' + data.from
        const sub = []
        sub.unshift(data.hitokoto, from)
        window.typed = new Typed('#footer-type-tips', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('footer-type-tips').innerHTML = data.hitokoto
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.cbd.int/typed.js@2.1.0/dist/typed.umd.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">50</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">11</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://hexo.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fas fa-home faa-tada"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><i class="fas fa-archive faa-tada"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fas fa-folder-open faa-tada"></i><span> 分类</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/database/"><i class="fas fa-database faa-tada"></i><span> 数据库</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/message-queue/"><i class="fas fa-envelope faa-tada"></i><span> 消息队列</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/Spring/"><i class="fas fa-leaf faa-tada"></i><span> Spring</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/security/"><i class="fas fa-shield-alt faa-tada"></i><span> 网络安全</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/AI/"><i class="fas fa-robot faa-tada"></i><span> AI</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/mobile/"><i class="fas fa-mobile-alt faa-tada"></i><span> 移动开发</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/tools/"><i class="fas fa-tools faa-tada"></i><span> 工具效率</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/diary/"><i class="fas fa-book faa-tada"></i><span> 日记</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fas fa-list faa-tada"></i><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/about_me"><i class="fas fa-user faa-tada"></i><span> 关于我</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/my_notes"><i class="fas fa-note-sticky faa-tada"></i><span> 备忘录</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/ACME/" style="font-size: 0.88rem;">ACME<sup>1</sup></a><a href="/tags/AI/" style="font-size: 0.88rem;">AI<sup>1</sup></a><a href="/tags/AI-Agent/" style="font-size: 0.88rem;">AI-Agent<sup>1</sup></a><a href="/tags/AOP/" style="font-size: 0.88rem;">AOP<sup>1</sup></a><a href="/tags/APNS/" style="font-size: 0.88rem;">APNS<sup>1</sup></a><a href="/tags/CA/" style="font-size: 0.88rem;">CA<sup>1</sup></a><a href="/tags/Category/" style="font-size: 0.88rem;">Category<sup>1</sup></a><a href="/tags/Chromium/" style="font-size: 0.88rem;">Chromium<sup>1</sup></a><a href="/tags/Claude/" style="font-size: 0.88rem;">Claude<sup>1</sup></a><a href="/tags/Embedding/" style="font-size: 0.88rem;">Embedding<sup>1</sup></a><a href="/tags/Function-Calling/" style="font-size: 0.88rem;">Function-Calling<sup>1</sup></a><a href="/tags/Hibernate/" style="font-size: 0.88rem;">Hibernate<sup>1</sup></a><a href="/tags/JPA/" style="font-size: 0.88rem;">JPA<sup>1</sup></a><a href="/tags/Java/" style="font-size: 0.88rem;">Java<sup>2</sup></a><a href="/tags/Kafka/" style="font-size: 0.88rem;">Kafka<sup>1</sup></a><a href="/tags/LLM/" style="font-size: 0.88rem;">LLM<sup>1</sup></a><a href="/tags/MCP/" style="font-size: 0.88rem;">MCP<sup>1</sup></a><a href="/tags/Model-Context-Protocol/" style="font-size: 0.88rem;">Model Context Protocol<sup>1</sup></a><a href="/tags/MySQL/" style="font-size: 0.88rem;">MySQL<sup>1</sup></a><a href="/tags/ORM/" style="font-size: 0.88rem;">ORM<sup>1</sup></a><a href="/tags/Objective-C/" style="font-size: 0.88rem;">Objective-C<sup>1</sup></a><a href="/tags/Obsidian/" style="font-size: 0.88rem;">Obsidian<sup>1</sup></a><a href="/tags/PKCS/" style="font-size: 0.88rem;">PKCS<sup>1</sup></a><a href="/tags/PKI/" style="font-size: 0.88rem;">PKI<sup>1</sup></a><a href="/tags/Protocol/" style="font-size: 0.88rem;">Protocol<sup>1</sup></a><a href="/tags/RAG/" style="font-size: 0.88rem;">RAG<sup>1</sup></a><a href="/tags/RabbitMQ/" style="font-size: 0.88rem;">RabbitMQ<sup>1</sup></a><a href="/tags/ReAct/" style="font-size: 0.88rem;">ReAct<sup>1</sup></a><a href="/tags/Redis/" style="font-size: 0.88rem;">Redis<sup>1</sup></a><a href="/tags/SCEP/" style="font-size: 0.88rem;">SCEP<sup>1</sup></a><a href="/tags/Spring/" style="font-size: 0.88rem;">Spring<sup>1</sup></a><a href="/tags/golang/" style="font-size: 0.88rem;">golang<sup>1</sup></a><a href="/tags/iOS/" style="font-size: 0.88rem;">iOS<sup>1</sup></a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/" style="font-size: 0.88rem;">分布式系统<sup>2</sup></a><a href="/tags/%E5%8A%A0%E5%AF%86/" style="font-size: 0.88rem;">加密<sup>1</sup></a><a href="/tags/%E5%8D%8F%E8%AE%AE%E6%A0%87%E5%87%86/" style="font-size: 0.88rem;">协议标准<sup>1</sup></a><a href="/tags/%E5%90%91%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 0.88rem;">向量数据库<sup>1</sup></a><a href="/tags/%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/" style="font-size: 0.88rem;">开发指南<sup>1</sup></a><a href="/tags/%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/" style="font-size: 0.88rem;">数字证书<sup>1</sup></a><a href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" style="font-size: 0.88rem;">面向对象<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date(""); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2025 By 安知鱼 V1.6.15",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Supremes 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.cbd.int/mermaid@10.2.4/dist/mermaid.min.js').then(runMermaid)
  }

  anzhiyu.addGlobalFn('themeChange', runMermaid, 'mermaid')

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://cdn.cbd.int/qrcodejs@1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>
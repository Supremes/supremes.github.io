<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 8.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="Unable to enroll DEP devices when connected to WiFiDoubt We enabled Enrolment Authentication under DEP but that did not help.   Enrollemnt Authentication under DEP   Validated enrolment profile used a">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/xmhelp/xmhelp-4166/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Unable to enroll DEP devices when connected to WiFiDoubt We enabled Enrolment Authentication under DEP but that did not help.   Enrollemnt Authentication under DEP   Validated enrolment profile used a">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-11-26T07:30:03.148Z">
<meta property="article:modified_time" content="2025-11-26T07:30:03.149Z">
<meta property="article:author" content="Supremes">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/xmhelp/xmhelp-4166/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/xmhelp/xmhelp-4166/","path":"2025/11/uncategorized/officeDocuments/officeDocs/xmhelp/xmhelp-4166/","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title> | Hexo</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  






  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hexo</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Unable-to-enroll-DEP-devices-when-connected-to-WiFi"><span class="nav-number">1.</span> <span class="nav-text">Unable to enroll DEP devices when connected to WiFi</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Doubt"><span class="nav-number">1.1.</span> <span class="nav-text">Doubt</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SessionCreate"><span class="nav-number">2.</span> <span class="nav-text">SessionCreate</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#nstrace-log-analysis"><span class="nav-number">2.1.</span> <span class="nav-text">nstrace log analysis:</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#wifi"><span class="nav-number">2.1.1.</span> <span class="nav-text">wifi</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Supremes</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">82</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/uncategorized/officeDocuments/officeDocs/xmhelp/xmhelp-4166/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Supremes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-11-26 15:30:03" itemprop="dateCreated datePublished" datetime="2025-11-26T15:30:03+08:00">2025-11-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="Unable-to-enroll-DEP-devices-when-connected-to-WiFi"><a href="#Unable-to-enroll-DEP-devices-when-connected-to-WiFi" class="headerlink" title="Unable to enroll DEP devices when connected to WiFi"></a>Unable to enroll DEP devices when connected to WiFi</h1><h2 id="Doubt"><a href="#Doubt" class="headerlink" title="Doubt"></a>Doubt</h2><blockquote>
<p>We enabled Enrolment Authentication under DEP but that did not help.</p>
</blockquote>
<ul>
<li>Enrollemnt Authentication under DEP</li>
</ul>
<blockquote>
<p>Validated enrolment profile used and only Global profile is present with MAM enabled.</p>
</blockquote>
<ul>
<li>Only <strong>Global profile</strong> is configured with MAM</li>
</ul>
<blockquote>
<p>We captured Secure Hub logs, XenMobile support bundle and ADC trace to investigate further on this issue.</p>
</blockquote>
<ul>
<li>XenMobile support bundle</li>
</ul>
<blockquote>
<p>In the working trace, I see request from Device IP to Gateway IP and successful 200 OK responses for it which confirms MAM worked fine. Whereas in the non-working capture, I do not see any HTTP request for Gateway IP.</p>
</blockquote>
<ul>
<li>What is the difference of working and not working trace</li>
</ul>
<p>From non working logs, i found out that cem return 412 error when secure hub request <code>createSecureSession</code> .</p>
<p>Could you help to look into </p>
<p>DEP</p>
<ol>
<li><p>是否仅在该设备和该账号出问题</p>
</li>
<li><p>是否会因为配置了wifi或者其他的network policy导致出问题</p>
</li>
<li><p>有mdm enroll错误的日志，关联到了wipe</p>
</li>
<li><p>需要customer给出working log来对比下，因为non working log里有一些关于mdm enroll出错的log，a little bit confused。但是也有可能是mdm enroll出错了，可能cem上显示的不对</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot; 2022-10-11T10:42:51.962+0200 &quot;</span>,&lt;X1_NETWORKING&gt;,DEBUG1 (<span class="number">6</span>),+[X1NetworkRequest startNetworkRequest:withRequestParams:withSuccessBlock:failureBlock:andAuthenticationChallengeHandler:andSessionManager:],<span class="string">&quot;start request with id 9 and value (redacted) https://*****/zdm/ios/agent?action=sessioncreate&quot;</span>,-,com.apple.root.default-qos,<span class="number">11703</span>,Secure Hub,/Users/jenkins/jenkins/workspace/iOS_SecureHub/AppStore/MDM/Common/Source/X1NetworkRequest.m,<span class="number">526</span></span><br><span class="line"><span class="string">&quot; 2022-10-11T10:42:52.001+0200 &quot;</span>,&lt;X1_NETWORKING&gt;,DEBUG1 (<span class="number">6</span>),+[X1NetworkRequest startNetworkRequest:withRequestParams:withSuccessBlock:failureBlock:andAuthenticationChallengeHandler:andSessionManager:]_block_invoke,<span class="string">&quot;request with id 9 succeeded with httpResponse code 412&quot;</span>,Active,com.apple.main-thread,<span class="number">103</span>,Secure Hub,/Users/jenkins/jenkins/workspace/iOS_SecureHub/AppStore/MDM/Common/Source/X1NetworkRequest.m,<span class="number">536</span></span><br><span class="line"><span class="string">&quot; 2022-10-11T10:42:52.001+0200 &quot;</span>,&lt;MDM&gt;,INFO (<span class="number">4</span>),-[FetcherBase networkRequestFailHandler:],<span class="string">&quot;Fetcher::sessioncreate got a fail response 412&quot;</span>,Active,com.apple.main-thread,<span class="number">103</span>,Secure Hub,/Users/jenkins/jenkins/workspace/iOS_SecureHub/AppStore/MDM/Common/Source/Checker/FetcherBase.m,<span class="number">77</span></span><br><span class="line"><span class="string">&quot; 2022-10-11T10:42:52.001+0200 &quot;</span>,WHGenericVault,INFO (<span class="number">4</span>),-[WHGenericVault isUserEnrolled]_block_invoke,<span class="string">&quot;User is not MDM Enrolled: UserName-1 , ServerAddress-1, EnrollmentDate-0&quot;</span>,Active,com.citrix.GenericVaultQueue,<span class="number">103</span>,Secure Hub,/Users/jenkins/jenkins/workspace/iOS_SecureHub/AppStore/Me@Work/Me@Work/WHGenericVault.m,<span class="number">401</span></span><br><span class="line"><span class="string">&quot; 2022-10-11T10:42:52.001+0200 &quot;</span>,&lt;MDM&gt;,ERROR (<span class="number">2</span>),-[X1MDMEnrollFlowController handleServerError:errorMessage:],<span class="string">&quot;handleServerError response 412 with title and detail text [ConnectionErrorHeader] An error occurred. The enrollment will stop.&quot;</span>,Active,com.apple.main-thread,<span class="number">103</span>,Secure Hub,/Users/jenkins/jenkins/workspace/iOS_SecureHub/AppStore/Me@Work/Me@Work/Controller/X1MDMEnrollFlowController.m,<span class="number">2313</span></span><br><span class="line"><span class="string">&quot; 2022-10-11T10:42:52.001+0200 &quot;</span>,&lt;MDM&gt;,ERROR (<span class="number">2</span>),-[X1MDMEnrollFlowController createSecureSession]_block_invoke,<span class="string">&quot;request to resulted in httpResponse 412&quot;</span>,Active,com.apple.main-thread,<span class="number">103</span>,Secure Hub,/Users/jenkins/jenkins/workspace/iOS_SecureHub/AppStore/Me@Work/Me@Work/Controller/X1MDMEnrollFlowController.m,<span class="number">1467</span></span><br><span class="line"><span class="string">&quot; 2022-10-11T10:42:52.001+0200 &quot;</span>,&lt;MDM&gt;,ERROR (<span class="number">2</span>),-[X1MDMEnrollFlowController error],<span class="string">&quot;No valid MDM SessionID, so continuing WITHOUT Unenroll request to the server&quot;</span>,Active,com.apple.main-thread,<span class="number">103</span>,Secure Hub,/Users/jenkins/jenkins/workspace/iOS_SecureHub/AppStore/Me@Work/Me@Work/Controller/X1MDMEnrollFlowController.m,<span class="number">382</span></span><br><span class="line"><span class="string">&quot; 2022-10-11T10:42:52.001+0200 &quot;</span>,ZDM_WIPE,ERROR (<span class="number">2</span>),-[X1MDMEnrollFlowController error],<span class="string">&quot;Enrollment error [ConnectionErrorHeader]/An error occurred. The enrollment will stop. - Calling zdmSelectiveWipeIncludingMam&quot;</span>,Active,com.apple.main-thread,<span class="number">103</span>,Secure Hub,/Users/jenkins/jenkins/workspace/iOS_SecureHub/AppStore/Me@Work/Me@Work/Controller/X1MDMEnrollFlowController.m,<span class="number">404</span></span><br><span class="line"><span class="string">&quot; 2022-10-11T10:42:52.002+0200 &quot;</span>,&lt;MDM&gt;,DEBUG2 (<span class="number">7</span>),-[<span class="built_in">CTXOAuthManager</span> logOut],<span class="string">&quot;End Session endpoint is not found - returing without logout&quot;</span>,Active,com.apple.main-thread,<span class="number">103</span>,Secure Hub,/Users/jenkins/jenkins/workspace/iOS_SecureHub/AppStore/MDM/Common/OAuth/<span class="built_in">CTXOAuthManager</span>.m,<span class="number">202</span></span><br><span class="line"><span class="string">&quot; 2022-10-11T10:42:52.002+0200 &quot;</span>,ZDM_WIPE,INFO (<span class="number">4</span>),+[WipeManager zdmSelectiveWipeFromServerIncludingMam:wipeSucceed:withSynchronousMamWipe:],<span class="string">&quot;ZDM Wipe - ZDM Requested Wipe Initiated&quot;</span>,Active,com.apple.main-thread,<span class="number">103</span>,Secure Hub,/Users/jenkins/jenkins/workspace/iOS_SecureHub/AppStore/MDM/Common/Source/AppSupport/WipeManager.m,<span class="number">157</span></span><br><span class="line"><span class="string">&quot; 2022-10-11T10:42:52.009+0200 &quot;</span>,ZDM_WIPE,DEBUG2 (<span class="number">7</span>),+[WipeManager zdmSelectiveWipeFromServerIncludingMam:wipeSucceed:withSynchronousMamWipe:],<span class="string">&quot;ZDM Wipe - Call stack for the wipe is :</span></span><br><span class="line"><span class="string">(</span></span><br><span class="line"><span class="string"> 0 Secure Hub 0x0000000104f7161c +[WipeManager zdmSelectiveWipeFromServerIncludingMam:wipeSucceed:withSynchronousMamWipe:] + 164</span></span><br><span class="line"><span class="string"> 1 Secure Hub 0x0000000104f71050 __75+[WipeManager internalZdmSelectiveWipeIncludingMam:withSynchronousMamWipe:]_block_invoke + 848</span></span><br><span class="line"><span class="string"> 2 Secure Hub 0x0000000105046414 __41-[BFTask continueWithExecutor:withBlock:]_block_invoke_2 + 60</span></span><br><span class="line"><span class="string"> 3 Secure Hub 0x0000000104fb930c __29+[BFExecutor defaultExecutor]_block_invoke_2 + 456</span></span><br><span class="line"><span class="string"> 4 Secure Hub 0x0000000104fb9c9c -[BFExecutor execute:] + 108</span></span><br><span class="line"><span class="string"> 5 Secure Hub 0x00000001050463a4 __41-[BFTask continueWithExecutor:withBlock:]_block_invoke + 212</span></span><br><span class="line"><span class="string"> 6 Secure Hub 0x000000010504621c -[BFTask continueWithExecutor:withBlock:] + 612</span></span><br><span class="line"><span class="string"> 7 Secure Hub 0x00000001050468f4 -[BFTask continueWithBlock:] + 132</span></span><br><span class="line"><span class="string"> 8 Secure Hub 0x0000000104f70ccc +[WipeManager internalZdmSelectiveWipeIncludingMam:withSynchronousMamWipe:] + 476</span></span><br><span class="line"><span class="string"> 9 Secure Hub 0x0000000104f70ad8 +[WipeManager zdmSelectiveWipeIncludingMam:] + 96</span></span><br><span class="line"><span class="string"> 10 Secure Hub 0x0000000104ee0d7c -[X1MDMEnrollFlowController error] + 1468</span></span><br><span class="line"><span class="string"> 11 Secure Hub 0x0000000104edf4f8 -[X1MDMEnrollFlowController setState:] + 760</span></span><br><span class="line"><span class="string"> 12 Secure Hub 0x0000000104ee8e60 __48-[X1MDMEnrollFlowController createSecureSession]_block_invoke + 312</span></span><br><span class="line"><span class="string"> 13 Secure Hub 0x0000000104fc1734 __78-[FetcherBase executeCompletionBlocksWithHttpResponse:withResponse:withError:]_block_invoke + 64</span></span><br><span class="line"><span class="string"> 14 libdispatch.dylib 0x00000001878b9e6c 2D55AD2F-6AFF-303D-8E82-088ADA4695B2 + 7788</span></span><br><span class="line"><span class="string"> 15 libdispatch.dylib 0x00000001878bba30 2D55AD2F-6AFF-303D-8E82-088ADA4695B2 + 14896</span></span><br><span class="line"><span class="string"> 16 libdispatch.dylib 0x00000001878c9f48 2D55AD2F-6AFF-303D-8E82-088ADA4695B2 + 73544</span></span><br><span class="line"><span class="string"> 17 libdispatch.dylib 0x00000001878c9b98 _dispatch_main_queue_callback_4CF + 44</span></span><br><span class="line"><span class="string"> 18 CoreFoundation 0x0000000187c0c800 DA3C2E10-0C3D-3FBC-9C3E-E950EBA7020F + 333824</span></span><br><span class="line"><span class="string"> 19 CoreFoundation 0x0000000187bc6704 DA3C2E10-0C3D-3FBC-9C3E-E950EBA7020F + 46852</span></span><br><span class="line"><span class="string"> 20 CoreFoundation 0x0000000187bd9bc8 CFRunLoopRunSpecific + 600</span></span><br><span class="line"><span class="string"> 21 GraphicsServices 0x00000001a3d49374 GSEventRunModal + 164</span></span><br><span class="line"><span class="string"> 22 UIKitCore 0x000000018a54fb58 2A0536AC-DC79-368A-BE35-3934C48694C1 + 5327704</span></span><br><span class="line"><span class="string"> 23 UIKitCore 0x000000018a2d1098 UIApplicationMain + 364</span></span><br><span class="line"><span class="string"> 24 Secure Hub 0x0000000104dae3cc main + 120</span></span><br><span class="line"><span class="string"> 25 dyld 0x0000000106495da4 start + 520</span></span><br><span class="line"><span class="string">)&quot;</span>,Active,com.apple.main-thread,<span class="number">103</span>,Secure Hub,/Users/jenkins/jenkins/workspace/iOS_SecureHub/AppStore/MDM/Common/Source/AppSupport/WipeManager.m,<span class="number">158</span></span><br><span class="line"><span class="string">&quot; 2022-10-11T10:42:52.009+0200 &quot;</span>,&lt;MAM&gt;,INFO (<span class="number">4</span>),+[LogSettings resetLogSettingDataForAllApps],<span class="string">&quot;Resetting log settings for Wipe&quot;</span>,Active,com.apple.main-thread,<span class="number">103</span>,Secure Hub,/Users/jenkins/jenkins/workspace/iOS_SecureHub/AppStore/Me@Work/<span class="built_in">UISubsystem</span>/GoToAssist/Log settings/LogSettings.m,<span class="number">215</span></span><br><span class="line"><span class="string">&quot; 2022-10-11T10:42:52.010+0200 &quot;</span>,ZDM_WIPE,DEBUG1 (<span class="number">6</span>),+[WipeManager resetAllData],<span class="string">&quot;ZDM Wipe - RESET ALL DATA&quot;</span>,Active,com.apple.main-thread,<span class="number">103</span>,Secure Hub,/Users/jenkins/jenkins/workspace/iOS_SecureHub/AppStore/MDM/Common/Source/AppSupport/WipeManager.m,<span class="number">243</span></span><br><span class="line"><span class="string">&quot; 2022-10-11T10:42:52.010+0200 &quot;</span>,&lt;MDM&gt;,DEBUG1 (<span class="number">6</span>),-[LoginManager logout],<span class="string">&quot;LoginManager logout&quot;</span>,Active,com.apple.main-thread,<span class="number">103</span>,Secure Hub,/Users/jenkins/jenkins/workspace/iOS_SecureHub/AppStore/MDM/Common/Source/AppSupport/LoginManager.m,<span class="number">38</span></span><br><span class="line"><span class="string">&quot; 2022-10-11T10:42:52.010+0200 &quot;</span>,&lt;MDM&gt;,DEBUG1 (<span class="number">6</span>),-[LoginManager logout],<span class="string">&quot;LoginManager reset autologin&quot;</span>,Active,com.apple.main-thread,<span class="number">103</span>,Secure Hub,/Users/jenkins/jenkins/workspace/iOS_SecureHub/AppStore/MDM/Common/Source/AppSupport/LoginManager.m,<span class="number">44</span></span><br></pre></td></tr></table></figure>

<p>查询cert发生在：</p>
<p>1049和1700</p>
<p>save cert发生在：</p>
<p>1453和2444</p>
</li>
</ol>
<p>Hi <a href="">Meiju Xing （邢美菊）</a><br>I found that read and write operation of cert were out of order in customer’s client log. The sessioncreate interface reads the local certificate before it is written to the local certificate. </p>
<p>Hi <a href="">Santosh Hari</a><br>Please help to confirm that which iOS device policy customer have deployed.</p>
<p>Fort client part, the process should look like this:</p>
<ol>
<li><p>SH request CEM with “getenrollmentcertificate”, then save cert into local vault</p>
</li>
<li><p>SH receive CEM’s callback and handle “NSURLAuthenticationMethodClientCertificate” to read cert which should be saved in local vault.</p>
</li>
</ol>
<p>But from customer’s client log, I found that read and write operation of cert were out of order in customer’s client log:</p>
<p>Logic1 happend on 2022-10-11T10:43:11.551+0200</p>
<p>Logic2 happend on 2022-10-11T10:42:44.358+0200</p>
<p>Logic3 happend on 2022-10-11T10:43:11.874+0200</p>
<p>Please help to confirm that which iOS device policy customer have deployed.</p>
<p>Logic1:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<p>logic2:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<p>![image-20221121143109525](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20221121143109525.png</p>
<p>Create secure session:</p>
<p>![image-20221121143347540](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20221121143347540.png)![image-20221121143413120](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20221121143413120.png)</p>
<p>From client part, “create secure session” request is sent as expected, but server check that cert data was not sent as expected, </p>
<p>![image-20221129163122402](&#x2F;Users&#x2F;junkangd&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20221129163122402.png)</p>
<p>172763	2023-01-26 21:52:04.347013260	31.161.146.205	213.34.224.34	625	HTTP	POST &#x2F;zdm&#x2F;ios&#x2F;agent?action&#x3D;getenrollmentcertificate HTTP&#x2F;1.1  (application&#x2F;x-www-form-urlencoded)	</p>
<p>http.request.uri contains “sessioncreate” || tls</p>
<h1 id="SessionCreate"><a href="#SessionCreate" class="headerlink" title="SessionCreate"></a>SessionCreate</h1><p>8443：不发</p>
<p>443：发证书</p>
<h2 id="nstrace-log-analysis"><a href="#nstrace-log-analysis" class="headerlink" title="nstrace log analysis:"></a>nstrace log analysis:</h2><p>Before sessioncreate request occurs, the MDM certificate is sent from the SecureHub to the NSG during TLS handshake.</p>
<p>During TLS handshake, 4G is different from wifi.</p>
<p>In 4G Scenario, NSG sends a Certificate Request to SecureHub. But in wifi scenario, there is no Certificate Request.</p>
<p>These analyses prove that it must be the NSG or the network that is causing the request not to be sent at the correct stage, or the configuration of the NSG had caused it not to be sent at all.</p>
<p>Please let NSG team to involve this issue, check whether there is a configuration or something which affect this behaviour during TLS handshake.</p>
<h3 id="wifi"><a href="#wifi" class="headerlink" title="wifi"></a>wifi</h3><p>192596	2023-01-26 21:45:45.525961174	92.65.169.83	213.34.224.34	273	HTTP	POST &#x2F;zdm&#x2F;ios&#x2F;agent?action&#x3D;sessioncreate HTTP&#x2F;1.1  (application&#x2F;x-www-form-urlencoded)	</p>
<p>268474	2023-01-26 21:46:12.169999426	92.65.169.83	213.34.224.34	273	HTTP	POST &#x2F;zdm&#x2F;ios&#x2F;agent?action&#x3D;sessioncreate HTTP&#x2F;1.1  (application&#x2F;x-www-form-urlencoded)	</p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/11/uncategorized/officeDocuments/officeDocs/xmhelp/XMHELP-4113/" rel="prev" title="">
                  <i class="fa fa-angle-left"></i> 
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/11/uncategorized/officeDocuments/officeDocs/xmhelp/4514/" rel="next" title="">
                   <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Supremes</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
